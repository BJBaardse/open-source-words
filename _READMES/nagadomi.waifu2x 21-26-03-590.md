waifu2x image super resolution for anime style art using deep convolutional neural networks and it supports photo the demo application can be found at http waifu2x udp jp note that i only provide this website and this repository other software or website claiming waifu2x has nothing to do with me summary click to see the slide show references waifu2x is inspired by srcnn 1 2d character picture hatsunemiku is licensed under cc by nc by piapro 2 1 chao dong chen change loy kaiming he xiaoou tang image super resolution using deep convolutional networks http arxiv org abs 1501 00092 2 for creators http piapro net en for creators html public ami region us east 1 n virginia ami id ami b9be23ae ami name waifu2x server 20160807 instance type g2 2xlarge os ubuntu 14 04 user ubuntu created at 2016 08 07 see readme md please update the git repo first git pull third party software third party if you are a windows user i recommend you to use waifu2x caffe just download from releases tab or waifu2x conver cpp dependencies hardware nvidia gpu platform torch7 nvidia cuda luarocks packages excludes torch7s default packages lua csnappy md5 uuid csvigo turbo installation setting up the command line tool environment on ubuntu 14 04 install cuda see nvidia cuda getting started guide for linux download cuda sudo dpkg i cuda repo ubuntu1404 7 5 18 amd64 deb sudo apt get update sudo apt get install cuda install package sudo apt get install libsnappy dev sudo apt get install libgraphicsmagick1 dev note waifu2x requires little cms2 linked graphicsmagick if you use macos homebrew see 174 install torch7 see getting started with torch and 222 and install luarocks packages luarocks install graphicsmagick upgrade luarocks install lua csnappy luarocks install md5 luarocks install uuid luarocks install csvigo if you need to use web application prefix home torch install luarocks install turbo if you need to use cudnn library cudnn is required luarocks install cudnn getting waifu2x git clone depth 1 https github com nagadomi waifu2x git validation testing the waifu2x command line tool th waifu2x lua web application th web lua view at http localhost 8812 command line tools notes if you have cudnn library than you can use cudnn with force cudnn 1 option cudnn is too much faster than default kernel noise reduction th waifu2x lua m noise noise level 1 i input image png o output image png th waifu2x lua m noise noise level 0 i input image png o output image png th waifu2x lua m noise noise level 2 i input image png o output image png th waifu2x lua m noise noise level 3 i input image png o output image png 2x upscaling th waifu2x lua m scale i input image png o output image png noise reduction 2x upscaling th waifu2x lua m noise scale noise level 1 i input image png o output image png th waifu2x lua m noise scale noise level 0 i input image png o output image png th waifu2x lua m noise scale noise level 2 i input image png o output image png th waifu2x lua m noise scale noise level 3 i input image png o output image png batch conversion find path to imagedir name png o name jpg image list txt th waifu2x lua m scale l image list txt o path to outputdir prefix d png the output format supports s and d e g 06d s will be replaced the basename of the source filename d will be replaced a sequence number for example when input filename is piyo png s 03d png will be replaced piyo 001 png see also th waifu2x lua h using photo model please add model dir models photo to command line option if you want to use photo model for example th waifu2x lua model dir models photo m scale i input image png o output image png video encoding avconv is alias of ffmpeg on ubuntu 14 04 extracting images and audio from a video range 00 09 00 00 12 00 mkdir frames avconv i data raw avi ss 00 09 00 t 00 03 00 r 24 f image2 frames 06d png avconv i data raw avi ss 00 09 00 t 00 03 00 audio mp3 generating a image list find frames name png sort data frame txt waifu2x for example noise reduction mkdir new frames th waifu2x lua m noise noise level 1 resume 1 l data frame txt o new frames d png generating a video from waifu2xed images and audio avconv f image2 framerate 24 i new frames d png i audio mp3 r 24 vcodec libx264 crf 16 video mp4 train your own model note1 if you have cudnn library you can use cudnn kernel with backend cudnn option and you can convert trained cudnn model to cunn model with tools rebuild lua note2 the command that was used to train for waifu2xs pretraind models is available at appendix train upconv 7 art sh appendix train upconv 7 photo sh maybe it is helpful data preparation genrating a file list find path to image dir name png data image list txt you should use noise free images in my case waifu2x is trained with 6000 high resolution noise free png images converting training data th convert data lua train a noise reduction level1 model mkdir models my model th train lua model dir models my model method noise noise level 1 test images miku noisy png usage th waifu2x lua model dir models my model m noise noise level 1 i images miku noisy png o output png you can check the performance of model withmodels my model noise1 best png train a noise reduction level2 model th train lua model dir models my model method noise noise level 2 test images miku noisy png usage th waifu2x lua model dir models my model m noise noise level 2 i images miku noisy png o output png you can check the performance of model withmodels my model noise2 best png train a 2x upscaling model th train lua model upconv 7 model dir models my model method scale scale 2 test images miku small png usage th waifu2x lua model dir models my model m scale scale 2 i images miku small png o output png you can check the performance of model withmodels my model scale2 0x best png train a 2x and noise reduction fusion model th train lua model upconv 7 model dir models my model method noise scale scale 2 noise level 1 test images miku small png usage th waifu2x lua model dir models my model m noise scale scale 2 noise level 1 i images miku small png o output png you can check the performance of model withmodels my model noise1 scale2 0x best png docker requires nvidia docker docker build t waifu2x nvidia docker run p 8812 8812 waifu2x th web lua nvidia docker run v pwd images images waifu2x th waifu2x lua force cudnn 1 m scale scale 2 i images miku small png o images output png note that running waifu2x in without jit caching is very slow which is what would happen if you use docker for a workaround you can mount a host volume to the cuda cache path for instance nvidia docker run v pwd computecache root nv computecache waifu2x th waifu2x lua help