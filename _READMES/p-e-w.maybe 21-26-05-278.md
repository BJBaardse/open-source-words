package tests rm rf pic are you sure are you one hundred percent sure maybe allows you to run a command and see what it does to your files without actually doing it after reviewing the operations listed you can then decide whether you really want these things to happen or not what is this sorcery maybe runs processes under the control of ptrace with the help of the excellent python ptrace library when it intercepts a system call that is about to make changes to the file system it logs that call and then modifies cpu registers to both redirect the call to an invalid syscall id effectively turning it into a no op and set the return value of that no op call to one indicating success of the original call as a result the process believes that everything it is trying to do is actually happening when in reality nothing is that being said maybe should warning never warning be used to run untrusted code on a system you care about a process running under maybe can still do serious damage to your system because only a handful of syscalls are blocked it can also check whether an operation such as deleting a file succeeded using read only syscalls and alter its behavior accordingly therefore a rerun without restrictions is not guaranteed to always produce the displayed operations currently maybe is best thought of as an alpha quality what exactly will this command i typed myself do tool installation maybe runs on linux penguin and requires python 2 7 3 3 snake if you have the pip package manager all you need to do is run pip install maybe either as a superuser or from a virtualenv environment to develop maybe clone the repository and run pip install e in its main directory to install the package in editable mode usage maybe options command argument positional arguments argument description command the command to run under maybes control argument argument s to pass to command optional arguments argument description a operation allow operation allow the command to perform the specified operation s all other operations will be denied possible values for operation are change owner change permissions create directory create link create write file delete move as well as any filter scopes defined by loaded plugins d operation deny operation deny the command the specified operation s all other operations will be allowed see allow for a list of possible values for operation allow and deny cannot be combined p file plugin file load the specified plugin script s l list only list operations without header indentation and rerun prompt style output yes no auto colorize output using ansi escape sequences yes no or automatically decide based on whether stdout is a terminal auto default v verbose if specified once print every filtered syscall if specified twice print every syscall highlighting filtered syscalls version show programs version number and exit h help show a help message and exit plugin api by default maybe intercepts and blocks all syscalls that can make permanent modifications to the system for more specialized syscall filtering needs maybe provides a simple yet powerful plugin api filter plugins are written in pure python and use the same interfaces as maybes built in filters the public api is composed of the following two members maybe t a blessings terminal object that can be used to format console output such as operation as documented below output formatted with this object automatically complies with the style output command line argument maybe register filter syscall filter function filter scope none add the filter filter function to the filter registry if the filter is enabled which is the default but can be altered with the allow and deny command line arguments it intercepts all calls to syscall made by the controlled process filter scope determines the key to be used in conjunction with allow and deny to enable disable the filter multiple filters can share the same key if filter scope is omitted or none the last part of the plugins module name is used filter function itself must conform to the signature filter function process args process is a process control object that can be used to inspect and manipulate the process while args is the list of arguments passed to the syscall in the order in which they appear in the syscalls signature if an argument represents a pointer to a filename the argument will be of type str and contain the filename otherwise it will be of type int and contain the numerical value of the argument when called filter function must return a tuple operation return value operation can either be a string description of the operation that was prevented by the filter to be printed after the process terminates or none in which case nothing will be printed return value can either be a numerical value in which case the syscall invocation will be prevented and the return value received by the caller will be set to that value or none in which case the invocation will be allowed to proceed as normal example here maybes plugin api is used to implement an exotic type of access control restricting read access based on the content of the file in question if a file being opened for reading contains the word secret the plugin blocks the open openat syscall and returns an error read secret file py python from os import o wronly from os path import isfile from maybe import t register filter def filter open path flags if path startswith home and isfile path and not flags o wronly with open path r as f if secret in f read return s s t red read secret file t underline path 1 else return none none else return none none register filter open lambda process args filter open process full path args 0 args 1 register filter openat lambda process args filter open process full path args 1 args 0 args 2 indeed the plugin works as expected user localhost maybe plugin read secret file py deny read secret file bash echo this is a normal file file 1 echo this is a secret file file 2 cat file 1 this is a normal file cat file 2 cat file 2 operation not permitted license copyright Â© 2016 2017 philipp emanuel weidmann pew worldwidemann com released under the terms of the gnu general public license version 3