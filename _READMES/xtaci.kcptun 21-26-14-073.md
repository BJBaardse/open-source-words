kcptun maintains a single website — github com xtaci kcptun any websites other than github com xtaci kcptun are not endorsed by xtaci kcptun wont publish anything on any social media kcp communication group 364933586 qq group number kcp integration tuning network transmission and related technical discussions quickstart increase number of open files on your server as ulimit n 65535 or write it in bashrc download precompiled releases kcp client client darwin amd64 r kcp server ip 4000 l 8388 mode fast2 kcp server server linux amd64 t target ip 8388 l 4000 mode fast2 the above commands will establish port forwarding for 8388 tcp as application kcp client 8388 tcp kcp server 4000 udp target server 8388 tcp tunnels the original connection application target server 8388 tcp install from source go get u github com xtaci kcptun client go get u github com xtaci kcptun server all precompiled releases are genereated from build release sh script performance basic tuning guide improving thoughput q i have a high speed network link how to reach the maximum bandwidth a increase rcvwnd on kcp client and sndwnd on kcp server simultaneously gradually the mininum one decides the maximum transfer rate of the link as wnd mtu rtt then try downloading something and to see if it meets your requirements mtu is adjustable by mtu improving latency q im using kcptun for game i dont want any lag happening a lag means packet loss for most of the time lags can be improved by changing mode eg mode fast3 aggresiveness responsiveness on retransmission for embeded modes are fast3 fast2 fast normal default expert tuning guide overview usage client darwin amd64 h name kcptun client with smux usage client darwin amd64 global options command command options arguments version 20170120 commands help h shows a list of commands or help for one command global options localaddr value l value local listen address default 12948 remoteaddr value r value kcp server address default vps 29900 key value pre shared secret between client and server default its a secrect kcptun key crypt value aes aes 128 aes 192 salsa20 blowfish twofish cast5 3des tea xtea xor none default aes mode value profiles fast3 fast2 fast normal default fast conn value set num of udp connections to server default 1 autoexpire value set auto expiration time in seconds for a single udp connection 0 to disable default 0 mtu value set maximum transmission unit for udp packets default 1350 sndwnd value set send window size num of packets default 128 rcvwnd value set receive window size num of packets default 512 datashard value ds value set reed solomon erasure coding datashard default 10 parityshard value ps value set reed solomon erasure coding parityshard default 3 dscp value set dscp 6bit default 0 nocomp disable compression snmplog value collect snmp to file aware of timeformat in golang like snmp 20060102 log snmpperiod value snmp collect period in seconds default 60 log value specify a log file to output default goes to stderr c value config from json file which will override the command from shell help h show help version v print the version server darwin amd64 h name kcptun server with smux usage server darwin amd64 global options command command options arguments version 20170120 commands help h shows a list of commands or help for one command global options listen value l value kcp server listen address default 29900 target value t value target server address default 127 0 0 1 12948 key value pre shared secret between client and server default its a secrect kcptun key crypt value aes aes 128 aes 192 salsa20 blowfish twofish cast5 3des tea xtea xor none default aes mode value profiles fast3 fast2 fast normal default fast mtu value set maximum transmission unit for udp packets default 1350 sndwnd value set send window size num of packets default 1024 rcvwnd value set receive window size num of packets default 1024 datashard value ds value set reed solomon erasure coding datashard default 10 parityshard value ps value set reed solomon erasure coding parityshard default 3 dscp value set dscp 6bit default 0 nocomp disable compression snmplog value collect snmp to file aware of timeformat in golang like snmp 20060102 log snmpperiod value snmp collect period in seconds default 60 log value specify a log file to output default goes to stderr c value config from json file which will override the command from shell help h show help version v print the version forward error correction in coding theory the reed–solomon code belongs to the class of non binary cyclic error correcting codes the reed–solomon code is based on univariate polynomials over finite fields it is able to detect and correct multiple symbol errors by adding t check symbols to the data a reed–solomon code can detect any combination of up to t erroneous symbols or correct up to ⌊t 2⌋ symbols as an erasure code it can correct up to t known erasures or it can detect and correct combinations of errors and erasures furthermore reed–solomon codes are suitable as multiple burst bit error correcting codes since a sequence of b 1 consecutive bit errors can affect at most two symbols of size b the choice of t is up to the designer of the code and may be selected within wide limits setting parameters of rs code with datashard m parityshard n on both kcp client kcp server must be identical dscp differentiated services or diffserv is a computer networking architecture that specifies a simple scalable and coarse grained mechanism for classifying and managing network traffic and providing quality of service qos on modern ip networks diffserv can for example be used to provide low latency to critical network traffic such as voice or streaming media while providing simple best effort service to non critical services such as web traffic or file transfers diffserv uses a 6 bit differentiated services code point dscp in the 8 bit differentiated services field ds field in the ip header for packet classification purposes the ds field and ecn field replace the outdated ipv4 tos field setting each side with dscp value here are some commonly used dscp values security no matter what encryption you are using for application layer if you specify crypt none to kcptun the header will be plaintext to everyone i suggest crypt aes 128 for encryption at least crypt and key must be the same on both kcp client kcp server notice crypt xor is also insecure do not use this unless you know what you are doing benchmarks for crypto algorithms supported by kcptun benchmarkaes128 4 200000 11182 ns op benchmarkaes192 4 200000 12699 ns op benchmarkaes256 4 100000 13757 ns op benchmarktea 4 50000 26441 ns op benchmarksimplexor 4 3000000 441 ns op benchmarkblowfish 4 30000 48036 ns op benchmarknone 4 20000000 106 ns op benchmarkcast5 4 20000 60222 ns op benchmarktripledes 4 2000 878759 ns op benchmarktwofish 4 20000 68501 ns op benchmarkxtea 4 20000 77417 ns op benchmarksalsa20 4 300000 4998 ns op memory control routers mobile devices are sensitive to memory consumption by setting gogc environment eg gogc 20 will lower memory consumption reference https blog golang org go15gc compression kcptun has builtin snappy algorithms for compressing streams snappy is a compression decompression library it does not aim for maximum compression or compatibility with any other compression library instead it aims for very high speeds and reasonable compression for instance compared to the fastest mode of zlib snappy is an order of magnitude faster for most inputs but the resulting compressed files are anywhere from 20 to 100 bigger reference http google github io snappy compression may save bandwidth for plaintext data such as http data compression is enabled by default you can disable it by setting nocomp on both kcp client kcp server must be identical snmp go snmp defines network statistics indicator type snmp struct bytessent uint64 raw bytes sent bytesreceived uint64 maxconn uint64 activeopens uint64 passiveopens uint64 currestab uint64 count of connections for now inerrs uint64 udp read errors incsumerrors uint64 checksum errors from crc32 kcpinerrors uint64 packet iput errors from kcp insegs uint64 outsegs uint64 inbytes uint64 udp bytes received outbytes uint64 udp bytes sent retranssegs uint64 fastretranssegs uint64 earlyretranssegs uint64 lostsegs uint64 number of segs infered as lost repeatsegs uint64 number of segs duplicated fecrecovered uint64 correct packets recovered from fec fecerrs uint64 incorrect packets recovered from fec fecsegs uint64 fec segments received fecshortshards uint64 number of data shards thats not enough for recovery sending a sigusr1 signal to kcp client or kcp server will dump snmp information to console just like proc net snmp you can use this information to do fine grained tuning manual control https github com skywind3000 kcp blob master readme en md protocol configuration mode manual nodelay 1 interval 20 resend 2 nc 1 low level kcp configuration can be altered by using manual mode like above make sure you really understand what these means before doing any manual settings identical parmeters the parameters below must be identical on both side key crypt nocomp datashard parityshard references https github com skywind3000 kcp kcp a fast and reliable arq protocol https github com xtaci kcp go a production grade reliable udp library for golang https github com klauspost reedsolomon reed solomon erasure coding in go https en wikipedia org wiki differentiated services dscp http google github io snappy a fast compressor decompressor https www backblaze com blog reed solomon reed solomon explained http www qualcomm cn products raptorq raptorq forward error correction scheme for object delivery https en wikipedia org wiki pbkdf2 key stretching http blog appcanary com 2016 encrypt or compress html should you encrypt or compress first https github com hashicorp yamux connection multiplexing library https tools ietf org html rfc6937 proportional rate reduction for tcp https tools ietf org html rfc5827 early retransmit for tcp and stream control transmission protocol sctp http http2 github io what is http 2 http www lartc org linux advanced routing traffic control https en wikipedia org wiki noisy channel coding theorem noisy channel coding theorem https play google com store apps details id com k17game k3 battle zone earth 2048 an online strategy game using kcp donate via ethereum eth address 0x2e4b43ab3d0983da282592571eef61ae5e60f726 or scan here