design patterns implemented in swift 3 0 a short cheat sheet with xcode 8 2 playground design patterns playground zip üë∑ project maintained by nsmeme oktawian chojnacki üöÄ how to generate readme playground and zip from source generate md table of contents behavioral creational structural swift behavioral creational structural behavioral in software engineering behavioral design patterns are design patterns that identify common communication patterns between objects and realize these patterns by doing so these patterns increase flexibility in carrying out this communication source wikipedia org swift import swift import foundation üêù chain of responsibility the chain of responsibility pattern is used to process varied requests each of which may be dealt with by a different handler example swift final class moneypile let value int var quantity int var nextpile moneypile init value int quantity int nextpile moneypile self value value self quantity quantity self nextpile nextpile func canwithdraw amount int bool var amount amount func cantakesomebill want int bool return want self value 0 var quantity self quantity while cantakesomebill want amount if quantity 0 break amount self value quantity 1 guard amount 0 else return true if let next self nextpile return next canwithdraw amount amount return false final class atm private var hundred moneypile private var fifty moneypile private var twenty moneypile private var ten moneypile private var startpile moneypile return self hundred init hundred moneypile fifty moneypile twenty moneypile ten moneypile self hundred hundred self fifty fifty self twenty twenty self ten ten func canwithdraw amount int string return can withdraw \ self startpile canwithdraw amount amount usage swift create piles of money and link them together 10 20 50 100 let ten moneypile value 10 quantity 6 nextpile nil let twenty moneypile value 20 quantity 2 nextpile ten let fifty moneypile value 50 quantity 2 nextpile twenty let hundred moneypile value 100 quantity 1 nextpile fifty build atm var atm atm hundred hundred fifty fifty twenty twenty ten ten atm canwithdraw amount 310 cannot because atm has only 300 atm canwithdraw amount 100 can withdraw 1x100 atm canwithdraw amount 165 cannot withdraw because atm doesnt has bill with value of 5 atm canwithdraw amount 30 can withdraw 1x20 2x10 further examples design patterns in swift swift üë´ command the command pattern is used to express a request including the call to be made and all of its required parameters in a command object the command may then be executed immediately or held for later use example swift protocol doorcommand func execute string class opencommand doorcommand let doors string required init doors string self doors doors func execute string return opened \ doors class closecommand doorcommand let doors string required init doors string self doors doors func execute string return closed \ doors class hal9000doorsoperations let opencommand doorcommand let closecommand doorcommand init doors string self opencommand opencommand doors doors self closecommand closecommand doors doors func close string return closecommand execute func open string return opencommand execute usage swift let podbaydoors pod bay doors let doormodule hal9000doorsoperations doors podbaydoors doormodule open doormodule close üé∂ interpreter the interpreter pattern is used to evaluate sentences in a language example swift protocol integerexpression func evaluate context integercontext int func replace character character integerexpression integerexpression integerexpression func copied integerexpression final class integercontext private var data character int func lookup name character int return self data name func assign expression integervariableexpression value int self data expression name value final class integervariableexpression integerexpression let name character init name character self name name func evaluate context integercontext int return context lookup name self name func replace character name character integerexpression integerexpression integerexpression if name self name return integerexpression copied else return integervariableexpression name self name func copied integerexpression return integervariableexpression name self name final class addexpression integerexpression private var operand1 integerexpression private var operand2 integerexpression init op1 integerexpression op2 integerexpression self operand1 op1 self operand2 op2 func evaluate context integercontext int return self operand1 evaluate context self operand2 evaluate context func replace character character integerexpression integerexpression integerexpression return addexpression op1 operand1 replace character character integerexpression integerexpression op2 operand2 replace character character integerexpression integerexpression func copied integerexpression return addexpression op1 self operand1 op2 self operand2 usage swift var context integercontext var a integervariableexpression name a var b integervariableexpression name b var c integervariableexpression name c var expression addexpression op1 a op2 addexpression op1 b op2 c a b c context assign expression a value 2 context assign expression b value 1 context assign expression c value 3 var result expression evaluate context further examples design patterns in swift swift üç´ iterator the iterator pattern is used to provide a standard interface for traversing a collection of items in an aggregate object without the need to understand its underlying structure example swift struct novella let name string struct novellas let novellas novella struct novellasiterator iteratorprotocol private var current 0 private let novellas novella init novellas novella self novellas novellas mutating func next novella defer current 1 return novellas count current novellas current nil extension novellas sequence func makeiterator novellasiterator return novellasiterator novellas novellas usage swift let greatnovellas novellas novellas novella name the mist for novella in greatnovellas print ive read novella üíê mediator the mediator pattern is used to reduce coupling between classes that communicate with each other instead of classes communicating directly and thus requiring knowledge of their implementation the classes send messages via a mediator object example swift protocol receiver associatedtype messagetype func receive message messagetype protocol sender associatedtype messagetype associatedtype receivertype receiver var recipients receivertype get func send message messagetype struct programmer receiver let name string init name string self name name func receive message string print \ name received \ message final class messagemediator sender internal var recipients programmer func add recipient programmer recipients append recipient func send message string for recipient in recipients recipient receive message message usage swift func spammonster message string worker messagemediator worker send message message let messagesmediator messagemediator let user0 programmer name linus torvalds let user1 programmer name avadis avie tevanian messagesmediator add recipient user0 messagesmediator add recipient user1 spammonster message id like to add you to my professional network worker messagesmediator further examples design patterns in swift swift üíæ memento the memento pattern is used to capture the current state of an object and store it in such a manner that it can be restored at a later time without breaking the rules of encapsulation example swift typealias memento nsdictionary originator swift protocol mementoconvertible var memento memento get init memento memento struct gamestate mementoconvertible private enum keys static let chapter com valve halflife chapter static let weapon com valve halflife weapon var chapter string var weapon string init chapter string weapon string self chapter chapter self weapon weapon init memento memento guard let mementochapter memento keys chapter as string let mementoweapon memento keys weapon as string else return nil chapter mementochapter weapon mementoweapon var memento memento return keys chapter chapter keys weapon weapon caretaker swift enum checkpoint static func save state mementoconvertible savename string let defaults userdefaults standard defaults set state memento forkey savename defaults synchronize static func restore savename string memento let defaults userdefaults standard return defaults object forkey savename as memento usage swift var gamestate gamestate chapter black mesa inbound weapon crowbar gamestate chapter anomalous materials gamestate weapon glock 17 checkpoint save gamestate savename gamestate1 gamestate chapter unforeseen consequences gamestate weapon mp5 checkpoint save gamestate savename gamestate2 gamestate chapter office complex gamestate weapon crossbow checkpoint save gamestate savename gamestate3 if let memento checkpoint restore savename gamestate1 let finalstate gamestate memento memento dump finalstate üëì observer the observer pattern is used to allow an object to publish changes to its state other objects subscribe to be immediately notified of any changes example swift protocol propertyobserver class func willchange propertyname string newpropertyvalue any func didchange propertyname string oldpropertyvalue any final class testchambers weak var observer propertyobserver private let testchambernumbername testchambernumber var testchambernumber int 0 willset newvalue observer willchange propertyname testchambernumbername newpropertyvalue newvalue didset observer didchange propertyname testchambernumbername oldpropertyvalue oldvalue final class observer propertyobserver func willchange propertyname string newpropertyvalue any if newpropertyvalue as int 1 print okay look we both said a lot of things that youre going to regret func didchange propertyname string oldpropertyvalue any if oldpropertyvalue as int 0 print sorry about the mess ive really let the place go since you killed me usage swift var observerinstance observer var testchambers testchambers testchambers observer observerinstance testchambers testchambernumber 1 further examples design patterns in swift swift üêâ state the state pattern is used to alter the behaviour of an object as its internal state changes the pattern allows the class for an object to apparently change at run time example swift final class context private var state state unauthorizedstate var isauthorized bool get return state isauthorized context self var userid string get return state userid context self func changestatetoauthorized userid string state authorizedstate userid userid func changestatetounauthorized state unauthorizedstate protocol state func isauthorized context context bool func userid context context string class unauthorizedstate state func isauthorized context context bool return false func userid context context string return nil class authorizedstate state let userid string init userid string self userid userid func isauthorized context context bool return true func userid context context string return userid usage swift let usercontext context usercontext isauthorized usercontext userid usercontext changestatetoauthorized userid admin usercontext isauthorized usercontext userid now logged in as admin usercontext changestatetounauthorized usercontext isauthorized usercontext userid further examples design patterns in swift swift üí° strategy the strategy pattern is used to create an interchangeable family of algorithms from which the required process is chosen at run time example swift protocol printstrategy func print string string string final class printer private let strategy printstrategy func print string string string return self strategy print string init strategy printstrategy self strategy strategy final class uppercasestrategy printstrategy func print string string string return string uppercased final class lowercasestrategy printstrategy func print string string string return string lowercased usage swift var lower printer strategy lowercasestrategy lower print o tempora o mores var upper printer strategy uppercasestrategy upper print o tempora o mores further examples design patterns in swift swift üç™ template the template pattern is used when two or more implementations of an algorithm exist the template is defined and then built upon with further variations use this method when most or all subclasses need to implement the same behavior traditionally this would be accomplished with abstract classes and protected methods as in java however in swift because abstract classes dont exist yet maybe someday we need to accomplish the behavior using interface delegation example swift protocol icodegenerator func crosscompile protocol igeneratorphases func collectsource func crosscompile class codegenerator icodegenerator var delegate igeneratorphases init delegate igeneratorphases self delegate delegate private func fetchdataforgeneration common implementation print fetchdataforgeneration invoked template method final func crosscompile fetchdataforgeneration delegate collectsource delegate crosscompile class htmlgeneratorphases igeneratorphases func collectsource print htmlgeneratorphases collectsource executed func crosscompile print htmlgeneratorphases crosscompile executed class jsongeneratorphases igeneratorphases func collectsource print jsongeneratorphases collectsource executed func crosscompile print jsongeneratorphases crosscompile executed usage swift let htmlgen icodegenerator codegenerator delegate htmlgeneratorphases let jsongen icodegenerator codegenerator delegate jsongeneratorphases htmlgen crosscompile jsongen crosscompile üèÉ visitor the visitor pattern is used to separate a relatively complex set of structured data classes from the functionality that may be performed upon the data that they hold example swift protocol planetvisitor func visit planet planetalderaan func visit planet planetcoruscant func visit planet planettatooine func visit planet moonjedah protocol planet func accept visitor planetvisitor class moonjedah planet func accept visitor planetvisitor visitor visit planet self class planetalderaan planet func accept visitor planetvisitor visitor visit planet self class planetcoruscant planet func accept visitor planetvisitor visitor visit planet self class planettatooine planet func accept visitor planetvisitor visitor visit planet self class namevisitor planetvisitor var name func visit planet planetalderaan name alderaan func visit planet planetcoruscant name coruscant func visit planet planettatooine name tatooine func visit planet moonjedah name jedah usage swift let planets planet planetalderaan planetcoruscant planettatooine moonjedah let names planets map planet planet string in let visitor namevisitor planet accept visitor visitor return visitor name names further examples design patterns in swift swift behavioral creational structural creational in software engineering creational design patterns are design patterns that deal with object creation mechanisms trying to create objects in a manner suitable to the situation the basic form of object creation could result in design problems or added complexity to the design creational design patterns solve this problem by somehow controlling this object creation source wikipedia org swift import swift import foundation üå∞ abstract factory the abstract factory pattern is used to provide a client with a set of related or dependant objects the family of objects created by the factory are determined at run time example swift protocols swift protocol decimal func stringvalue string factory static func make string string decimal typealias numberfactory string decimal number implementations with factory methods struct nextstepnumber decimal private var nextstepnumber nsnumber func stringvalue string return nextstepnumber stringvalue factory static func make string string decimal return nextstepnumber nextstepnumber nsnumber value string as nsstring longlongvalue struct swiftnumber decimal private var swiftint int func stringvalue string return \ swiftint factory static func make string string decimal return swiftnumber swiftint string as nsstring integervalue abstract factory swift enum numbertype case nextstep swift enum numberhelper static func factory for type numbertype numberfactory switch type case nextstep return nextstepnumber make case swift return swiftnumber make usage swift let factoryone numberhelper factory for nextstep let numberone factoryone 1 numberone stringvalue let factorytwo numberhelper factory for swift let numbertwo factorytwo 2 numbertwo stringvalue üë∑ builder the builder pattern is used to create complex objects with constituent parts that must be created in the same order or using a specific algorithm an external class controls the construction algorithm example swift class deathstarbuilder var x double var y double var z double typealias builderclosure deathstarbuilder init buildclosure builderclosure buildclosure self struct deathstar customstringconvertible let x double let y double let z double init builder deathstarbuilder if let x builder x let y builder y let z builder z self x x self y y self z z else return nil var description string return death star at x \ x y \ y z \ z usage swift let empire deathstarbuilder builder in builder x 0 1 builder y 0 2 builder z 0 3 let deathstar deathstar builder empire further examples design patterns in swift swift üè≠ factory method the factory pattern is used to replace class constructors abstracting the process of object generation so that the type of the object instantiated can be determined at run time example swift protocol currency func symbol string func code string class euro currency func symbol string return ‚Ç¨ func code string return eur class unitedstatesdolar currency func symbol string return func code string return usd enum country case unitedstates spain uk greece enum currencyfactory static func currency for country country currency switch country case spain greece return euro case unitedstates return unitedstatesdolar default return nil usage swift let nocurrencycode no currency code available currencyfactory currency for greece code nocurrencycode currencyfactory currency for spain code nocurrencycode currencyfactory currency for unitedstates code nocurrencycode currencyfactory currency for uk code nocurrencycode üÉè prototype the prototype pattern is used to instantiate a new object by copying all of the properties of an existing object creating an independent clone this practise is particularly useful when the construction of a new object is inefficient example swift class chungasrevengedisplay var name string let font string init font string self font font func clone chungasrevengedisplay return chungasrevengedisplay font self font usage swift let prototype chungasrevengedisplay font gotanproject let philippe prototype clone philippe name philippe let christoph prototype clone christoph name christoph let eduardo prototype clone eduardo name eduardo further examples design patterns in swift swift üíç singleton the singleton pattern ensures that only one object of a particular class is ever created all further references to objects of the singleton class refer to the same underlying instance there are very few applications do not overuse this pattern example swift class deathstarsuperlaser static let sharedinstance deathstarsuperlaser private init private initialization to ensure just one instance is created usage swift let laser deathstarsuperlaser sharedinstance behavioral creational structural structural in software engineering structural design patterns are design patterns that ease the design by identifying a simple way to realize relationships between entities source wikipedia org swift import swift import foundation üîå adapter the adapter pattern is used to provide a link between two otherwise incompatible types by wrapping the adaptee with a class that supports the interface required by the client example swift protocol olderdeathstarsuperlaseraiming var anglev nsnumber get var angleh nsnumber get adaptee swift struct deathstarsuperlasertarget let anglehorizontal double let anglevertical double init anglehorizontal double anglevertical double self anglehorizontal anglehorizontal self anglevertical anglevertical adapter swift struct olddeathstarsuperlasertarget olderdeathstarsuperlaseraiming private let target deathstarsuperlasertarget var anglev nsnumber return nsnumber value target anglevertical var angleh nsnumber return nsnumber value target anglehorizontal init target deathstarsuperlasertarget self target target usage swift let target deathstarsuperlasertarget anglehorizontal 14 0 anglevertical 12 0 let oldformat olddeathstarsuperlasertarget target oldformat angleh oldformat anglev further examples design patterns in swift swift üåâ bridge the bridge pattern is used to separate the abstract elements of a class from the implementation details providing the means to replace the implementation details without modifying the abstraction example swift protocol switch var appliance appliance get set func turnon protocol appliance func run class remotecontrol switch var appliance appliance func turnon self appliance run init appliance appliance self appliance appliance class tv appliance func run print tv turned on class vacuumcleaner appliance func run print vacuum cleaner turned on usage swift var tvremotecontrol remotecontrol appliance tv tvremotecontrol turnon var fancyvacuumcleanerremotecontrol remotecontrol appliance vacuumcleaner fancyvacuumcleanerremotecontrol turnon üåø composite the composite pattern is used to create hierarchical recursive tree structures of related objects where any element of the structure may be accessed and utilised in a standard manner example swift component swift protocol shape func draw fillcolor string leafs swift final class square shape func draw fillcolor string print drawing a square with color fillcolor final class circle shape func draw fillcolor string print drawing a circle with color fillcolor composite swift final class whiteboard shape lazy var shapes shape init shapes shape self shapes shapes func draw fillcolor string for shape in self shapes shape draw fillcolor fillcolor usage swift var whiteboard whiteboard circle square whiteboard draw fillcolor red üçß decorator the decorator pattern is used to extend or alter the functionality of objects at run time by wrapping them in an object of a decorator class this provides a flexible alternative to using inheritance to modify behaviour example swift protocol coffee func getcost double func getingredients string class simplecoffee coffee func getcost double return 1 0 func getingredients string return coffee class coffeedecorator coffee private let decoratedcoffee coffee fileprivate let ingredientseparator string required init decoratedcoffee coffee self decoratedcoffee decoratedcoffee func getcost double return decoratedcoffee getcost func getingredients string return decoratedcoffee getingredients final class milk coffeedecorator required init decoratedcoffee coffee super init decoratedcoffee decoratedcoffee override func getcost double return super getcost 0 5 override func getingredients string return super getingredients ingredientseparator milk final class whipcoffee coffeedecorator required init decoratedcoffee coffee super init decoratedcoffee decoratedcoffee override func getcost double return super getcost 0 7 override func getingredients string return super getingredients ingredientseparator whip usage swift var somecoffee coffee simplecoffee print cost somecoffee getcost ingredients somecoffee getingredients somecoffee milk decoratedcoffee somecoffee print cost somecoffee getcost ingredients somecoffee getingredients somecoffee whipcoffee decoratedcoffee somecoffee print cost somecoffee getcost ingredients somecoffee getingredients üéÅ fa√ßade the facade pattern is used to define a simplified interface to a more complex subsystem example swift enum eternal static func set object any forkey defaultname string let defaults userdefaults userdefaults standard defaults set object forkey defaultname defaults synchronize static func object forkey key string anyobject let defaults userdefaults userdefaults standard return defaults object forkey key as anyobject usage swift eternal set disconnect me id rather be nothing forkey bishop eternal object forkey bishop üçÉ flyweight the flyweight pattern is used to minimize memory usage or computational expenses by sharing as much as possible with other similar objects example swift instances of coffeeflavour will be the flyweights final class specialitycoffee customstringconvertible var origin string var description string get return origin init origin string self origin origin menu acts as a factory and cache for coffeeflavour flyweight objects final class menu private var coffeeavailable string specialitycoffee func lookup origin string specialitycoffee if coffeeavailable index forkey origin nil coffeeavailable origin specialitycoffee origin origin return coffeeavailable origin final class coffeeshop private var orders int specialitycoffee private var menu menu func takeorder origin string table int orders table menu lookup origin origin func serve for table origin in orders print serving \ origin to table \ table usage swift let coffeeshop coffeeshop coffeeshop takeorder origin yirgacheffe ethiopia table 1 coffeeshop takeorder origin buziraguhindwa burundi table 3 coffeeshop serve ‚òî protection proxy the proxy pattern is used to provide a surrogate or placeholder object which references an underlying object protection proxy is restricting access example swift protocol dooroperator func open doors string string class hal9000 dooroperator func open doors string string return hal9000 affirmative dave i read you opened doors class currentcomputer dooroperator private var computer hal9000 func authenticate password string bool guard password pass else return false computer hal9000 return true func open doors string string guard computer nil else return access denied im afraid i cant do that return computer open doors doors usage swift let computer currentcomputer let podbay pod bay doors computer open doors podbay computer authenticate password pass computer open doors podbay üç¨ virtual proxy the proxy pattern is used to provide a surrogate or placeholder object which references an underlying object virtual proxy is used for loading object on demand example swift protocol hevsuitmedicalaid func administermorphine string class hevsuit hevsuitmedicalaid func administermorphine string return morphine administered class hevsuithumaninterface hevsuitmedicalaid lazy private var physicalsuit hevsuit hevsuit func administermorphine string return physicalsuit administermorphine usage swift let humaninterface hevsuithumaninterface humaninterface administermorphine info üìñ descriptions from gang of four design patterns reference sheet swift