sheetjs js xlsx parser and writer for various spreadsheet formats pure js cleanroom implementation from official specifications related documents and test files emphasis on parsing and writing robustness cross format feature compatibility with a unified js representation and es3 es5 browser compatibility back to ie6 this is the community version we also offer a pro version with performance enhancements additional features like styling and dedicated support pro version commercial support rendered documentation in browser demos source code issues and bug reports other general support issues file format support for known spreadsheet data formats graph of supported formats click to show browser test table of contents expand to show table of contents toc installation js ecosystem demos optional modules ecmascript 5 compatibility philosophy parsing workbooks parsing examples streaming read working with the workbook parsing and writing examples writing workbooks writing examples streaming write interface parsing functions writing functions utilities common spreadsheet format general structures cell object data types dates sheet objects worksheet object chartsheet object macrosheet object dialogsheet object workbook object workbook file properties workbook level attributes defined names workbook views miscellaneous workbook properties document features formulae column properties row properties number formats hyperlinks cell comments sheet visibility vba and macros parsing options input type guessing file type writing options supported output formats output type utility functions array of arrays input array of objects input html table input formulae output delimiter separated output utf 16 unicode text html output json file formats excel 2007 xml xlsx xlsm excel 2 0 95 biff2 biff3 biff4 biff5 excel 97 2004 binary biff8 excel 2003 2004 spreadsheetml excel 2007 binary xlsb biff12 delimiter separated values csv txt other workbook formats lotus 1 2 3 wks wk1 wk2 wk3 wk4 123 quattro pro wq1 wq2 wb1 wb2 wb3 qpw opendocument spreadsheet ods fods uniform office spreadsheet uos1 2 other single worksheet formats dbase and visual foxpro dbf symbolic link sylk lotus formatted text prn data interchange format dif html rich text format rtf ethercalc record format eth testing node browser tested environments test files contributing osx linux windows tests license references tocstop installation in the browser just add a script tag html script lang javascript src dist xlsx full min js script cdn availability click to show cdn url unpkg https unpkg com xlsx jsdelivr https jsdelivr com package npm xlsx cdnjs http cdnjs com libraries xlsx packd https bundle run xlsx latest name xlsx unpkg makes the latest version available at html script src https unpkg com xlsx dist xlsx full min js script with npm bash npm install xlsx with bower bash bower install js xlsx js ecosystem demos the demos directory includes sample projects for frameworks and apis angularjs angular 2 4 5 6 and ionic knockout meteor react and react native vue 2 x and weex xmlhttprequest and fetch nodejs server databases and key value stores typed arrays and math bundlers and tooling browserify fusebox parcel requirejs rollup systemjs typescript webpack 2 x platforms and integrations electron application nw js application chrome chromium extensions adobe extendscript headless browsers canvas datagrid swift jsc and other engines serverless functions internet explorer optional modules optional features click to show the node version automatically requires modules for additional features some of these modules are rather large in size and are only needed in special circumstances so they do not ship with the core for browser use they must be included directly html international support from js codepage script src dist cpexcel js script an appropriate version for each dependency is included in the dist directory the complete single file version is generated at dist xlsx full min js webpack and browserify builds include optional modules by default webpack can be configured to remove support with resolve alias js uncomment the lines below to remove support resolve alias dist cpexcel js omit international support ecmascript 5 compatibility since the library uses functions like array foreach older browsers require shims to provide missing functions to use the shim add the shim before the script tag that loads xlsx js html add the shim first script type text javascript src shim min js script after the shim is referenced add the library script type text javascript src xlsx full min js script the script also includes ie loadfile and ie savefile for loading and saving files in internet explorer versions 6 9 the xlsx extendscript js script bundles the shim in a format suitable for photoshop and other adobe products philosophy philosophy click to show prior to sheetjs apis for processing spreadsheet files were format specific third party libraries either supported one format or they involved a separate set of classes for each supported file type even though xlsb was introduced in excel 2007 nothing outside of sheetjs or excel supported the format to promote a format agnostic view js xlsx starts from a pure js representation that we call the common spreadsheet format emphasizing a uniform object representation enables new features like format conversion reading an xlsx template and saving as xls and circumvents the class trap by abstracting the complexities of the various formats tools need not worry about the specific file type a simple object representation combined with careful coding practices enables use cases in older browsers and in alternative environments like extendscript and web workers it is always tempting to use the latest and greatest features but they tend to require the latest versions of browsers limiting usability utility functions capture common use cases like generating js objects or html most simple operations should only require a few lines of code more complex operations generally should be straightforward to implement excel pushes the xlsx format as default starting in excel 2007 however there are other formats with more appealing properties for example the xlsb format is spiritually similar to xlsx but files often tend up taking less than half the space and open much faster even though an xlsx writer is available other format writers are available so users can take advantage of the unique characteristics of each format the primary focus of the community edition is correct data interchange focused on extracting data from any compatible data representation and exporting data in various formats suitable for any third party interface parsing workbooks for parsing the first step is to read the file this involves acquiring the data and feeding it into the library here are a few common scenarios nodejs read a file click to show readfile is only available in server environments browsers have no api for reading arbitrary files given a path so another strategy must be used js if typeof require undefined xlsx require xlsx var workbook xlsx readfile test xlsx do something with workbook here photoshop extendscript read a file click to show readfile wraps the file logic in photoshop and other extendscript targets the specified path should be an absolute path js include xlsx extendscript js read test xlsx from the documents folder var workbook xlsx readfile folder mydocuments test xlsx do something with workbook here the extendscript demo includes a more complex example browser read table element from page click to show the table to book and table to sheet utility functions take a dom table element and iterate through the child nodes js var workbook xlsx utils table to book document getelementbyid tableau do something with workbook here multiple tables on a web page can be converted to individual worksheets js create new workbook var workbook xlsx utils book new convert table table1 to worksheet named sheet1 var ws1 xlsx utils table to sheet document getelementbyid table1 xlsx utils book append sheet workbook ws1 sheet1 convert table table2 to worksheet named sheet2 var ws2 xlsx utils table to sheet document getelementbyid table2 xlsx utils book append sheet workbook ws2 sheet2 workbook now has 2 worksheets alternatively the html code can be extracted and parsed js var htmlstr document getelementbyid tableau outerhtml var workbook xlsx read htmlstr type string browser download file ajax click to show note for a more complete example that works in older browsers check the demo at http oss sheetjs com js xlsx ajax html the xhr demo includes more examples with xmlhttprequest and fetch js var url http oss sheetjs com test files formula stress test xlsx set up async get request var req new xmlhttprequest req open get url true req responsetype arraybuffer req onload function e var data new uint8array req response var workbook xlsx read data type array do something with workbook here req send browser drag and drop click to show drag and drop uses the html5 filereader api loading the data with readasbinarystring or readasarraybuffer since not all browsers support the full filereader api dynamic feature tests are highly recommended js var rabs true true readasbinarystring false readasarraybuffer function handledrop e e stoppropagation e preventdefault var files e datatransfer files f files 0 var reader new filereader reader onload function e var data e target result if rabs data new uint8array data var workbook xlsx read data type rabs binary array do something with workbook here if rabs reader readasbinarystring f else reader readasarraybuffer f drop dom element addeventlistener drop handledrop false browser file upload form element click to show data from file input elements can be processed using the same filereader api as in the drag and drop example js var rabs true true readasbinarystring false readasarraybuffer function handlefile e var files e target files f files 0 var reader new filereader reader onload function e var data e target result if rabs data new uint8array data var workbook xlsx read data type rabs binary array do something with workbook here if rabs reader readasbinarystring f else reader readasarraybuffer f input dom element addeventlistener change handlefile false the oldie demo shows an ie compatible fallback scenario more specialized cases including mobile app file processing are covered in the included demos parsing examples http oss sheetjs com js xlsx html5 file api base64 text web workers note that older versions of ie do not support html5 file api so the base64 mode is used for testing get base64 encoding on osx windows click to show on osx you can get the base64 encoding with bash target file base64 pbcopy on windows xp and up you can get the base64 encoding using certutil cmd certutil encode target file target file b64 note you have to open the file and remove the header and footer lines http oss sheetjs com js xlsx ajax html xmlhttprequest streaming read why is there no streaming read api click to show the most common and interesting formats xls xlsx m xlsb ods are ultimately zip or cfb containers of files neither format puts the directory structure at the beginning of the file zip files place the central directory records at the end of the logical file while cfb files can place the storage info anywhere in the file as a result to properly handle these formats a streaming function would have to buffer the entire file before commencing that belies the expectations of streaming so we do not provide any streaming read api when dealing with readable streams the easiest approach is to buffer the stream and process the whole thing at the end this can be done with a temporary file or by explicitly concatenating the stream explicitly concatenating streams click to show js var fs require fs var xlsx require xlsx function process rs stream readstream cb wb workbook void void var buffers stream on data function data buffers push data stream on end function var buffer buffer concat buffers var workbook xlsx read buffer type buffer do something with workbook in the callback cb workbook more robust solutions are available using modules like concat stream writing to filesystem first click to show this example uses tempfile to generate file names js var fs require fs tempfile require tempfile var xlsx require xlsx function process rs stream readstream cb wb workbook void void var fname tempfile sheetjs console log fname var ostream fs createwritestream fname stream pipe ostream ostream on finish function var workbook xlsx readfile fname fs unlinksync fname do something with workbook in the callback cb workbook working with the workbook the full object format is described later in this readme reading a specific cell click to show this example extracts the value stored in cell a1 from the first worksheet js var first sheet name workbook sheetnames 0 var address of cell a1 get worksheet var worksheet workbook sheets first sheet name find desired cell var desired cell worksheet address of cell get the value var desired value desired cell desired cell v undefined adding a new worksheet to a workbook click to show this example uses xlsx utils aoa to sheet to make a sheet and xlsx utils book append sheet to append the sheet to the workbook js var new ws name sheetjs make worksheet var ws data s h e e t j s 1 2 3 4 5 var ws xlsx utils aoa to sheet ws data add the worksheet to the workbook xlsx utils book append sheet wb ws ws name creating a new workbook from scratch click to show the workbook object contains a sheetnames array of names and a sheets object mapping sheet names to sheet objects the xlsx utils book new utility function creates a new workbook object js create a new blank workbook var wb xlsx utils book new the new workbook is blank and contains no worksheets the write functions will error if the workbook is empty parsing and writing examples http sheetjs com demos modify html read modify write files https github com sheetjs js xlsx blob master bin xlsx njs node the node version installs a command line tool xlsx which can read spreadsheet files and output the contents in various formats the source is available at xlsx njs in the bin directory some helper functions in xlsx utils generate different views of the sheets xlsx utils sheet to csv generates csv xlsx utils sheet to txt generates utf16 formatted text xlsx utils sheet to html generates html xlsx utils sheet to json generates an array of objects xlsx utils sheet to formulae generates a list of formulae writing workbooks for writing the first step is to generate output data the helper functions write and writefile will produce the data in various formats suitable for dissemination the second step is to actual share the data with the end point assuming workbook is a workbook object nodejs write a file click to show xlsx writefile uses fs writefilesync in server environments js if typeof require undefined xlsx require xlsx output format determined by filename xlsx writefile workbook out xlsb at this point out xlsb is a file that you can distribute photoshop extendscript write a file click to show writefile wraps the file logic in photoshop and other extendscript targets the specified path should be an absolute path js include xlsx extendscript js output format determined by filename xlsx writefile workbook out xlsx at this point out xlsx is a file that you can distribute the extendscript demo includes a more complex example browser add table element to page click to show the sheet to html utility function generates html code that can be added to any dom element js var worksheet workbook sheets workbook sheetnames 0 var container document getelementbyid tableau container innerhtml xlsx utils sheet to html worksheet browser upload file ajax click to show a complete example using xhr is included in the xhr demo along with examples for fetch and wrapper libraries this example assumes the server can handle base64 encoded files see the demo for a basic nodejs server js in this example send a base64 string to the server var wopts booktype xlsx booksst false type base64 var wbout xlsx write workbook wopts var req new xmlhttprequest req open post upload true var formdata new formdata formdata append file test xlsx server expects file to hold name formdata append data wbout data holds the base64 encoded data req send formdata browser save file click to show xlsx writefile wraps a few techniques for triggering a file save url browser api creates an object url for the file which the library uses by creating a link and forcing a click it is supported in modern browsers mssaveblob is an ie10 api for triggering a file save ie filesave uses vbscript and activex to write a file in ie6 for windows xp and windows 7 the shim must be included in the containing html page there is no standard way to determine if the actual file has been downloaded js output format determined by filename xlsx writefile workbook out xlsb at this point out xlsb will have been downloaded browser save file compatibility click to show xlsx writefile techniques work for most modern browsers as well as older ie for much older browsers there are workarounds implemented by wrapper libraries filesaver js implements saveas note xlsx writefile will automatically call saveas if available js booktype can be any supported output type var wopts booktype xlsx booksst false type array var wbout xlsx write workbook wopts the saveas call downloads a file on the local machine saveas new blob wbout type application octet stream test xlsx downloadify uses a flash swf button to generate local files suitable for environments where activex is unavailable js downloadify create id other options are required read the downloadify docs for more info filename test xlsx data function return xlsx write wb booktype xlsx type base64 append false datatype base64 the oldie demo shows an ie compatible fallback scenario the included demos cover mobile apps and other special deployments writing examples http sheetjs com demos table html exporting an html table http sheetjs com demos writexlsx html generates a simple file streaming write the streaming write functions are available in the xlsx stream object they take the same arguments as the normal write functions but return a readable stream they are only exposed in nodejs xlsx stream to csv is the streaming version of xlsx utils sheet to csv xlsx stream to html is the streaming version of xlsx utils sheet to html xlsx stream to json is the streaming version of xlsx utils sheet to json nodejs convert to csv and write file click to show js var output file name out csv var stream xlsx stream to csv worksheet stream pipe fs createwritestream output file name nodejs write json stream to screen click to show js to json returns an object mode stream var stream xlsx stream to json worksheet raw true the following stream converts js objects to text via json stringify var conv new transform writableobjectmode true conv transform function obj e cb cb null json stringify obj \n stream pipe conv conv pipe process stdout https github com sheetjs sheetaki pipes write streams to nodejs response interface xlsx is the exposed variable in the browser and the exported node variable xlsx version is the version of the library added by the build script xlsx ssf is an embedded version of the format library parsing functions xlsx read data read opts attempts to parse data xlsx readfile filename read opts attempts to read filename and parse parse options are described in the parsing options section writing functions xlsx write wb write opts attempts to write the workbook wb xlsx writefile wb filename write opts attempts to write wb to filename in browser based environments it will attempt to force a client side download xlsx writefileasync filename wb o cb attempts to write wb to filename if o is omitted the writer will use the third argument as the callback xlsx stream contains a set of streaming write functions write options are described in the writing options section utilities utilities are available in the xlsx utils object and are described in the utility functions section importing aoa to sheet converts an array of arrays of js data to a worksheet json to sheet converts an array of js objects to a worksheet table to sheet converts a dom table element to a worksheet sheet add aoa adds an array of arrays of js data to an existing worksheet sheet add json adds an array of js objects to an existing worksheet exporting sheet to json converts a worksheet object to an array of json objects sheet to csv generates delimiter separated values output sheet to txt generates utf16 formatted text sheet to html generates html output sheet to formulae generates a list of the formulae with value fallbacks cell and cell address manipulation format cell generates the text value for a cell using number formats encode row decode row converts between 0 indexed rows and 1 indexed rows encode col decode col converts between 0 indexed columns and column names encode cell decode cell converts cell addresses encode range decode range converts cell ranges common spreadsheet format js xlsx conforms to the common spreadsheet format csf general structures cell address objects are stored as c c r r where c and r are 0 indexed column and row numbers respectively for example the cell address b5 is represented by the object c 1 r 4 cell range objects are stored as s s e e where s is the first cell and e is the last cell in the range the ranges are inclusive for example the range a3 b7 is represented by the object s c 0 r 2 e c 1 r 6 utility functions perform a row major order walk traversal of a sheet range js for var r range s r r range e r r for var c range s c c range e c c var cell address c c r r if an a1 style address is needed encode the address var cell ref xlsx utils encode cell cell address cell object cell objects are plain js objects with keys and values following the convention key description v raw value see data types section for more info w formatted text if applicable t type b boolean e error n number d date s text z stub f cell formula encoded as an a1 style string if applicable f range of enclosing array if formula is array formula if applicable r rich text encoding if applicable h html rendering of the rich text if applicable c comments associated with the cell z number format string associated with the cell if requested l cell hyperlink object target holds link tooltip is tooltip s the style theme of the cell if applicable built in export utilities such as the csv exporter will use the w text if it is available to change a value be sure to delete cell w or set it to undefined before attempting to export the utilities will regenerate the w text from the number format cell z and the raw value if possible the actual array formula is stored in the f field of the first cell in the array range other cells in the range will omit the f field data types the raw value is stored in the v value property interpreted based on the t type property this separation allows for representation of numbers as well as numeric text there are 6 valid cell types type description b boolean value interpreted as js boolean e error value is a numeric code and w property stores common name n number value is a js number d date value is a js date object or string to be parsed as date s text value interpreted as js string and written as text z stub blank stub cell that is ignored by data processing utilities error values and interpretation click to show value error meaning 0x00 null 0x07 div 0 0x0f value 0x17 ref 0x1d name 0x24 num 0x2a n a 0x2b getting data type n is the number type this includes all forms of data that excel stores as numbers such as dates times and boolean fields excel exclusively uses data that can be fit in an ieee754 floating point number just like js number so the v field holds the raw number the w field holds formatted text dates are stored as numbers by default and converted with xlsx ssf parse date code type d is the date type generated only when the option celldates is passed since json does not have a natural date type parsers are generally expected to store iso 8601 date strings like you would get from date toisostring on the other hand writers and exporters should be able to handle date strings and js date objects note that excel disregards timezone modifiers and treats all dates in the local timezone the library does not correct for this error type s is the string type values are explicitly stored as text excel will interpret these cells as number stored as text generated excel files automatically suppress that class of error but other formats may elicit errors type z represents blank stub cells they are generated in cases where cells have no assigned value but hold comments or other metadata they are ignored by the core library data processing utility functions by default these cells are not generated the parser sheetstubs option must be set to true dates excel date code details click to show by default excel stores dates as numbers with a format code that specifies date processing for example the date 19 feb 17 is stored as the number 42785 with a number format of d mmm yy the ssf module understands number formats and performs the appropriate conversion xlsx also supports a special date type d where the data is an iso 8601 date string the formatter converts the date back to a number the default behavior for all parsers is to generate number cells setting celldates to true will force the generators to store dates time zones and dates click to show excel has no native concept of universal time all times are specified in the local time zone excel limitations prevent specifying true absolute dates following excel this library treats all dates as relative to local time zone epochs 1900 and 1904 click to show excel supports two epochs january 1 1900 and january 1 1904 see 1900 vs 1904 date system article the workbooks epoch can be determined by examining the workbooks wb workbook wbprops date1904 property js wb workbook wbprops date1904 sheet objects each key that does not start with maps to a cell using a 1 notation sheet address returns the cell object for the specified address special sheet keys accessible as sheet key each starting with sheet ref a 1 based range representing the sheet range functions that work with sheets should use this parameter to determine the range cells that are assigned outside of the range are not processed in particular when writing a sheet by hand cells outside of the range are not included functions that handle sheets should test for the presence of ref field if the ref is omitted or is not a valid range functions are free to treat the sheet as empty or attempt to guess the range the standard utilities that ship with this library treat sheets as empty for example the csv output is empty string when reading a worksheet with the sheetrows property set the ref parameter will use the restricted range the original range is set at ws fullref sheet margins object representing the page margins the default values follow excels normal preset excel also has a wide and a narrow preset but they are stored as raw measurements the main properties are listed below page margin details click to show key description normal wide narrow left left margin inches 0 7 1 0 0 25 right right margin inches 0 7 1 0 0 25 top top margin inches 0 75 1 0 0 75 bottom bottom margin inches 0 75 1 0 0 75 header header margin inches 0 3 0 5 0 3 footer footer margin inches 0 3 0 5 0 3 js set worksheet sheet to normal ws margins left 0 7 right 0 7 top 0 75 bottom 0 75 header 0 3 footer 0 3 set worksheet sheet to wide ws margins left 1 0 right 1 0 top 1 0 bottom 1 0 header 0 5 footer 0 5 set worksheet sheet to narrow ws margins left 0 25 right 0 25 top 0 75 bottom 0 75 header 0 3 footer 0 3 worksheet object in addition to the base sheet keys worksheets also add ws cols array of column properties objects column widths are actually stored in files in a normalized manner measured in terms of the maximum digit width the largest width of the rendered digits 0 9 in pixels when parsed the column objects store the pixel width in the wpx field character width in the wch field and the maximum digit width in the mdw field ws rows array of row properties objects as explained later in the docs each row object encodes properties including row height and visibility ws merges array of range objects corresponding to the merged cells in the worksheet plain text formats do not support merge cells csv export will write all cells in the merge range if they exist so be sure that only the first cell upper left in the range is set ws protect object of write sheet protection properties the password key specifies the password for formats that support password protected sheets xlsx xlsb xls the writer uses the xor obfuscation method the following keys control the sheet protection set to false to enable a feature when sheet is locked or set to true to disable a feature worksheet protection details click to show key feature true disabled false enabled default selectlockedcells select locked cells enabled selectunlockedcells select unlocked cells enabled formatcells format cells disabled formatcolumns format columns disabled formatrows format rows disabled insertcolumns insert columns disabled insertrows insert rows disabled inserthyperlinks insert hyperlinks disabled deletecolumns delete columns disabled deleterows delete rows disabled sort sort disabled autofilter filter disabled pivottables use pivottable reports disabled objects edit objects enabled scenarios edit scenarios enabled ws autofilter autofilter object following the schema typescript type autofilter ref string a 1 based range representing the autofilter table range chartsheet object chartsheets are represented as standard sheets they are distinguished with the type property set to chart the underlying data and ref refer to the cached data in the chartsheet the first row of the chartsheet is the underlying header macrosheet object macrosheets are represented as standard sheets they are distinguished with the type property set to macro dialogsheet object dialogsheets are represented as standard sheets they are distinguished with the type property set to dialog workbook object workbook sheetnames is an ordered list of the sheets in the workbook wb sheets sheetname returns an object representing the worksheet wb props is an object storing the standard properties wb custprops stores custom properties since the xls standard properties deviate from the xlsx standard xls parsing stores core properties in both places wb workbook stores workbook level attributes workbook file properties the various file formats use different internal names for file properties the workbook props object normalizes the names file properties click to show js name excel description title summary tab title subject summary tab subject author summary tab author manager summary tab manager company summary tab company category summary tab category keywords summary tab keywords comments summary tab comments lastauthor statistics tab last saved by createddate statistics tab created for example to set the workbook title property js if wb props wb props wb props title insert title here custom properties are added in the workbook custprops object js if wb custprops wb custprops wb custprops custom property custom value writers will process the props key of the options object js force the author to be sheetjs xlsx write wb props author sheetjs workbook level attributes wb workbook stores workbook level attributes defined names wb workbook names is an array of defined name objects which have the keys defined name properties click to show key description sheet name scope sheet index 0 first sheet or null workbook name case sensitive name standard rules apply ref a1 style reference sheet1 a 1 d 20 comment comment only applicable for xls xlsx xlsb excel allows two sheet scoped defined names to share the same name however a sheet scoped name cannot collide with a workbook scope name workbook writers may not enforce this constraint workbook views wb workbook views is an array of workbook view objects which have the keys key description rtl if true display right to left miscellaneous workbook properties wb workbook wbprops holds other workbook properties key description codename vba project workbook code name date1904 epoch 0 false for 1900 system 1 true for 1904 filterprivacy warn or strip personally identifying info on save document features even for basic features like date storage the official excel formats store the same content in different ways the parsers are expected to convert from the underlying file format representation to the common spreadsheet format writers are expected to convert from csf back to the underlying file format formulae the a1 style formula string is stored in the f field even though different file formats store the formulae in different ways the formats are translated even though some formats store formulae with a leading equal sign csf formulae do not start with representation of a1 1 a2 2 a3 a1 a2 click to show js ref a1 a3 a1 t n v 1 a2 t n v 2 a3 t n v 3 f a1 a2 shared formulae are decompressed and each cell has the formula corresponding to its cell writers generally do not attempt to generate shared formulae cells with formula entries but no value will be serialized in a way that excel and other spreadsheet tools will recognize this library will not automatically compute formula results for example to compute besselj in a worksheet formula without known value click to show js ref a1 a3 a1 t n v 3 14159 a2 t n v 2 a3 t n f besselj a1 a2 array formulae array formulae are stored in the top left cell of the array block all cells of an array formula have a f field corresponding to the range a single cell formula can be distinguished from a plain formula by the presence of f field array formula examples click to show for example setting the cell c1 to the array formula sum a1 a3 b1 b3 js worksheet c1 t n f sum a1 a3 b1 b3 f c1 c1 for a multi cell array formula every cell has the same array range but only the first cell specifies the formula consider d1 d3 a1 a3 b1 b3 js worksheet d1 t n f d1 d3 f a1 a3 b1 b3 worksheet d2 t n f d1 d3 worksheet d3 t n f d1 d3 utilities and writers are expected to check for the presence of a f field and ignore any possible formula element f in cells other than the starting cell they are not expected to perform validation of the formulae formula output utility function click to show the sheet to formulae method generates one line per formula or array formula array formulae are rendered in the form range formula while plain cells are rendered in the form cell formula or value note that string literals are prefixed with an apostrophe consistent with excels formula bar display formulae file format details click to show storage representation formats read write a1 style strings xlsx o o rc style strings xlml and plain text o o biff parsed formulae xlsb and all xls formats o openformula formulae ods fods uos o o since excel prohibits named cells from colliding with names of a1 or rc style cell references a not so simple regex conversion is possible biff parsed formulae have to be explicitly unwound openformula formulae can be converted with regular expressions column properties the cols array in each worksheet if present is a collection of colinfo objects which have the following properties typescript type colinfo visibility hidden boolean if true the column is hidden column width is specified in one of the following ways wpx number width in screen pixels width number width in excels max digit width width 256 is integral wch number width in characters other fields for preserving features from files mdw number excels max digit width unit always integral why are there three width types click to show there are three different width types corresponding to the three different ways spreadsheets store column widths sylk and other plain text formats use raw character count contemporaneous tools like visicalc and multiplan were character based since the characters had the same width it sufficed to store a count this tradition was continued into the biff formats spreadsheetml 2003 tried to align with html by standardizing on screen pixel count throughout the file column widths row heights and other measures use pixels when the pixel and character counts do not align excel rounds values xlsx internally stores column widths in a nebulous max digit width form the max digit width is the width of the largest digit when rendered generally the 0 character is the widest the internal width must be an integer multiple of the the width divided by 256 ecma 376 describes a formula for converting between pixels and the internal width this represents a hybrid approach read functions attempt to populate all three properties write functions will try to cycle specified values to the desired type in order to avoid potential conflicts manipulation should delete the other properties first for example when changing the pixel width delete the wch and width properties implementation details click to show given the constraints it is possible to determine the mdw without actually inspecting the font the parsers guess the pixel width by converting from width to pixels and back repeating for all possible mdw and selecting the mdw that minimizes the error xlml actually stores the pixel width so the guess works in the opposite direction even though all of the information is made available writers are expected to follow the priority order 1 use width field if available 2 use wpx pixel width if available 3 use wch character count if available row properties the rows array in each worksheet if present is a collection of rowinfo objects which have the following properties typescript type rowinfo visibility hidden boolean if true the row is hidden row height is specified in one of the following ways hpx number height in screen pixels hpt number height in points level number 0 indexed outline group level note excel ui displays the base outline level as 1 and the max level as 8 the level field stores the base outline as 0 and the max level as 7 implementation details click to show excel internally stores row heights in points the default resolution is 72 dpi or 96 ppi so the pixel and point size should agree for different resolutions they may not agree so the library separates the concepts even though all of the information is made available writers are expected to follow the priority order 1 use hpx pixel height if available 2 use hpt point height if available number formats the cell w formatted text for each cell is produced from cell v and cell z format if the format is not specified the excel general format is used the format can either be specified as a string or as an index into the format table parsers are expected to populate workbook ssf with the number format table writers are expected to serialize the table custom tools should ensure that the local table has each used format string somewhere in the table excel convention mandates that the custom formats start at index 164 the following example creates a custom format from scratch new worksheet with custom format click to show js var wb sheetnames sheet1 sheets sheet1 ref a1 c1 a1 t n v 10000 general format b1 t n v 10000 z 0 builtin format c1 t n v 10000 z \ t\ \ 0 00 custom format the rules are slightly different from how excel displays custom number formats in particular literal characters must be wrapped in double quotes or preceded by a backslash for more info see the excel documentation article create or delete a custom number format or ecma 376 18 8 31 number formats default number formats click to show the default formats are listed in ecma 376 18 8 30 id format 0 general 1 0 2 0 00 3 0 4 0 00 9 0 10 0 00 11 0 00e 00 12 13 14 m d yy see below 15 d mmm yy 16 d mmm 17 mmm yy 18 h mm am pm 19 h mm ss am pm 20 h mm 21 h mm ss 22 m d yy h mm 37 0 0 38 0 red 0 39 0 00 0 00 40 0 00 red 0 00 45 mm ss 46 h mm ss 47 mmss 0 48 0 0e 0 49 format 14 m d yy is localized by excel even though the file specifies that number format it will be drawn differently based on system settings it makes sense when the producer and consumer of files are in the same locale but that is not always the case over the internet to get around this ambiguity parse functions accept the datenf option to override the interpretation of that specific format string hyperlinks hyperlinks are stored in the l key of cell objects the target field of the hyperlink object is the target of the link including the uri fragment tooltips are stored in the tooltip field and are displayed when you move your mouse over the text for example the following snippet creates a link from cell a3 to http sheetjs com with the tip find us sheetjs com js ws a3 l target http sheetjs com tooltip find us sheetjs com note that excel does not automatically style hyperlinks they will generally be displayed as normal text links where the target is a cell or range or defined name in the same workbook internal links are marked with a leading hash character js ws a2 l target e2 link to cell e2 cell comments cell comments are objects stored in the c array of cell objects the actual contents of the comment are split into blocks based on the comment author the a field of each comment object is the author of the comment and the t field is the plain text representation for example the following snippet appends a cell comment into cell a1 js if ws a1 c ws a1 c ws a1 c push a sheetjs t im a little comment short and stout note xlsb enforces a 54 character limit on the author name names longer than 54 characters may cause issues with other formats to mark a comment as normally hidden set the hidden property js if ws a1 c ws a1 c ws a1 c push a sheetjs t this comment is visible if ws a2 c ws a2 c ws a2 c hidden true ws a2 c push a sheetjs t this comment will be hidden sheet visibility excel enables hiding sheets in the lower tab bar the sheet data is stored in the file but the ui does not readily make it available standard hidden sheets are revealed in the unhide menu excel also has very hidden sheets which cannot be revealed in the menu it is only accessible in the vb editor the visibility setting is stored in the hidden property of sheet props array more details click to show value definition 0 visible 1 hidden 2 very hidden with https rawgit com sheetjs test files master sheet visibility xlsx js wb workbook sheets map function x return x name x hidden visible 0 hidden 1 veryhidden 2 non excel formats do not support the very hidden state the best way to test if a sheet is visible is to check if the hidden property is logical truth js wb workbook sheets map function x return x name x hidden visible true hidden false veryhidden false vba and macros vba macros are stored in a special data blob that is exposed in the vbaraw property of the workbook object when the bookvba option is true they are supported in xlsm xlsb and biff8 xls formats the supported format writers automatically insert the data blobs if it is present in the workbook and associate with the worksheet names custom code names click to show the workbook code name is stored in wb workbook wbprops codename by default excel will write thisworkbook or a translated phrase like diesearbeitsmappe worksheet and chartsheet code names are in the worksheet properties object at wb workbook sheets i codename macrosheets and dialogsheets are ignored the readers and writers preserve the code names but they have to be manually set when adding a vba blob to a different workbook macrosheets click to show older versions of excel also supported a non vba macrosheet sheet type that stored automation commands these are exposed in objects with the type property set to macro detecting macros in workbooks click to show the vbaraw field will only be set if macros are present so testing is simple js function wb has macro wb workbook boolean if wb vbaraw return true const sheets wb sheetnames map n wb sheets n return sheets some ws ws ws type macro parsing options the exported read and readfile functions accept an options argument option name default description type input data encoding see input type below raw false if true plain text parsing will not parse values codepage if specified use code page when appropriate cellformula true save formulae to the f field cellhtml true parse rich text and save html to the h field cellnf false save number format string to the z field cellstyles false save style theme info to the s field celltext true generated formatted text to the w field celldates false store dates as type d default is n datenf if specified use the string for date code 14 sheetstubs false create cell objects of type z for stub cells sheetrows 0 if 0 read the first sheetrows rows bookdeps false if true parse calculation chains bookfiles false if true add raw files to book object bookprops false if true only parse enough to get book metadata booksheets false if true only parse enough to get the sheet names bookvba false if true copy vba blob to vbaraw field password if defined and file is encrypted use password wtf false if true throw errors on unexpected file features even if cellnf is false formatted text will be generated and saved to w in some cases sheets may be parsed even if booksheets is false excel aggressively tries to interpret values from csv and other plain text this leads to surprising behavior the raw option suppresses value parsing booksheets and bookprops combine to give both sets of information deps will be an empty object if bookdeps is false bookfiles behavior depends on file type keys array paths in the zip for zip based formats files hash mapping paths to objects representing the files for zip cfb object for formats using cfb containers sheetrows 1 rows will be generated when looking at the json object output since the header row is counted as a row when parsing the data bookvba merely exposes the raw vba cfb object it does not parse the data xlsm and xlsb store the vba cfb object in xl vbaproject bin biff8 xls mixes the vba entries alongside the core workbook entry so the library generates a new xlsb compatible blob from the xls cfb container codepage is applied to biff2 biff5 files without codepage records and to csv files without bom in type binary biff8 xls always defaults to 1200 currently only xor encryption is supported unsupported error will be thrown for files employing other encryption methods wtf is mainly for development by default the parser will suppress read errors on single worksheets allowing you to read from the worksheets that do parse properly setting wtf 1 forces those errors to be thrown input type strings can be interpreted in multiple ways the type parameter for read tells the library how to parse the data argument type expected input base64 string base64 encoding of the file binary string binary string byte n is data charcodeat n string string js string characters interpreted as utf8 buffer nodejs buffer array array array of 8 bit unsigned int byte n is data n file string path of file that will be read nodejs only guessing file type implementation details click to show excel and other spreadsheet tools read the first few bytes and apply other heuristics to determine a file type this enables file type punning renaming files with the xls extension will tell your computer to use excel to open the file but excel will know how to handle it this library applies similar logic byte 0 raw file type spreadsheet types 0xd0 cfb container biff 5 8 or password protected xlsx xlsb or wq3 qpw 0x09 biff stream biff 2 3 4 5 0x3c xml html spreadsheetml flat ods uos1 html plain text 0x50 zip archive xlsb or xlsx m or ods or uos2 or plain text 0x49 plain text sylk or plain text 0x54 plain text dif or plain text 0xef utf8 encoded spreadsheetml flat ods uos1 html plain text 0xff utf16 encoded spreadsheetml flat ods uos1 html plain text 0x00 record stream lotus wk or quattro pro or plain text 0x7b plain text rtf or plain text 0x0a plain text spreadsheetml flat ods uos1 html plain text 0x0d plain text spreadsheetml flat ods uos1 html plain text 0x20 plain text spreadsheetml flat ods uos1 html plain text dbf files are detected based on the first byte as well as the third and fourth bytes corresponding to month and day of the file date plain text format guessing follows the priority order format test xml xml appears in the first 1024 characters html starts with and html tags appear in the first 1024 characters xml starts with rtf starts with \rt dsv starts with sep separator is the specified character dsv more unquoted chars than \t or in the first 1024 tsv more unquoted \t chars than chars in the first 1024 csv one of the first 1024 characters is a comma eth starts with socialcalc version prn default html tags include html table head meta script style div why are random text files valid click to show excel is extremely aggressive in reading files adding an xls extension to any display text file where the only characters are ansi display chars tricks excel into thinking that the file is potentially a csv or tsv file even if it is only one column this library attempts to replicate that behavior the best approach is to validate the desired worksheet and ensure it has the expected number of rows or columns extracting the range is extremely simple js var range xlsx utils decode range worksheet ref var ncols range e c range s c 1 nrows range e r range s r 1 writing options the exported write and writefile functions accept an options argument option name default description type output data encoding see output type below celldates false store dates as type d default is n booksst false generate shared string table booktype xlsx type of workbook see below for supported formats sheet name of worksheet for single sheet formats compression false use zip compression for zip based formats props override workbook properties when writing themexlsx override theme xml when writing xlsx xlsb xlsm booksst is slower and more memory intensive but has better compatibility with older versions of ios numbers the raw data is the only thing guaranteed to be saved features not described in this readme may not be serialized celldates only applies to xlsx output and is not guaranteed to work with third party readers excel itself does not usually write cells with type d so non excel tools may ignore the data or error in the presence of dates props is an object mirroring the workbook props field see the table from the workbook file properties section if specified the string from themexlsx will be saved as the primary theme for xlsx xlsb xlsm files to xl theme theme1 xml in the zip supported output formats for broad compatibility with third party tools this library supports many output formats the specific file type is controlled with booktype option booktype file ext container sheets description xlsx xlsx zip multi excel 2007 xml format xlsm xlsm zip multi excel 2007 macro xml format xlsb xlsb zip multi excel 2007 binary format biff8 xls cfb multi excel 97 2004 workbook format biff5 xls cfb multi excel 5 0 95 workbook format biff2 xls none single excel 2 0 worksheet format xlml xls none multi excel 2003 2004 spreadsheetml ods ods zip multi opendocument spreadsheet fods fods none multi flat opendocument spreadsheet csv csv none single comma separated values txt txt none single utf 16 unicode text txt sylk sylk none single symbolic link sylk html html none single html document dif dif none single data interchange format dif dbf dbf none single dbase ii vfp extensions dbf rtf rtf none single rich text format rtf prn prn none single lotus formatted text eth eth none single ethercalc record format eth compression only applies to formats with zip containers formats that only support a single sheet require a sheet option specifying the worksheet if the string is empty the first worksheet is used writefile will automatically guess the output file format based on the file extension if booktype is not specified it will choose the first format in the aforementioned table that matches the extension output type the type argument for write mirrors the type argument for read type output base64 string base64 encoding of the file binary string binary string byte n is data charcodeat n string string js string characters interpreted as utf8 buffer nodejs buffer array arraybuffer fallback array of 8 bit unsigned int file string path of file that will be created nodejs only utility functions the sheet to functions accept a worksheet and an optional options object the to sheet functions accept a data object and an optional options object the examples are based on the following worksheet xxx a b c d e f g 1 s h e e t j s 2 1 2 3 4 5 6 7 3 2 3 4 5 6 7 8 array of arrays input xlsx utils aoa to sheet takes an array of arrays of js values and returns a worksheet resembling the input data numbers booleans and strings are stored as the corresponding styles dates are stored as date or numbers array holes and explicit undefined values are skipped null values may be stubbed all other values are stored as strings the function takes an options argument option name default description datenf fmt 14 use specified date format in string output celldates false store dates as type d default is n sheetstubs false create cell objects of type z for null values examples click to show to generate the example sheet js var ws xlsx utils aoa to sheet sheetjs split 1 2 3 4 5 6 7 2 3 4 5 6 7 8 xlsx utils sheet add aoa takes an array of arrays of js values and updates an existing worksheet object it follows the same process as aoa to sheet and accepts an options argument option name default description datenf fmt 14 use specified date format in string output celldates false store dates as type d default is n sheetstubs false create cell objects of type z for null values origin use specified cell as starting point see below origin is expected to be one of origin description cell object use specified cell cell object string use specified cell a1 style cell number 0 start from the first column at specified row 0 indexed 1 append to bottom of worksheet starting on first column default start from cell a1 examples click to show consider the worksheet xxx a b c d e f g 1 s h e e t j s 2 1 2 5 6 7 3 2 3 6 7 8 4 3 4 7 8 9 5 4 5 6 7 8 9 0 this worksheet can be built up in the order a1 g1 a2 b4 e2 g4 a5 g5 js initial row var ws xlsx utils aoa to sheet sheetjs split write data starting at a2 xlsx utils sheet add aoa ws 1 2 2 3 3 4 origin a2 write data starting at e2 xlsx utils sheet add aoa ws 5 6 7 6 7 8 7 8 9 origin r 1 c 4 append row xlsx utils sheet add aoa ws 4 5 6 7 8 9 0 origin 1 array of objects input xlsx utils json to sheet takes an array of objects and returns a worksheet with automatically generated headers based on the keys of the objects the default column order is determined by the first appearance of the field using object keys but can be overridden using the options argument option name default description header use specified column order default object keys datenf fmt 14 use specified date format in string output celldates false store dates as type d default is n skipheader false if true do not include header row in output examples click to show the original sheet cannot be reproduced in the obvious way since js object keys must be unique after replacing the second e and s with e 1 and s 1 js var ws xlsx utils json to sheet s 1 h 2 e 3 e 1 4 t 5 j 6 s 1 7 s 2 h 3 e 4 e 1 5 t 6 j 7 s 1 8 header s h e e 1 t j s 1 alternatively the header row can be skipped js var ws xlsx utils json to sheet a s b h c e d e e t f j g s a 1 b 2 c 3 d 4 e 5 f 6 g 7 a 2 b 3 c 4 d 5 e 6 f 7 g 8 header a b c d e f g skipheader true xlsx utils sheet add json takes an array of objects and updates an existing worksheet object it follows the same process as json to sheet and accepts an options argument option name default description header use specified column order default object keys datenf fmt 14 use specified date format in string output celldates false store dates as type d default is n skipheader false if true do not include header row in output origin use specified cell as starting point see below origin is expected to be one of origin description cell object use specified cell cell object string use specified cell a1 style cell number 0 start from the first column at specified row 0 indexed 1 append to bottom of worksheet starting on first column default start from cell a1 examples click to show consider the worksheet xxx a b c d e f g 1 s h e e t j s 2 1 2 5 6 7 3 2 3 6 7 8 4 3 4 7 8 9 5 4 5 6 7 8 9 0 this worksheet can be built up in the order a1 g1 a2 b4 e2 g4 a5 g5 js initial row var ws xlsx utils json to sheet a s b h c e d e e t f j g s header a b c d e f g skipheader true write data starting at a2 xlsx utils sheet add json ws a 1 b 2 a 2 b 3 a 3 b 4 skipheader true origin a2 write data starting at e2 xlsx utils sheet add json ws a 5 b 6 c 7 a 6 b 7 c 8 a 7 b 8 c 9 skipheader true origin r 1 c 4 header a b c append row xlsx utils sheet add json ws a 4 b 5 c 6 d 7 e 8 f 9 g 0 header a b c d e f g skipheader true origin 1 html table input xlsx utils table to sheet takes a table dom element and returns a worksheet resembling the input table numbers are parsed all other data will be stored as strings xlsx utils table to book produces a minimal workbook based on the worksheet both functions accept options arguments option name default description raw if true every cell will hold raw strings datenf fmt 14 use specified date format in string output celldates false store dates as type d default is n sheetrows 0 if 0 read the first sheetrows rows of the table display false if true hidden rows and cells will not be parsed examples click to show to generate the example sheet start with the html table html table id sheetjs tr td s td td h td td e td td e td td t td td j td td s td tr tr td 1 td td 2 td td 3 td td 4 td td 5 td td 6 td td 7 td tr tr td 2 td td 3 td td 4 td td 5 td td 6 td td 7 td td 8 td tr table to process the table js var tbl document getelementbyid sheetjs var wb xlsx utils table to book tbl note xlsx read can handle html represented as strings formulae output xlsx utils sheet to formulae generates an array of commands that represent how a person would enter data into an application each entry is of the form a1 cell address formula or value string literals are prefixed with a in accordance with excel examples click to show for the example sheet js var o xlsx utils sheet to formulae ws o 0 o 5 o 10 o 15 o 20 a1 \s f1 \j d2 4 b3 3 g3 8 delimiter separated output as an alternative to the writefile csv type xlsx utils sheet to csv also produces csv output the function takes an options argument option name default description fs field separator delimiter between fields rs \n record separator delimiter between rows datenf fmt 14 use specified date format in string output strip false remove trailing field separators in each record blankrows true include blank lines in the csv output skiphidden false skips hidden rows columns in the csv output strip will remove trailing commas from each line under default fs rs blankrows must be set to false to skip blank lines examples click to show for the example sheet js console log xlsx utils sheet to csv ws s h e e t j s 1 2 3 4 5 6 7 2 3 4 5 6 7 8 console log xlsx utils sheet to csv ws fs \t s h e e t j s 1 2 3 4 5 6 7 2 3 4 5 6 7 8 console log xlsx utils sheet to csv ws fs rs s h e e t j s 1 2 3 4 5 6 7 2 3 4 5 6 7 8 utf 16 unicode text the txt output type uses the tab character as the field separator if the codepage library is available included in full distribution but not core the output will be encoded in cp1200 and the bom will be prepended xlsx utils sheet to txt takes the same arguments as sheet to csv html output as an alternative to the writefile html type xlsx utils sheet to html also produces html output the function takes an options argument option name default description id specify the id attribute for the table element editable false if true set contenteditable true for every td header override header default html body footer override footer default body html examples click to show for the example sheet js console log xlsx utils sheet to html ws json xlsx utils sheet to json generates different types of js objects the function takes an options argument option name default description raw false use raw values true or formatted strings false range from ws override range see table below header control output format see table below datenf fmt 14 use specified date format in string output defval use specified value in place of null or undefined blankrows include blank lines in the output raw only affects cells which have a format code z field or a formatted text w field if header is specified the first row is considered a data row if header is not specified the first row is the header row and not considered data when header is not specified the conversion will automatically disambiguate header entries by affixing and a count starting at 1 for example if three columns have header foo the output fields are foo foo 1 foo 2 null values are returned when raw is true but are skipped when false if defval is not specified null and undefined values are skipped normally if specified all null and undefined points will be filled with defval when header is 1 the default is to generate blank rows blankrows must be set to false to skip blank rows when header is not 1 the default is to skip blank rows blankrows must be true to generate blank rows range is expected to be one of range description number use worksheet range but set starting row to the value string use specified range a1 style bounded range string default use worksheet range ws ref header is expected to be one of header description 1 generate an array of arrays 2d array a row object keys are literal column labels array of strings use specified strings as keys in row objects default read and disambiguate first row as keys if header is not 1 the row object will contain the non enumerable property rownum that represents the row of the sheet corresponding to the entry examples click to show for the example sheet js xlsx utils sheet to json ws s 1 h 2 e 3 e 1 4 t 5 j 6 s 1 7 s 2 h 3 e 4 e 1 5 t 6 j 7 s 1 8 xlsx utils sheet to json ws header a a s b h c e d e e t f j g s a 1 b 2 c 3 d 4 e 5 f 6 g 7 a 2 b 3 c 4 d 5 e 6 f 7 g 8 xlsx utils sheet to json ws header a e i o u 6 9 6 j 9 s a s e h i e o e u t 6 6 9 7 a 1 e 2 i 3 o 4 u 5 6 7 9 8 a 2 e 3 i 4 o 5 u 6 xlsx utils sheet to json ws header 1 s h e e t j s 1 2 3 4 5 6 7 2 3 4 5 6 7 8 example showing the effect of raw js ws a2 w 3 set a2 formatted string value xlsx utils sheet to json ws header 1 s h e e t j s 3 2 3 4 5 6 7 a2 uses the formatted string 2 3 4 5 6 7 8 xlsx utils sheet to json ws header 1 raw true s h e e t j s 1 2 3 4 5 6 7 a2 uses the raw value 2 3 4 5 6 7 8 file formats despite the library name xlsx it supports numerous spreadsheet file formats format read write excel worksheet workbook formats excel 2007 xml formats xlsx xlsm o o excel 2007 binary format xlsb biff12 o o excel 2003 2004 xml format xml spreadsheetml o o excel 97 2004 xls biff8 o o excel 5 0 95 xls biff5 o o excel 4 0 xls xlw biff4 o excel 3 0 xls biff3 o excel 2 0 2 1 xls biff2 o o excel supported text formats delimiter separated values csv txt o o data interchange format dif o o symbolic link sylk slk o o lotus formatted text prn o o utf 16 unicode text txt o o other workbook worksheet formats opendocument spreadsheet ods o o flat xml odf spreadsheet fods o o uniform office format spreadsheet 标文通 uos1 uos2 o dbase ii iii iv visual foxpro dbf o o lotus 1 2 3 wks wk1 wk2 wk3 wk4 123 o quattro pro spreadsheet wq1 wq2 wb1 wb2 wb3 qpw o other common spreadsheet output formats html tables o o rich text format tables rtf o ethercalc record format eth o o features not supported by a given file format will not be written formats with range limits will be silently truncated format last cell max cols max rows excel 2007 xml formats xlsx xlsm xfd1048576 16384 1048576 excel 2007 binary format xlsb biff12 xfd1048576 16384 1048576 excel 97 2004 xls biff8 iv65536 256 65536 excel 5 0 95 xls biff5 iv16384 256 16384 excel 2 0 2 1 xls biff2 iv16384 256 16384 excel 2003 spreadsheetml range limits are governed by the version of excel and are not enforced by the writer excel 2007 xml xlsx xlsm click to show xlsx and xlsm files are zip containers containing a series of xml files in accordance with the open packaging conventions opc the xlsm format almost identical to xlsx is used for files containing macros the format is standardized in ecma 376 and later in iso iec 29500 excel does not follow the specification and there are additional documents discussing how excel deviates from the specification excel 2 0 95 biff2 biff3 biff4 biff5 click to show biff 2 3 xls are single sheet streams of binary records excel 4 introduced the concept of a workbook xlw files but also had single sheet xls format the structure is largely similar to the lotus 1 2 3 file formats biff5 8 12 extended the format in various ways but largely stuck to the same record format there is no official specification for any of these formats excel 95 can write files in these formats so record lengths and fields were determined by writing in all of the supported formats and comparing files excel 2016 can generate biff5 files enabling a full suite of file tests starting from xlsx or biff2 excel 97 2004 binary biff8 click to show biff8 exclusively uses the compound file binary container format splitting some content into streams within the file at its core it still uses an extended version of the binary record format from older versions of biff the ms xls specification covers the basics of the file format and other specifications expand on serialization of features like properties excel 2003 2004 spreadsheetml click to show predating xlsx spreadsheetml files are simple xml files there is no official and comprehensive specification although ms has released documentation on the format since excel 2016 can generate spreadsheetml files mapping features is pretty straightforward excel 2007 binary xlsb biff12 click to show introduced in parallel with xlsx the xlsb format combines the biff architecture with the content separation and zip container of xlsx for the most part nodes in an xlsx sub file can be mapped to xlsb records in a corresponding sub file the ms xlsb specification covers the basics of the file format and other specifications expand on serialization of features like properties delimiter separated values csv txt click to show excel csv deviates from rfc4180 in a number of important ways the generated csv files should generally work in excel although they may not work in rfc4180 compatible readers the parser should generally understand excel csv the writer proactively generates cells for formulae if values are unavailable excel txt uses tab as the delimiter and code page 1200 notes like in excel files starting with 0x49 0x44 id are treated as symbolic link files unlike excel if the file does not have a valid sylk header it will be proactively reinterpreted as csv there are some files with semicolon delimiter that align with a valid sylk file for the broadest compatibility all cells with the value of id are automatically wrapped in double quotes other workbook formats click to show support for other formats is generally far xls xlsb xlsx support due in large part to a lack of publicly available documentation test files were produced in the respective apps and compared to their xls exports to determine structure the main focus is data extraction lotus 1 2 3 wks wk1 wk2 wk3 wk4 123 click to show the lotus formats consist of binary records similar to the biff structure lotus did release a specification decades ago covering the original wk1 format other features were deduced by producing files and comparing to excel support quattro pro wq1 wq2 wb1 wb2 wb3 qpw click to show the quattro pro formats use binary records in the same way as biff and lotus some of the newer formats namely wb3 and qpw use a cfb enclosure just like biff8 xls opendocument spreadsheet ods fods click to show ods is an xml in zip format akin to xlsx while fods is an xml format akin to spreadsheetml both are detailed in the oasis standard but tools like lo oo add undocumented extensions the parsers and writers do not implement the full standard instead focusing on parts necessary to extract and store raw data uniform office spreadsheet uos1 2 click to show uos is a very similar format and it comes in 2 varieties corresponding to ods and fods respectively for the most part the difference between the formats is in the names of tags and attributes other single worksheet formats many older formats supported only one worksheet dbase and visual foxpro dbf click to show dbf is really a typed table format each column can only hold one data type and each record omits type information the parser generates a header row and inserts records starting at the second row of the worksheet the writer makes files compatible with visual foxpro extensions multi file extensions like external memos and tables are currently unsupported limited by the general ability to read arbitrary files in the web browser the reader understands dbf level 7 extensions like datetime symbolic link sylk click to show there is no real documentation all knowledge was gathered by saving files in various versions of excel to deduce the meaning of fields notes plain formulae are stored in the rc form column widths are rounded to integral characters lotus formatted text prn click to show there is no real documentation and in fact excel treats prn as an output only file format nevertheless we can guess the column widths and reverse engineer the original layout excels 240 character width limitation is not enforced data interchange format dif click to show there is no unified definition visicalc dif differs from lotus dif and both differ from excel dif where ambiguous the parser writer follows the expected behavior from excel in particular excel extends dif in incompatible ways since excel automatically converts numbers as strings to numbers numeric string constants are converted to formulae 0 3 0 3 dif technically expects numeric cells to hold the raw numeric data but excel permits formatted numbers including dates dif technically has no support for formulae but excel will automatically convert plain formulae array formulae are not preserved html click to show excel html worksheets include special metadata encoded in styles for example mso number format is a localized string containing the number format despite the metadata the output is valid html although it does accept bare symbols the writer adds type metadata to the td elements via the t tag the parser looks for those tags and overrides the default interpretation for example text like td 12345 td will be parsed as numbers but td t s 12345 td will be parsed as text rich text format rtf click to show excel rtf worksheets are stored in clipboard when copying cells or ranges from a worksheet the supported codes are a subset of the word rtf support ethercalc record format eth click to show ethercalc is an open source web spreadsheet powered by a record format reminiscent of sylk wrapped in a mime multi part message testing node click to show make test will run the node based tests by default it runs tests on files in every supported format to test a specific file type set fmts to the format you want to test feature specific tests are available with make test misc bash make test misc run core tests make test run full tests make test xls only use the xls test files make test xlsx only use the xlsx test files make test xlsb only use the xlsb test files make test xml only use the xml test files make test ods only use the ods test files to enable all errors set the environment variable wtf 1 bash make test run full tests wtf 1 make test enable all error messages flow and eslint checks are available bash make lint eslint checks make flow make lint flow checking make tslint check ts definitions browser click to show the core in browser tests are available at tests index html within this repo start a local server and navigate to that directory to run the tests make ctestserv will start a server on port 8000 make ctest will generate the browser fixtures to add more files edit the tests fixtures lst file and add the paths to run the full in browser tests clone the repo for oss sheetjs com and replace the xlsx js file then open a browser window and go to stress html bash cp xlsx js sheetjs github io cd sheetjs github io simplehttpserver or python msimplehttpserver or serve open a chromium app http localhost 8000 stress html tested environments click to show nodejs 0 8 0 10 0 12 4 x 5 x 6 x 7 x 8 x ie 6 7 8 9 10 11 ie 6 9 require shims chrome 24 including android 4 0 safari 6 ios and desktop edge 13 ff 18 and opera 12 tests utilize the mocha testing framework travis ci and sauce labs links https travis ci org sheetjs js xlsx for xlsx module in nodejs https semaphoreci com sheetjs js xlsx for xlsx module in nodejs https travis ci org sheetjs sheetjs github io for xls modules https saucelabs com u sheetjs for xls modules using sauce labs the travis ci test suite also includes tests for various time zones to change the timezone locally set the tz environment variable bash env tz asia kolkata wtf 1 make test misc test files test files are housed in another repo running make init will refresh the test files submodule and get the files note that this requires svn git hg and other commands that may not be available if make init fails please download the latest version of the test files snapshot from the repo latest snapshot click to show latest test files snapshot http github com sheetjs test files releases download 20170409 test files zip download and unzip to the test files subdirectory contributing due to the precarious nature of the open specifications promise it is very important to ensure code is cleanroom contribution notes file organization click to show at a high level the final script is a concatenation of the individual files in the bits folder running make should reproduce the final output on all platforms the readme is similarly split into bits in the docbits folder folders folder contents bits raw source files that make up the final script docbits raw markdown files that make up readme md bin server side bin scripts xlsx njs dist dist files for web browsers and nonstandard js environments demos demo projects for platforms like extendscript and webpack tests browser tests run make ctest to rebuild types typescript definitions and tests misc miscellaneous supporting scripts test files test files pulled from the test files repository after cloning the repo running make help will display a list of commands osx linux click to show the xlsx js file is constructed from the files in the bits subdirectory the build script run make will concatenate the individual bits to produce the script before submitting a contribution ensure that running make will produce the xlsx js file exactly the simplest way to test is to add the script bash git add xlsx js make clean make git diff xlsx js to produce the dist files run make dist the dist files are updated in each version release and should not be committed between versions windows click to show the included make cmd script will build xlsx js from the bits directory building is as simple as cmd make to prepare development environment cmd make init the full list of commands available in windows are displayed in make help make init install deps and global modules make lint run eslint linter make test run mocha test suite make misc run smaller test suite make book rebuild readme and summary make help display this message as explained in test files on windows the release zip file must be downloaded and extracted if bash on windows is available it is possible to run the osx linux workflow the following steps prepares the environment bash install support programs for the build and test commands sudo apt get install make git subversion mercurial install nodejs and npm within the wsl wget qo https deb nodesource com setup 8 x sudo bash sudo apt get install nodejs install dev dependencies sudo npm install g mocha voc blanket xlsjs tests click to show the test misc target make test misc on linux osx make misc on windows runs the targeted feature tests it should take 5 10 seconds to perform feature tests without testing against the entire test battery new features should be accompanied with tests for the relevant file formats and features for tests involving the read side an appropriate feature test would involve reading an existing file and checking the resulting workbook object if a parameter is involved files should be read with different values to verify that the feature is working as expected for tests involving a new write feature which can already be parsed appropriate feature tests would involve writing a workbook with the feature and then opening and verifying that the feature is preserved for tests involving a new write feature without an existing read ability please add a feature test to the kitchen sink tests write js license please consult the attached license file for details all rights not explicitly granted by the apache 2 0 license are reserved by the original author references osp covered specifications click to show ms cfb compound file binary file format ms ctxls excel custom toolbar binary file format ms exspxml3 excel calculation version 2 web service xml schema ms odata open data protocol odata ms odraw office drawing binary file format ms odrawxml office drawing extensions to office open xml structure ms oe376 office implementation information for ecma 376 standards support ms offcrypto office document cryptography structure ms oi29500 office implementation information for iso iec 29500 standards support ms oleds object linking and embedding ole data structures ms oleps object linking and embedding ole property set data structures ms oodf3 office implementation information for odf 1 2 standards support ms oshared office common data types and objects structures ms ovba office vba file format structure ms xldm spreadsheet data model file format ms xls excel binary file format xls structure specification ms xlsb excel xlsb binary file format ms xlsx excel xlsx extensions to the office open xml spreadsheetml file format xls microsoft office excel 97 2007 binary file format specification rtf rich text format iso iec 29500 2012 e information technology — document description and processing languages — office open xml file formats open document format for office applications version 1 2 29 september 2011 worksheet file format from lotus december 1984