winston a logger for just about everything winston 3 0 0 see the upgrade guide for more information bug reports and prs welcome looking for winston 2 x documentation please note that the documentation below is for winston 3 read the winston 2 x documentation motivation winston is designed to be a simple and universal logging library with support for multiple transports a transport is essentially a storage device for your logs each winston logger can have multiple transports see transports configured at different levels see logging levels for example one may want error logs to be stored in a persistent remote location like a database but all logs output to the console or a local file winston aims to decouple parts of the logging process to make it more flexible and extensible attention is given to supporting flexibility in log formatting see formats levels see using custom logging levels and ensuring those apis decoupled from the implementation of transport logging i e how the logs are stored indexed see adding custom transports to the api that they exposed to the programmer usage the recommended way to use winston is to create your own logger the simplest way to do this is using winston createlogger js const logger winston createlogger level info format winston format json transports write to all logs with levelinfoand below tocombined log write all logs error and below toerror log new winston transports file filename error log level error new winston transports file filename combined log if were not in production then log to the console with the format info level info message json stringify rest if process env node env production logger add new winston transports console format winston format simple you may also log directly via the default logger exposed by require winston but this merely intended to be a convenient shared logger to use throughout your application if you so choose table of contents logging creating your logger streams objectmode and info objects formats combining formats string interpolation filtering info objects creating custom formats logging levels using logging levels using custom logging levels transports multiple transports of the same type adding custom transports exceptions handling uncaught exceptions with winston to exit or not to exit profiling streaming logs querying logs further reading using the default logger awaiting logs to be written in winston working with multiple loggers in winston installation run tests logging logging levels in winston conform to the severity ordering specified by rfc5424 severity of all levels is assumed to be numerically ascending from most important to least important js const levels error 0 warn 1 info 2 verbose 3 debug 4 silly 5 creating your own logger you get started by creating a logger using winston createlogger js const logger winston createlogger transports new winston transports console new winston transports file filename combined log a logger accepts the following parameters name default description level info log only if info level less than or equal to this level levels winston config npm levels and colors representing log priorities format winston format json formatting for info messages see formats transports no transports set of logging targets for info messages exitonerror true if false handled exceptions will not cause process exit silent false if true all logs are suppressed the levels provided to createlogger will be defined as convenience methods on the logger returned js logging logger log level info message hello distributed log files logger info hello again distributed logs you can add or remove transports from the logger once it has been provided to you from winston createlogger js const files new winston transports file filename combined log const console new winston transports console logger clear remove all transports add console add console transport add files add file transport remove console remove console transport you can also wholesale reconfigure a winston logger instance using the configure method js const logger winston createlogger level info transports new winston transports console new winston transports file filename combined log replaces the previous transports with those in the new configuration wholesale const dailyrotatefile require winston daily rotate file logger configure level verbose transports new dailyrotatefile opts streams objectmode and info objects in winston both logger and transport instances are treated as objectmode streams that accept an info object the info object represents a single log message the object itself is mutable every info must have at least the level and message properties js level info level of the logging message message hey log something descriptive message being logged winston format itself exposes several additional properties splat string interpolation splat for d s style messages timestamp timestamp the message was received label custom label associated with each message as a consumer you may add whatever properties you wish â€“ internal state is maintained by symbol properties symbol for level read only equal to level property is treated as immutable by all code symbol for message complete string message set by finalizing formats json logstash printf prettyprint and simple formats formats in winston can be accessed from winston format they are implemented in logform a separate module from winston this allows flexibility when writing your own transports in case you wish to include a default format with your transport in modern versions of node template strings are very performant and are the recommended way for doing most end user formatting if you want to bespoke format your logs winston format printf is for you js const createlogger format transports require winston const combine timestamp label printf format const myformat printf info return info timestamp info label info level info message const logger createlogger format combine label label right meow timestamp myformat transports new transports console to see what built in formats are available and learn more about creating your own custom logging formats see logform combining formats any number of formats may be combined into a single format using format combine since format combine takes no opts as a convenience it returns pre created instance of the combined format js const createlogger format transports require winston const combine timestamp label prettyprint format const logger createlogger format combine label label right meow timestamp prettyprint transports new transports console logger log level info message what time is the testing at outputs level info message what time is the testing at label right meow timestamp 2017 09 30t03 57 26 875z string interpolation the log method provides the string interpolation using util format it must be enabled using format splat below is an example that defines a format with string interpolation of messages using format splat and then serializes the entire info message using format simple js const createlogger format transports require winston const logger createlogger format format combine format splat format simple transports new transports console info test message my string logger log info test message s my string info test message 123 logger log info test message d 123 info test message first second number 123 logger log info test message s s first second number 123 filtering info objects if you wish to filter out a given info object completely when logging then simply return a falsey value js const createlogger format transports require winston ignore log messages if they have private true const ignoreprivate format info opts if info private return false return info const logger createlogger format format combine ignoreprivate format json transports new transports console outputs level error message public error to share logger log level error message public error to share messages with private true will not be written when logged logger log private true level error message this is super secret hide it use of format combine will respect any falsey values return and stop evaluation of later formats in the series for example js const format require winston const combine timestamp label format const willneverthrow format combine format info return false ignores everything format info throw new error never reached creating custom formats formats are prototypal objects i e class instances that define a single method transform info opts and return the mutated info info an object representing the log message opts setting specific to the current instance of the format they are expected to return one of two things an info object representing the modified info argument object references need not be preserved if immutability is preferred all current built in formats consider info mutable but immutablejs is being considered for future releases a falsey value indicating that the info argument should be ignored by the caller see filtering info objects below winston format is designed to be as simple as possible to define a new format simple pass it a transform info opts function to get a new format the named format returned can be used to create as many copies of the given format as desired js const format require winston const volume format info opts if opts yell info message info message touppercase else if opts whisper info message info message tolowercase return info volume is now a function that returns instances of the format const scream volume yell true console dir scream transform level info message sorry for making you yell in your head scream options level info message sorry for making you yell in your head volume can be used multiple times to create different formats const whisper volume whisper true console dir whisper transform level info message why are they making us yell so much whisper options level info message why are they making us yell so much logging levels logging levels in winston conform to the severity ordering specified by rfc5424 severity of all levels is assumed to be numerically ascending from most important to least important each level is given a specific integer priority the higher the priority the more important the message is considered to be and the lower the corresponding integer priority for example as specified exactly in rfc5424 the syslog levels are prioritized from 0 to 7 highest to lowest js emerg 0 alert 1 crit 2 error 3 warning 4 notice 5 info 6 debug 7 similarly npm logging levels are prioritized from 0 to 5 highest to lowest js error 0 warn 1 info 2 verbose 3 debug 4 silly 5 if you do not explicitly define the levels that winston should use the npm levels above will be used using logging levels setting the level for your logging message can be accomplished in one of two ways you can pass a string representing the logging level to the log method or use the level specified methods defined on every winston logger js any logger instance logger log silly 127 0 0 1 theres no place like home logger log debug 127 0 0 1 theres no place like home logger log verbose 127 0 0 1 theres no place like home logger log info 127 0 0 1 theres no place like home logger log warn 127 0 0 1 theres no place like home logger log error 127 0 0 1 theres no place like home logger info 127 0 0 1 theres no place like home logger warn 127 0 0 1 theres no place like home logger error 127 0 0 1 theres no place like home default logger winston log info 127 0 0 1 theres no place like home winston info 127 0 0 1 theres no place like home winston allows you to define a level property on each transport which specifies the maximum level of messages that a transport should log for example using the syslog levels you could log only error messages to the console and everything info and below to a file which includes error messages js const logger winston createlogger levels winston config syslog levels transports new winston transports console level error new winston transports file filename combined log level info you may also dynamically change the log level of a transport js const transports console new winston transports console level warn file new winston transports file filename combined log level error const logger winston createlogger transports transports console transports file logger info will not be logged in either transport transports console level info transports file level info logger info will be logged in both transports winston supports customizable logging levels defaulting to npm style logging levels levels must be specified at the time of creating your logger using custom logging levels in addition to the predefined npm syslog and cli levels available in winston you can also choose to define your own js const mycustomlevels levels foo 0 bar 1 baz 2 foobar 3 colors foo blue bar green baz yellow foobar red const customlevellogger winston createlogger levels mycustomlevels levels customlevellogger foobar some foobar level ed message although there is slight repetition in this data structure it enables simple encapsulation if you do not want to have colors if you do wish to have colors in addition to passing the levels to the logger itself you must make winston aware of them js winston addcolors mycustomlevels colors this enables loggers using the colorize formatter to appropriately color and style the output of custom levels additionally you can also change background color and font style for example js baz italic yellow foobar bold red cyanbg possible options are below font styles bold dim italic underline inverse hidden strikethrough font foreground colors black red green yellow blue magenta cyan white gray grey background colors blackbg redbg greenbg yellowbg bluebg magentabg cyanbg whitebg colorizing standard logging levels to colorize the standard logging level add js winston format combine winston format colorize winston format json where winston format json is whatever other formatter you want to use the colorize formatter must come before any formatters adding text you wish to color transports there are several core transports included in winston which leverage the built in networking and file i o offered by node js core in addition there are additional transports written by members of the community multiple transports of the same type it is possible to use multiple transports of the same type e g winston transports file when you construct the transport js const logger winston createlogger transports new winston transports file filename combined log level info new winston transports file filename errors log level error if you later want to remove one of these transports you can do so by using the transport itself e g js const combinedlogs logger transports find transport return transport filename combined log logger remove combinedlogs adding custom transports adding a custom transport is easy all you need to do is accept any options you need implement a log method and consume it with winston js const transport require winston transport const util require util inherit from winston transport so you can take advantage of the base functionality and exceptions handle module exports class yourcustomtransport extends transport constructor opts super opts consume any custom options here e g connection information for databases authentication information for apis e g loggly papertrail logentries etc log info callback setimmediate this emit logged info perform the writing to the remote service callback exceptions handling uncaught exceptions with winston with winston it is possible to catch and log uncaughtexception events from your process with your own logger instance you can enable this behavior when its created or later on in your applications lifecycle js const createlogger transports require winston enable exception handling when you create your logger const logger createlogger transports new transports file filename combined log exceptionhandlers new transports file filename exceptions log or enable it later on by adding a transport or using exceptions handle const logger createlogger transports new transports file filename combined log call exceptions handle with a transport to handle exceptions logger exceptions handle new transports file filename exceptions log if you want to use this feature with the default logger simply call exceptions handle with a transport instance js you can add a separate exception logger by passing it to exceptions handle winston exceptions handle new winston transports file filename path to exceptions log alternatively you can set handleexceptions to true when adding transports to winston winston add new winston transports file filename path to combined log handleexceptions true to exit or not to exit by default winston will exit after logging an uncaughtexception if this is not the behavior you want set exitonerror false js const logger winston createlogger exitonerror false or like this logger exitonerror false when working with custom logger instances you can pass in separate transports to the exceptionhandlers property or set handleexceptions on any transport example 1 js const logger winston createlogger transports new winston transports file filename path to combined log exceptionhandlers new winston transports file filename path to exceptions log example 2 js const logger winston createlogger transports new winston transports console handleexceptions true exitonerror false the exitonerror option can also be a function to prevent exit on only certain types of errors js function ignoreepipe err return err code epipe const logger winston createlogger exitonerror ignoreepipe or like this logger exitonerror ignoreepipe profiling in addition to logging messages and metadata winston also has a simple profiling mechanism implemented for any logger js start profile of test logger profile test settimeout function stop profile of test logging will now take place 17 jan 21 00 00 info test duration 1000ms logger profile test 1000 also you can start a timer and keep a reference that you can call done on js returns an object corresponding to a specific timing when done is called the timer will finish and log the duration e g const profiler logger starttimer settimeout function profiler done message logging message 1000 all profile messages are set to info level by default and both message and metadata are optional there are no plans in the roadmap to make this configurable but we are open to suggestions through new issues querying logs winston supports querying of logs with loggly like options see loggly search api specifically file couchdb redis loggly nssocket and http js const options from new date 24 60 60 1000 until new date limit 10 start 0 order desc fields message find items logged between today and yesterday logger query options function err results if err todo handle me throw err console log results streaming logs streaming allows you to stream your logs back from your chosen transport js start at the end winston stream start 1 on log function log console log log further reading using the default logger the default logger is accessible through the winston module directly any method that you could call on an instance of a logger is available on the default logger js const winston require winston winston log info hello distributed log files winston info hello again distributed logs winston level debug winston log debug now my debug messages are written to console by default no transports are set on the default logger you must add or remove transports via the add and remove methods js const files new winston transports file filename combined log const console new winston transports console winston add console winston add files winston remove console or do it with one call to configure js winston configure transports new winston transports file filename somefile log for more documentation about working with each individual transport supported by winston see the winston transports document awaiting logs to be written in winston often it is useful to wait for your logs to be written before exiting the process each instance of winston logger is also a node js stream a finish event will be raised when all logs have flushed to all transports after the stream has been ended js const transport new winston transports console const logger winston createlogger transports transport transport on finished function info all info log messages has now been logged logger info chill winston seriously true logger end it is also worth mentioning that the logger also emits an error event which you should handle or suppress if you dont want unhandled exceptions js handle errors logger on error function err do something or just suppress them logger emiterrs false working with multiple loggers in winston often in larger more complex applications it is necessary to have multiple logger instances with different settings each logger is responsible for a different feature area or category this is exposed in winston in two ways through winston loggers and instances of winston container in fact winston loggers is just a predefined instance of winston container js const winston require winston configure the logger for category1 winston loggers add category1 console level silly label category one file filename path to some file configure the logger for category2 winston loggers add category2 couchdb host 127 0 0 1 port 5984 now that your loggers are setup you can require winston in any file in your application and access these pre configured loggers js const winston require winston grab your preconfigured logger const category1 winston loggers get category1 category1 info logging from your ioc container based logger if you prefer to manage the container yourself you can simply instantiate one js const winston require winston const container new winston container container add category1 console level silly file filename path to some file installation bash npm install winston bash yarn add winston run tests all of the winston tests are written with mocha nyc and assume they can be run with npm bash npm test author charlie robbins contributors jarrett cruger david hyde chris alderson