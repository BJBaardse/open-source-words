gpu js gpu js is a javascript acceleration library for gpgpu general purpose computing on gpus in javascript gpu js will automatically compile simple javascript functions into shader language and run them on the gpu in case a gpu is not available the functions will still run in regular javascript what is this sorcery matrix multiplication written in gpu js js const gpu new gpu create the gpu accelerated function from a kernel function that computes a single element in the 512 x 512 matrix 2d array the kernel function is run in a parallel manner in the gpu resulting in very fast computations sometimes const matmult gpu createkernel function a b var sum 0 for var i 0 i 512 i sum a this thread y i b i this thread x return sum setoutput 512 512 perform matrix multiplication on 2 matrices of size 512 x 512 const c matmult a b you can run a benchmark of this here typically it will run 1 15x faster depending on your hardware or alternatively you can experiment around with the kernel playground here table of contents installation gpu options gpu createkernel options creating and running functions accepting input graphical output combining kernels create kernel map adding custom functions adding custom functions directly to kernel loops pipelining supported math functions full api reference automatically built documentation contributors contributing terms explained license installation npm bash npm install gpu js save yarn bash yarn add gpu js npm package browser download the latest version of gpu js and include the files in your html page using the following tags html script src path to js gpu min js script in javascript initialize the library js const gpu new gpu gpu options options are an object used to create an instance of gpu example new gpu options canvas htmlcanvaselement optional for sharing canvas example use three js and gpu js on same canvas webgl webgl2renderingcontext or webglrenderingcontext for sharing rendering context example use three js and gpu js on same rendering context gpu createkernel options options are an object used to create a kernel or kernelmap example gpu createkernel options output array or object that describes the output of kernel as array width width height or width height depth as object x width y height z depth outputtotexture boolean graphical boolean loopmaxiterations number constants object wraparound boolean hardcodeconstants boolean floattextures boolean floatoutput boolean functions array or boolean nativefunctions object subkernels array outputimmutable boolean default to false creating and running functions depending on your output type specify the intended size of your output you cannot have an accelerated function that does not specify any output size output size how to specify output size how to reference in kernel 1d length myvar this thread x 2d width height myvar this thread y this thread x 3d width height depth myvar this thread z this thread y this thread x js const opt output 100 or js you can also use x y and z const opt output x 100 create the function you want to run on the gpu the first input parameter to createkernel is a kernel function which will compute a single number in the output the thread identifiers this thread x this thread y or this thread z will allow you to specify the appropriate behavior of the kernel function at specific positions of the output js const myfunc gpu createkernel function return this thread x opt the created function is a regular javascript function and you can use it like one js myfunc result 0 1 2 3 99 note instead of creating an object you can use the chainable shortcut methods as a neater way of specifying options js const myfunc gpu createkernel function return this thread x setoutput 100 myfunc result 0 1 2 3 99 accepting input supported input types numbers 1d array 2d array 3d array html image array of html images to define an argument simply add it to the kernel function like regular javascript input examples js const myfunc gpu createkernel function x return x setoutput 100 myfunc 42 result 42 42 42 42 42 similarly with array inputs js const myfunc gpu createkernel function x return x this thread x 3 setoutput 100 myfunc 1 2 3 result 1 2 3 1 1 an html image js const myfunc gpu createkernel function image const pixel image this thread y this thread x this color pixel 0 pixel 1 pixel 2 pixel 3 setgraphical true setoutput 100 const image new document createelement img image src my image source png image onload myfunc image result colorful image an array of html images js const myfunc gpu createkernel function image const pixel image this thread z this thread y this thread x this color pixel 0 pixel 1 pixel 2 pixel 3 setgraphical true setoutput 100 const image1 new document createelement img image1 src my image source1 png image1 onload onload const image2 new document createelement img image2 src my image source2 png image2 onload onload const image3 new document createelement img image3 src my image source3 png image3 onload onload const totalimages 3 let loadedimages 0 function onload loadedimages if loadedimages totalimages myfunc image1 image2 image3 result colorful image composed of many images graphical output sometimes you want to produce a canvas image instead of doing numeric computations to achieve this set the graphical flag to true and the output dimensions to width height the thread identifiers will now refer to the x and y coordinate of the pixel you are producing inside your kernel function use this color r g b or this color r g b a to specify the color of the pixel for performance reasons the return value of your function will no longer be anything useful instead to display the image retrieve the canvas dom node and insert it into your page js const render gpu createkernel function this color 0 0 0 1 setoutput 20 20 setgraphical true render const canvas render getcanvas document getelementsbytagname body 0 appendchild canvas note to animate the rendering use requestanimationframe instead of settimeout for optimal performance for more information see this alpha currently if you need alpha do something like enabling premultipliedalpha with your own gl context js const canvas dom canvas 500 500 const gl canvas getcontext webgl2 premultipliedalpha false const gpu new gpu canvas webgl gl const krender gpu createkernel function x this color this thread x 500 this thread y 500 x 0 x 1 setoutput 500 500 setgraphical true combining kernels sometimes you want to do multiple math operations on the gpu without the round trip penalty of data transfer from cpu to gpu to cpu to gpu etc to aid this there is the combinekernels method note kernels can have different output sizes js const add gpu createkernel function a b return a b setoutput 20 const multiply gpu createkernel function a b return a b setoutput 20 const superkernel gpu combinekernels add multiply function a b c return multiply add a this thread x b this thread x c this thread x superkernel a b c this gives you the flexibility of using multiple transformations but without the performance penalty resulting in a much much much faster operation create kernel map sometimes you want to do multiple math operations in one kernel and save the output of each of those operations an example is machine learning where the previous output is required for back propagation to aid this there is the createkernelmap method object outputs js const megakernel gpu createkernelmap addresult function add a b return a b multiplyresult function multiply a b return a b function a b c return multiply add a this thread x b this thread x c this thread x megakernel a b c result addresult multiplyresult result array outputs js const megakernel gpu createkernelmap function add a b return a b function multiply a b return a b function a b c return multiply add a this thread x b this thread x c this thread x megakernel a b c result result this gives you the flexibility of using parts of a single transformation without the performance penalty resulting in much much much faster operation adding custom functions do you have a custom function youd like to use on the gpu although limited you can js gpu addfunction function mysuperfunction a b return a b function anotherfunction value return value 1 gpu addfunction anotherfunction const kernel gpu createkernel function a b return anotherfunction mysuperfunction a this thread x b this thread x setoutput 20 adding custom functions directly to kernel js function mysuperfunction a b return a b const kernel gpu createkernel function a b return mysuperfunction a this thread x b this thread x setoutput 20 setfunctions mysuperfunction loops loops just work dynamic sized via constants js const matmult gpu createkernel function a b var sum 0 for var i 0 i this constants size i sum a this thread y i b i this thread x return sum constants size 512 output 512 512 fixed sized js const matmult gpu createkernel function a b var sum 0 for var i 0 i 512 i sum a this thread y i b i this thread x return sum setoutput 512 512 pipelining pipeline is a feature where values are sent directly from kernel to kernel via a texture this results in extremely fast computing this is achieved with the kernel option outputtotexture boolean option or by calling kernel setoutputtotexture true flattened typed array support to use the useful x y z thread lookup api inside of gpu js and yet use flattened arrays there is the input type this is generally much faster for when sending values to the gpu especially with larger data sets usage example js import gpu input from gpu js const gpu new gpu const kernel gpu createkernel function a b return a this thread y this thread x b this thread y this thread x setoutput 3 3 kernel input new float32array 1 2 3 4 5 6 7 8 9 3 3 input new float32array 1 2 3 4 5 6 7 8 9 3 3 note gpu input value size is a simple pointer for new gpu input value size supported math functions since the code running in the kernel is actually compiled to glsl code not all functions from the javascript math module are supported this is a list of the supported ones abs acos asin atan atan2 ceil cos exp floor log log2 max min round sign sin sqrt tan full api reference you can find a complete api reference here automatically built documentation documentation of the codebase is automatically built contributors fazli sapuan eugene cheah matthew saw robert plummer abhishek soni juan cazala daniel x moore mark theng varun patro contributing contributors are welcome create a merge request to the develop branch and we will gladly review it if you wish to get write access to the repository please email us and we will review your application and grant you access to the develop branch we promise never to pass off your code as ours terms explained kernel a function that is tightly coupled to program that runs on the graphic processor texture a graphical artifact that is packed with data in the case of gpu js bit shifted parts of a 32 bit floating point decimal license the mit license copyright c 2017 gpu js team permission is hereby granted free of charge to any person obtaining a copy of this software and associated documentation files the software to deal in the software without restriction including without limitation the rights to use copy modify merge publish distribute sublicense and or sell copies of the software and to permit persons to whom the software is furnished to do so subject to the following conditions the above copyright notice and this permission notice shall be included in all copies or substantial portions of the software the software is provided as is without warranty of any kind express or implied including but not limited to the warranties of merchantability fitness for a particular purpose and noninfringement in no event shall the authors or copyright holders be liable for any claim damages or other liability whether in an action of contract tort or otherwise arising from out of or in connection with the software or the use or other dealings in the software