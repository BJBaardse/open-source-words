restkit restkit is a modern objective c framework for implementing restful web services clients on ios and mac os x it provides a powerful object mapping engine that seamlessly integrates with core data and a simple set of networking primitives for mapping http requests and responses built on top of afnetworking it has an elegant carefully designed set of apis that make accessing and modeling restful resources feel almost magical for example heres how to access the twitter public timeline and turn the json contents into an array of tweet objects objective c interface rktweet nsobject property nonatomic copy nsnumber userid property nonatomic copy nsstring username property nonatomic copy nsstring text end rkobjectmapping mapping rkobjectmapping mappingforclass rktweet class mapping addattributemappingsfromdictionary user name username user id userid text text rkresponsedescriptor responsedescriptor rkresponsedescriptor responsedescriptorwithmapping mapping method rkrequestmethodany pathpattern nil keypath nil statuscodes nil nsurl url nsurl urlwithstring http api twitter com 1 statuses public timeline json nsurlrequest request nsurlrequest requestwithurl url rkobjectrequestoperation operation rkobjectrequestoperation alloc initwithrequest request responsedescriptors responsedescriptor operation setcompletionblockwithsuccess rkobjectrequestoperation operation rkmappingresult result nslog the public timeline tweets result array failure nil operation start getting started download restkit and play with the examples for iphone and mac os x first time with restkit read the overview section below and then check out the getting acquainted with restkit tutorial and object mapping reference documents in the wiki to jump right in upgrading from restkit 0 9 x or 0 10 x read the upgrading to restkit 0 20 x guide in the wiki adding restkit to an existing afnetworking application read the afnetworking integration document to learn details about how the frameworks fit together review the source code api documentation for a detailed look at the classes and apis in restkit a great place to start is rkobjectmanager still need some help ask questions on stack overflow or the mailing list ping us on twitter or chat with us on irc overview restkit is designed to be modular and each module strives to maintain a minimal set of dependencies across the framework and with the host platform at the core of library sits the object mapping engine which is responsible for transforming objects between representations such as json xml local domain objects object mapping fundamentals the object mapping engine is built on top of the key value coding kvc informal protocol that is foundational to numerous cocoa technologies such as key value observing bindings and core data object mappings are expressed as pairs of kvc key paths that specify the source and destination attributes or relationships that are to be transformed restkit leverages the highly dynamic objective c runtime to infer the developers desired intent by examining the type of the source and destination properties and performing appropriate type transformations for example given a source key path of created at that identifies a string within a parsed json document and a destination key path of creationdate that identifies an nsdate property on a target object restkit will transform the date from a string into an nsdate using an nsdateformatter numerous other transformations are provided out of the box and the engine is pluggable to allow the developer to define new transformations or replace an existing transformation with a new implementation the mapper fully supports both simple attribute as well as relationship mappings in which nested to one or to many child objects are mapped recursively through relationship mappings one object mapping can be added to another to compose aggregate mappings that are capable of processing arbitrarily complex source documents object mapping is a deep topic and is explored in exhaustive detail in the object mapping guide on the wiki api quickstart restkit is broken into several modules that cleanly separate the mapping engine from the http and core data integrations to provide maximum flexibility key classes in each module are highlighted below and each module is hyperlinked to the readme md contained within the source code object mapping rkobjectmapping encapsulates configuration for transforming object representations as expressed by key value coding keypaths rkattributemapping specifies a desired transformation between attributes within an object or entity mapping in terms of a source and destination key path rkrelationshipmapping specifies a desired mapping of a nested to one or to many child objects in in terms of a source and destination key path and an rkobjectmapping with which to map the attributes of the child object rkdynamicmapping specifies a flexible mapping in which the decision about which rkobjectmapping is to be used to process a given document is deferred to run time rkmapperoperation provides an interface for mapping a deserialized document into a set of local domain objects rkmappingoperation an nsoperation that performs a mapping between object representations using an rkobjectmapping networking rkrequestdescriptor describes a request that can be sent from the application to a remote web application for a given object type rkresponsedescriptor describes an object mappable response that may be returned from a remote web application in terms of an object mapping a key path a sockit pattern for matching the url and a set of status codes that define the circumstances in which the mapping is appropriate for a given response rkobjectparameterization performs mapping of a given object into an nsdictionary representation suitable for use as the parameters of an http request rkobjectrequestoperation an nsoperation that sends an http request and performs object mapping on the parsed response body using the configurations expressed in a set of rkresponsedescriptor objects rkresponsemapperoperation an nsoperation that provides support for object mapping an nshttpurlresponse using a set of rkresponsedescriptor objects rkobjectmanager captures the common patterns for communicating with a restful web application over http using object mapping including centralizing rkrequestdescriptor and rkresponsedescriptor configurations describing url configuration with an rkrouter serializing objects and sending requests with the serialized representations sending requests to load remote resources and object mapping the response bodies building multi part form requests for objects rkrouter generates nsurl objects from a base url and a set of rkroute objects describing relative paths used by the application rkroute describes a single relative path for a given object type and http method the relationship of an object or a symbolic name core data rkmanagedobjectstore encapsulates core data configuration including an nsmanagedobjectmodel a nspersistentstorecoordinator and a pair of nsmanagedobjectcontext objects rkentitymapping models a mapping for transforming an object representation into a nsmanagedobject instance for a given nsentitydescription rkconnectiondescription describes a mapping for establishing a relationship between core data entities using foreign key attributes rkmanagedobjectrequestoperation an nsoperation subclass that sends an http request and performs object mapping on the parsed response body to create nsmanagedobject instances establishes relationships between objects using rkconnectiondescription objects and cleans up orphaned objects that no longer exist in the remote backend system rkmanagedobjectimporter provides support for bulk mapping of managed objects using rkentitymapping objects for two use cases bulk importing of parsed documents into an nspersistentstore generating a seed database for initializing an applications core data store with an initial data set upon installation search rksearchindexer provides support for generating a full text searchable index within core data for string attributes of entities within an application rksearchpredicate generates an nscompoundpredicate given a string of text that will search an index built with an rksearchindexer across any indexed entity testing rkmappingtest provides support for unit testing object mapping configurations given a parsed document and an object or entity mapping expectations are configured in terms of expected key path mappings and or expected transformation results rktestfixture provides an interface for easily generating test fixture data for unit testing rktestfactory provides support for creating objects for use in testing examples object request objective c get a single article from articles 1234 json and map it into an object json looks like article title my article author blake body very cool rkobjectmapping mapping rkobjectmapping mappingforclass article class mapping addattributemappingsfromarray title author body nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclasssuccessful anything in 2xx rkresponsedescriptor responsedescriptor rkresponsedescriptor responsedescriptorwithmapping mapping method rkrequestmethodany pathpattern articles articleid keypath article statuscodes statuscodes nsurlrequest request nsurlrequest requestwithurl nsurl urlwithstring http restkit org articles 1234 json rkobjectrequestoperation operation rkobjectrequestoperation alloc initwithrequest request responsedescriptors responsedescriptor operation setcompletionblockwithsuccess rkobjectrequestoperation operation rkmappingresult result article article result firstobject nslog mapped the article article failure rkobjectrequestoperation operation nserror error nslog failed with error error localizeddescription operation start managed object request objective c get an article and its categories from articles 888 json and map into core data entities json looks like article title my article author blake body very cool categories id 1 name core data nsmanagedobjectmodel managedobjectmodel nsmanagedobjectmodel mergedmodelfrombundles nil rkmanagedobjectstore managedobjectstore rkmanagedobjectstore alloc initwithmanagedobjectmodel managedobjectmodel nserror error nil bool success rkensuredirectoryexistsatpath rkapplicationdatadirectory error if success rklogerror failed to create application data directory at path rkapplicationdatadirectory error nsstring path rkapplicationdatadirectory stringbyappendingpathcomponent store sqlite nspersistentstore persistentstore managedobjectstore addsqlitepersistentstoreatpath path fromseeddatabaseatpath nil withconfiguration nil options nil error error if persistentstore rklogerror failed adding persistent store at path path error managedobjectstore createmanagedobjectcontexts rkentitymapping categorymapping rkentitymapping mappingforentityforname category inmanagedobjectstore managedobjectstore categorymapping addattributemappingsfromdictionary id categoryid name name rkentitymapping articlemapping rkentitymapping mappingforentityforname article inmanagedobjectstore managedobjectstore articlemapping addattributemappingsfromarray title author body articlemapping addpropertymapping rkrelationshipmapping relationshipmappingfromkeypath categories tokeypath categories withmapping categorymapping nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclasssuccessful anything in 2xx rkresponsedescriptor responsedescriptor rkresponsedescriptor responsedescriptorwithmapping articlemapping method rkrequestmethodany pathpattern articles articleid keypath article statuscodes statuscodes nsurlrequest request nsurlrequest requestwithurl nsurl urlwithstring http restkit org articles 888 json rkmanagedobjectrequestoperation operation rkmanagedobjectrequestoperation alloc initwithrequest request responsedescriptors responsedescriptor operation managedobjectcontext managedobjectstore mainqueuemanagedobjectcontext operation managedobjectcache managedobjectstore managedobjectcache operation setcompletionblockwithsuccess rkobjectrequestoperation operation rkmappingresult result article article result firstobject nslog mapped the article article nslog mapped the category article categories anyobject failure rkobjectrequestoperation operation nserror error nslog failed with error error localizeddescription nsoperationqueue operationqueue nsoperationqueue new operationqueue addoperation operation map a client error response to an nserror objective c get articles error json returns a 422 unprocessable entity json looks like errors some error has occurred you can map errors to any class but rkerrormessage is included for free rkobjectmapping errormapping rkobjectmapping mappingforclass rkerrormessage class the entire value at the source key path containing the errors maps to the message errormapping addpropertymapping rkattributemapping attributemappingfromkeypath nil tokeypath errormessage nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclassclienterror any response in the 4xx status code range with an errors key path uses this mapping rkresponsedescriptor errordescriptor rkresponsedescriptor responsedescriptorwithmapping errormapping method rkrequestmethodany pathpattern nil keypath errors statuscodes statuscodes nsurlrequest request nsurlrequest requestwithurl nsurl urlwithstring http restkit org articles error json rkobjectrequestoperation operation rkobjectrequestoperation alloc initwithrequest request responsedescriptors errordescriptor operation setcompletionblockwithsuccess nil failure rkobjectrequestoperation operation nserror error the description method of the class the error is mapped to is used to construct the value of the localizeddescription nslog loaded this error error localizeddescription you can access the model object used to construct the nserror via the userinfo rkerrormessage errormessage error userinfo objectforkey rkobjectmappererrorobjectskey firstobject centralize configuration in an object manager objective c set up article and error response descriptors successful json looks like article title my article author blake body very cool rkobjectmapping mapping rkobjectmapping mappingforclass article class mapping addattributemappingsfromarray title author body nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclasssuccessful anything in 2xx rkresponsedescriptor articledescriptor rkresponsedescriptor responsedescriptorwithmapping mapping method rkrequestmethodany pathpattern articles keypath article statuscodes statuscodes error json looks like errors some error has occurred rkobjectmapping errormapping rkobjectmapping mappingforclass rkerrormessage class the entire value at the source key path containing the errors maps to the message errormapping addpropertymapping rkattributemapping attributemappingfromkeypath nil tokeypath errormessage nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclassclienterror any response in the 4xx status code range with an errors key path uses this mapping rkresponsedescriptor errordescriptor rkresponsedescriptor responsedescriptorwithmapping errormapping method rkrequestmethodany pathpattern nil keypath errors statuscodes statuscodes add our descriptors to the manager rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org manager addresponsedescriptorsfromarray articledescriptor errordescriptor manager getobjectsatpath articles 555 json parameters nil success rkobjectrequestoperation operation rkmappingresult mappingresult handled with articledescriptor failure rkobjectrequestoperation operation nserror error transport error or server error handled by errordescriptor configure core data integration with the object manager objective c nsmanagedobjectmodel managedobjectmodel nsmanagedobjectmodel mergedmodelfrombundles nil rkmanagedobjectstore managedobjectstore rkmanagedobjectstore alloc initwithmanagedobjectmodel managedobjectmodel bool success rkensuredirectoryexistsatpath rkapplicationdatadirectory error if success rklogerror failed to create application data directory at path rkapplicationdatadirectory error nsstring path rkapplicationdatadirectory stringbyappendingpathcomponent store sqlite nspersistentstore persistentstore managedobjectstore addsqlitepersistentstoreatpath path fromseeddatabaseatpath nil withconfiguration nil options nil error error if persistentstore rklogerror failed adding persistent store at path path error managedobjectstore createmanagedobjectcontexts rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org manager managedobjectstore managedobjectstore load a collection of objects at a path objective c rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org manager getobjectsatpath articles parameters nil success rkobjectrequestoperation operation rkmappingresult mappingresult failure rkobjectrequestoperation operation nserror error manage a queue of object request operations objective c rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org nsurlrequest request nsurlrequest requestwithurl nsurl urlwithstring http restkit org articles 1234 json rkobjectrequestoperation operation rkobjectrequestoperation alloc initwithrequest request responsedescriptors responsedescriptor manager enqueueobjectrequestoperation operation manager cancelallobjectrequestoperationswithmethod rkrequestmethodany matchingpathpattern articles articleid\ json post patch and delete an object objective c rkobjectmapping responsemapping rkobjectmapping mappingforclass article class responsemapping addattributemappingsfromarray title author body nsindexset statuscodes rkstatuscodeindexsetforclass rkstatuscodeclasssuccessful anything in 2xx rkresponsedescriptor articledescriptor rkresponsedescriptor responsedescriptorwithmapping responsemapping method rkrequestmethodany pathpattern articles keypath article statuscodes statuscodes rkobjectmapping requestmapping rkobjectmapping requestmapping objectclass nsmutabledictionary requestmapping addattributemappingsfromarray title author body for any object of class article serialize into an nsmutabledictionary using the given mapping and nest under the article key path rkrequestdescriptor requestdescriptor rkrequestdescriptor requestdescriptorwithmapping requestmapping objectclass article class rootkeypath article method rkrequestmethodany rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org manager addrequestdescriptor requestdescriptor manager addresponsedescriptor articledescriptor article article article new article title introduction to restkit article body this is some text article author blake post to create manager postobject article path articles parameters nil success nil failure nil patch to update article body new body manager patchobject article path articles 1234 parameters nil success nil failure nil delete to destroy manager deleteobject article path articles 1234 parameters nil success nil failure nil configure logging objective c log all http traffic with request and response bodies rklogconfigurebyname restkit network rklogleveltrace log debugging info about core data rklogconfigurebyname restkit coredata rklogleveldebug raise logging for a block rklogwithlevelwhileexecutingblock rklogleveltrace do something that generates logs configure routing objective c rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org class routing manager router routeset addroute rkroute routewithclass ggsegment class pathpattern segments segmentid\ json method rkrequestmethodget relationship routing manager router routeset addroute rkroute routewithrelationshipname amenities objectclass ggairport class pathpattern airports airportid amenities json method rkrequestmethodget named routes manager router routeset addroute rkroute routewithname thumbs down review resourcepathpattern reviews reviewid thumbs down method rkrequestmethodpost post an object with a file attachment objective c article article article new uiimage image uiimage imagenamed some image png serialize the article attributes then attach a file nsmutableurlrequest request rkobjectmanager sharedmanager multipartformrequestwithobject article method rkrequestmethodpost path nil parameters nil constructingbodywithblock id formdata formdata appendpartwithfiledata uiimagepngrepresentation image name article image filename photo png mimetype image png rkobjectrequestoperation operation rkobjectmanager sharedmanager objectrequestoperationwithrequest request success nil failure nil rkobjectmanager sharedmanager enqueueobjectrequestoperation operation note must be enqueued rather than started enqueue a batch of object request operations objective c rkobjectmanager manager rkobjectmanager managerwithbaseurl nsurl urlwithstring http restkit org airport jfk airport new jfk code jfk airport lga airport new lga code lga airport rdu airport new rdu code rdu enqueue a get for airports jfk weather airports lga weather airports rdu weather rkroute route rkroute routewithname airport weather resourcepathpattern airports code weather method rkrequestmethodget manager enqueuebatchofobjectrequestoperationswithroute route objects jfk lga rdu progress nsuinteger numberoffinishedoperations nsuinteger totalnumberofoperations nslog finished d operations numberoffinishedoperations completion nsarray operations nslog all weather reports loaded generate a seed database objective c nsmanagedobjectmodel managedobjectmodel nsmanagedobjectmodel mergedmodelfrombundles nil rkmanagedobjectstore managedobjectstore rkmanagedobjectstore alloc initwithmanagedobjectmodel managedobjectmodel nserror error nil bool success rkensuredirectoryexistsatpath rkapplicationdatadirectory error if success rklogerror failed to create application data directory at path rkapplicationdatadirectory error nsstring path rkapplicationdatadirectory stringbyappendingpathcomponent store sqlite nspersistentstore persistentstore managedobjectstore addsqlitepersistentstoreatpath path fromseeddatabaseatpath nil withconfiguration nil options nil error error if persistentstore rklogerror failed adding persistent store at path path error managedobjectstore createmanagedobjectcontexts rkentitymapping articlemapping rkentitymapping mappingforentityforname article inmanagedobjectstore managedobjectstore articlemapping addattributemappingsfromarray title author body nsstring seedpath rkapplicationdatadirectory stringbyappendingpathcomponent myseeddatabase sqlite rkmanagedobjectimporter importer rkmanagedobjectimporter alloc initwithmanagedobjectmodel managedobjectstore managedobjectmodel storepath seedpath import the files articles json from the main bundle using our rkentitymapping json looks like articles title article 1 body text author blake nserror error nsbundle mainbundle nsbundle mainbundle importer importobjectsfromitematpath mainbundle pathforresource articles oftype json withmapping articlemapping keypath articles error error bool success importer finishimporting error if success importer logseedinginfo index and search an entity objective c nsmanagedobjectmodel managedobjectmodel nsmanagedobjectmodel mergedmodelfrombundles nil rkmanagedobjectstore managedobjectstore rkmanagedobjectstore alloc initwithmanagedobjectmodel managedobjectmodel nserror error nil bool success rkensuredirectoryexistsatpath rkapplicationdatadirectory error if success rklogerror failed to create application data directory at path rkapplicationdatadirectory error nsstring path rkapplicationdatadirectory stringbyappendingpathcomponent store sqlite nspersistentstore persistentstore managedobjectstore addsqlitepersistentstoreatpath path fromseeddatabaseatpath nil withconfiguration nil options nil error error if persistentstore rklogerror failed adding persistent store at path path error managedobjectstore createmanagedobjectcontexts managedobjectstore addsearchindexingtoentityforname article onattributes title body managedobjectstore addinmemorypersistentstore nil managedobjectstore createmanagedobjectcontexts managedobjectstore startindexingpersistentstoremanagedobjectcontext article article1 nsentitydescription insertnewobjectforentityforname article inmanagedobjectcontext managedobjectstore mainqueuemanagedobjectcontext article1 title first article article1 body this should match search article article2 nsentitydescription insertnewobjectforentityforname article inmanagedobjectcontext managedobjectstore mainqueuemanagedobjectcontext article2 title second article article2 body does not bool success managedobjectstore mainqueuemanagedobjectcontext savetopersistentstore nil rksearchpredicate predicate rksearchpredicate searchpredicatewithtext match type nsandpredicatetype nsfetchrequest fetchrequest nsfetchrequest fetchrequestwithentityname article fetchrequest predicate predicate contains article1 due to body text containing match nsarray matches managedobjectstore mainqueuemanagedobjectcontext executefetchrequest fetchrequest error nil nslog found the matching articles matches unit test a mapping objective c json looks like article title my article author blake body very cool rkobjectmapping mapping rkobjectmapping mappingforclass article class mapping addattributemappingsfromarray title author body nsdictionary article article title my title body the article body author blake rkmappingtest mappingtest rkmappingtest alloc initwithmapping mapping sourceobject article destinationobject nil mappingtest expectmappingfromkeypath title tokeypath title value my title mappingtest performmapping mappingtest verify requirements restkit requires ios 8 0 and above or mac os x 10 9 and above several third party open source libraries are used within restkit including afnetworking networking support libcomponentlogging logging support sockit string object coding iso8601parser support for parsing and generating iso 8601 dates the following cocoa frameworks must be linked into the application target for proper compilation cfnetwork framework on ios coredata framework security framework mobilecoreservices framework on ios or coreservices framework on os x and the following linker flags must be set objc all load arc as of version 0 20 0 restkit has migrated the entire codebase to arc if you are including the restkit sources directly into a project that does not yet use automatic reference counting you will need to set the fobjc arc compiler flag on all of the restkit source files to do this in xcode go to your active target and select the build phases tab now select all restkit source files press enter insert fobjc arc and then done to enable arc for restkit serialization formats restkit provides a pluggable interface for handling arbitrary serialization formats via the rkserialization protocol and the rkmimetypeserialization class out of the box restkit supports handling the json format for serializing and deserializing object representations via the nsjsonserialization class additional serializations support for additional formats and alternate serialization backends is provided via external modules that can be added to the project currently the following serialization implementations are available for use jsonkit sbjson yajl nextivejson xmlreader xmlwriter installation the recommended approach for installing restkit is via the cocoapods package manager as it provides flexible dependency management and dead simple installation for best results it is recommended that you install via cocoapods 0 19 1 using git 1 8 0 installed via homebrew via cocoapods install cocoapods if not already available bash sudo gem install cocoapods pod setup change to the directory of your xcode project and create and edit your podfile and add restkit bash cd path to myproject touch podfile edit podfile target your project do platform ios 7 0 or platform osx 10 7 pod restkit 0 24 0 end testing and search are optional components pod restkit testing 0 24 0 pod restkit search 0 24 0 install into your project bash pod install open your project in xcode from the xcworkspace file not the usual project file bash open myproject xcworkspace please note that if your installation fails it may be because you are installing with a version of git lower than cocoapods is expecting please ensure that you are running git 1 8 0 by executing git version you can get a full picture of the installation details by executing pod install verbose from a release package or as a git submodule detailed installation instructions are available in the visual install guide on the wiki using restkit in a swift project install restkit using one of the above methods then add import restkit if restkit is built as a dynamic framework or import restkit restkit h if restkit is built as a static library into the bridging header for your swift project to enable the core data functionality in restkit add import coredata into your bridging header before you import restkit license restkit is licensed under the terms of the apache license version 2 0 please see the license file for full details credits restkit is brought to you by blake watters and the restkit team support is provided by the following organizations gateguru two toasters