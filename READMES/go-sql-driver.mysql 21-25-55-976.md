go mysql driver a mysql driver for gos database sql package features requirements installation usage dsn data source name password protocol address parameters examples connection pool and timeouts context context support columntype support load data local infile support time time support unicode support testing development license features lightweight and fast native go implementation no c bindings just pure go connections over tcp ipv4 tcp ipv6 unix domain sockets or custom protocols automatic handling of broken connections automatic connection pooling by database sql package supports queries larger than 16mb full sql rawbytes support intelligent long data handling in prepared statements secure load data local infile support with file whitelisting and io reader support optional time time parsing optional placeholder interpolation requirements go 1 7 or higher we aim to support the 3 latest versions of go mysql 4 1 mariadb percona server google cloudsql or sphinx 2 2 3 installation simple install the package to your gopath with the go tool from shell bash go get u github com go sql driver mysql make sure git is installed on your machine and in your systems path usage go mysql driver is an implementation of gos database sql driver interface you only need to import the driver and can use the full database sql api then use mysql as drivername and a valid dsn as datasourcename go import database sql import github com go sql driver mysql db err sql open mysql user password dbname examples are available in our wiki dsn data source name the data source name has a common format like e g pear db uses it but without type prefix optional parts marked by squared brackets username password protocol address dbname param1 value1 paramn valuen a dsn in its fullest form username password protocol address dbname param value except for the databasename all values are optional so the minimal dsn is dbname if you do not want to preselect a database leave dbname empty this has the same effect as an empty dsn string alternatively config formatdsn can be used to create a dsn string by filling a struct password passwords can consist of any character escaping is not necessary protocol see net dial for more information which networks are available in general you should use an unix domain socket if available and tcp otherwise for best performance address for tcp and udp networks addresses have the form host port if port is omitted the default port will be used if host is a literal ipv6 address it must be enclosed in square brackets the functions net joinhostport and net splithostport manipulate addresses in this form for unix domain sockets the address is the absolute path to the mysql server socket e g var run mysqld mysqld sock or tmp mysql sock parameters parameters are case sensitive notice that any of true true true or 1 is accepted to stand for a true boolean value not surprisingly false can be specified as any of false false false or 0 allowallfiles type bool valid values true false default false allowallfiles true disables the file whitelist for load data local infile and allows all files might be insecure allowcleartextpasswords type bool valid values true false default false allowcleartextpasswords true allows using the cleartext client side plugin if required by an account such as one defined with the pam authentication plugin sending passwords in clear text may be a security problem in some configurations to avoid problems if there is any possibility that the password would be intercepted clients should connect to mysql server using a method that protects the password possibilities include tls ssl ipsec or a private network allownativepasswords type bool valid values true false default true allownativepasswords false disallows the usage of mysql native password method allowoldpasswords type bool valid values true false default false allowoldpasswords true allows the usage of the insecure old password method this should be avoided but is necessary in some cases see also the old passwords wiki page charset type string valid values name default none sets the charset used for client server interaction set names value if multiple charsets are set separated by a comma the following charset is used if setting the charset failes this enables for example support for utf8mb4 introduced in mysql 5 5 3 with fallback to utf8 for older servers charset utf8mb4 utf8 usage of the charset parameter is discouraged because it issues additional queries to the server unless you need the fallback behavior please use collation instead collation type string valid values name default utf8 general ci sets the collation used for client server interaction on connection in contrast to charset collation does not issue additional queries if the specified collation is unavailable on the target server the connection will fail a list of valid charsets for a server is retrievable with show collation clientfoundrows type bool valid values true false default false clientfoundrows true causes an update to return the number of matching rows instead of the number of rows changed columnswithalias type bool valid values true false default false when columnswithalias is true calls to sql rows columns will return the table alias and the column name separated by a dot for example select u id from users as u will return u id instead of just id if columnswithalias true interpolateparams type bool valid values true false default false if interpolateparams is true placeholders in calls to db query and db exec are interpolated into a single query string with given parameters this reduces the number of roundtrips since the driver has to prepare a statement execute it with given parameters and close the statement again with interpolateparams false this can not be used together with the multibyte encodings big5 cp932 gb2312 gbk or sjis these are blacklisted as they may introduce a sql injection vulnerability loc type string valid values escaped name default utc sets the location for time time values when using parsetime true local sets the systems location see time loadlocation for details note that this sets the location for time time values but does not change mysqls time zone setting for that see the time zone system variable which can also be set as a dsn parameter please keep in mind that param values must be url queryescapeed alternatively you can manually replace the with 2f for example us pacific would be loc us 2fpacific maxallowedpacket type decimal number default 4194304 max packet size allowed in bytes the default value is 4 mib and should be adjusted to match the server settings maxallowedpacket 0 can be used to automatically fetch the max allowed packet variable from server on every connection multistatements type bool valid values true false default false allow multiple statements in one query while this allows batch queries it also greatly increases the risk of sql injections only the result of the first query is returned all other results are silently discarded when multistatements is used parameters must only be used in the first statement parsetime type bool valid values true false default false parsetime true changes the output type of date and datetime values to time time instead of byte string the date or datetime like 0000 00 00 00 00 00 is converted into zero value of time time readtimeout type duration default 0 i o read timeout the value must be a decimal number with a unit suffix ms s m h such as 30s 0 5m or 1m30s rejectreadonly type bool valid values true false default false rejectreadonly true causes the driver to reject read only connections this is for a possible race condition during an automatic failover where the mysql client gets connected to a read only replica after the failover note that this should be a fairly rare case as an automatic failover normally happens when the primary is down and the race condition shouldnt happen unless it comes back up online as soon as the failover is kicked off on the other hand when this happens a mysql application can get stuck on a read only connection until restarted it is however fairly easy to reproduce for example using a manual failover on aws auroras mysql compatible cluster if you are not relying on read only transactions to reject writes that arent supposed to happen setting this on some mysql providers such as aws aurora is safer for failovers note that error 1290 can be returned for a read only server and this option will cause a retry for that error however the same error number is used for some other cases you should ensure your application will never cause an error 1290 except for read only mode when enabling this option serverpubkey type string valid values name default none server public keys can be registered with mysql registerserverpubkey which can then be used by the assigned name in the dsn public keys are used to transmit encrypted data e g for authentication if the servers public key is known it should be set manually to avoid expensive and potentially insecure transmissions of the public key from the server to the client each time it is required timeout type duration default os default timeout for establishing connections aka dial timeout the value must be a decimal number with a unit suffix ms s m h such as 30s 0 5m or 1m30s tls type bool string valid values true false skip verify name default false tls true enables tls ssl encrypted connection to the server use skip verify if you want to use a self signed or invalid certificate server side use a custom value registered with mysql registertlsconfig writetimeout type duration default 0 i o write timeout the value must be a decimal number with a unit suffix ms s m h such as 30s 0 5m or 1m30s system variables any other parameters are interpreted as system variables boolean var value set boolean var value enum var value set enum var value string var 27 value 27 set string var value rules the values for string variables must be quoted with the values must also be url queryescape http golang org pkg net url queryescape ed which implies values of string variables must be wrapped with 27 examples autocommit 1 set autocommit 1 time zone 27europe 2fparis 27 set time zone europe paris tx isolation 27repeatable read 27 set tx isolation repeatable read examples user unix path to socket dbname root pw unix tmp mysql sock mydatabase loc local user password tcp localhost 5555 dbname tls skip verify autocommit true treat warnings as errors by setting the system variable sql mode user password dbname sql mode traditional tcp via ipv6 user password tcp de ad be ef ca fe 80 dbname timeout 90s collation utf8mb4 unicode ci tcp on a remote host e g amazon rds id password tcp your amazonaws uri com 3306 dbname google cloud sql on app engine first generation mysql server user cloudsql project id instance name dbname google cloud sql on app engine second generation mysql server user cloudsql project id regionname instance name dbname tcp using default port 3306 on localhost user password tcp dbname charset utf8mb4 utf8 sys var esc 40ped use the default protocol tcp and host localhost 3306 user password dbname no database preselected user password connection pool and timeouts the connection pool is managed by gos database sql package for details on how to configure the size of the pool and how long connections stay in the pool see db setmaxopenconns db setmaxidleconns and db setconnmaxlifetime in the database sql documentation the read write and dial timeouts for each individual connection are configured with the dsn parameters readtimeout writetimeout and timeout respectively columntype support this driver supports the columntype interface introduced in go 1 8 with the exception of columntype length which is currently not supported context context support go 1 8 added database sql support for context context this driver supports query timeouts and cancellation via contexts see context support in the database sql package for more details load data local infile support for this feature you need direct access to the package therefore you must change the import path no go import github com go sql driver mysql files must be whitelisted by registering them with mysql registerlocalfile filepath recommended or the whitelist check must be deactivated by using the dsn parameter allowallfiles true might be insecure to use a io reader a handler function must be registered with mysql registerreaderhandler name handler which returns a io reader or io readcloser the reader is available with the filepath reader name then choose different names for different handlers and deregisterreaderhandler when you dont need it anymore see the godoc of go mysql driver for details time time support the default internal output type of mysql date and datetime values is byte which allows you to scan the value into a byte string or sql rawbytes variable in your program however many want to scan mysql date and datetime values into time time variables which is the logical opposite in go to date and datetime in mysql you can do that by changing the internal output type from byte to time time with the dsn parameter parsetime true you can set the default time time location with the loc dsn parameter caution as of go 1 1 this makes time time the only variable type you can scan date and datetime values into this breaks for example sql rawbytes support alternatively you can use the nulltime type as the scan destination which works with both time time and string byte unicode support since version 1 1 go mysql driver automatically uses the collation utf8 general ci by default other collations charsets can be set using the collation dsn parameter version 1 0 of the driver recommended adding charset utf8 alias for set names utf8 to the dsn to enable proper utf 8 support this is not necessary anymore the collation parameter should be preferred to set another collation charset than the default see http dev mysql com doc refman 5 7 en charset unicode html for more details on mysqls unicode support testing development to run the driver tests you may need to adjust the configuration see the testing wiki page for details go mysql driver is not feature complete yet your help is very appreciated if you want to contribute you can work on an open issue or review a pull request see the contribution guidelines for details license go mysql driver is licensed under the mozilla public license version 2 0 mozilla summarizes the license scope as follows mpl the copyleft applies to any files containing mpled code that means you can use the unchanged source code both in private and commercially when distributing you must publish the source code of any changed files licensed under the mpl 2 0 under a the mpl 2 0 itself or b a compatible license e g gpl 3 0 or apache license 2 0 you neednt publish the source code of your library as long as the files licensed under the mpl 2 0 are unchanged please read the mpl 2 0 faq if you have further questions regarding the license you can read the full terms here license