xctool xctool is an extension for apples xcodebuild that makes it easier to test ios and mac products its especially helpful for continuous integration features • requirements • usage • continuous integration • reporters • configuration • contributing • known issues tips • license features xctool is drop in replacement for xcodebuild test that adds a few extra features faster parallelized test runs xctool can optionally run all of your test bundles in parallel speeding up your test runs significantly at facebook weve seen 2x and 3x speed ups by parallelizing our runs use the parallelize option with run tests or test to enable see parallelizing test runs for more info structured output of test results xctool captures all test results as structured json objects if youre building a continuous integration system this means you dont have to regex parse xcodebuild output anymore try one of the reporters to customize the output or get the full event stream with the reporter json stream option human friendly ansi colored output xcodebuild is incredibly verbose printing the full compile command and output for every source file by default xctool is only verbose if something goes wrong making it much easier to identify where the problems are example pretty output https fpotter public s3 amazonaws com xctool uicatalog gif written in objective c xctool is written in objective c mac os x and ios developers can easily submit new features and fix any bugs they may encounter without learning a new language we very much welcome pull requests note support for building projects with xctool is deprecated and will not be updated to support future versions of xcode we suggest moving to xcodebuild with xcpretty for simple needs or xcbuild for more involved requirements xctool will continue to support testing see above requirements xcode 7 or higher youll need xcodes command line tools installed from xcode install via xcode → preferences → downloads installation xctool can be installed from homebrew via bash brew install xctool or can be downloaded and run via the xctool sh command usage xctools commands and options are mostly a superset of xcodebuilds in most cases you can just swap xcodebuild with xctool and things will run as expected but with more attractive output you can always get help and a full list of options with bash path to xctool sh help testing xctool has a run tests action which knows how to run the tests in your scheme you can optionally limit what tests are run or change the sdk theyre run against to run all tests in your scheme you would use bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests to run just the tests in a specific target use the only option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests only sometesttarget you can go further and just run a specific test class bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests only sometesttarget sometestclass or even further and run just a single test method bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests only sometesttarget sometestclass testsomemethod you can also specify prefix matching for classes or test methods bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests only sometesttarget sometestclassprefix sometestclass testsomemethodprefix alternatively you can omit a specific item by prefix matching for classes or test methods bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests omit sometesttarget sometestclass testsomemethodprefix you can also run tests against a different sdk bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests test sdk iphonesimulator5 1 optionally you can specify testtimeout when running tests when an individual test hits this timeout it is considered a failure rather than waiting indefinitely this can prevent your test run from deadlocking forever due to misbehaving tests by default application tests will wait at most 30 seconds for the simulator to launch if you need to change this timeout use the launch timeout option building tests before running tests you need to build them you can use xcodebuild xcbuild or buck to do that for example bash xcodebuild \ workspace yourworkspace xcworkspace \ scheme yourscheme \ build for testing xcode 7 if you are using xcode 7 for building you can continue using xctool to build tests using build tests or just use test actions to run tests for example bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ build tests you can optionally just build a single test target with the only option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ build tests only sometesttarget parallelizing test runs xctool can optionally run unit tests in parallel making better use of otherwise idle cpu cores at facebook weve seen 2x and 3x gains by parallelizing our test runs to allow test bundles to run concurrently use the parallelize option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests parallelize the above gives you parallelism but youre bounded by your slowest test bundle for example if you had two test bundles a and b but b took 10 times as long to run because it contained 10 times as many tests then the above parallelism wont help much you can get further gains by breaking your test execution into buckets using the logictestbucketsize option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ run tests parallelize logictestbucketsize 20 the above will break your test execution into buckets of 20 test cases each and those bundles will be run concurrently if some of your test bundles are much larger than others this will help even things out and speed up the overall test run building xcode 7 only note support for building projects with xctool is deprecated and isnt supported in xcode 8 and later we suggest moving to xcodebuild with xcpretty for simple needs or xcbuild for more involved requirements alternatively you can use buck building products with xctool is the same as building them with xcodebuild if you use workspaces and schemes bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ build if you use projects and schemes bash path to xctool sh \ project yourproject xcodeproj \ scheme yourscheme \ build all of the common options like configuration sdk arch work just as they do with xcodebuild note xctool doesnt support directly building targets using target you must use schemes continuous integration xctool is an excellent choice for running your tests under a continuous integration server such as travis ci or jenkins in order to your run your tests within a continuous integration environment you must create shared schemes for your application target and ensure that all dependencies such as cocoapods are added explicitly to the scheme to do so open up the manage schemes sheet by selecting the product menu schemes manage schemes locate your application target in the list ensure that the shared checkbox in far right hand column of the sheet is checked if your application or test targets include cross project dependencies such as cocoapods then you will need to ensure that they have been configured as explicit dependencies to do so highlight your application target and hit the edit button to open the scheme editing sheet click the build tab in the left hand panel of the scheme editor click the button and add each dependency to the project cocoapods will appear as a static library named pods drag the dependency above your application target so that it is built first you will now have a new file in the xcshareddata xcschemes directory underneath your xcode project this is the shared scheme that you just configured check this file into your repository and xctool will be able to find and execute your tests on the next ci build example travis ci configuration travis ci is a very popular continuous integration system offered for free to open source projects it integrates well with github and it now uses xctool as the default build and test tool for objective c projects once you have set up your shared scheme for use with xctool you will need to configure a travis yml file if youre using workspaces your travis yml might be yaml language objective c xcode workspace path to yourapp xcworkspace xcode scheme yourapp if youre using projects your travis yml might be yaml language objective c xcode project path to yourapp xcodeproj xcode scheme yourapp for more flexibility you can also control how travis installs and invokes xctool yaml language objective c before install brew update brew install xctool script xctool workspace myapp xcworkspace scheme myapp test you can learn more about the travis ci environment for ios and os x application by referring to the about os x travis ci environment document and find in depth documentation for configuring your project by consulting the getting started page reporters xctool has reporters that output build and test results in different formats if you do not specify any reporters yourself xctool uses the pretty and user notifications reporters by default xctool also has these special rules overwrite is disabled on the pretty reporter when xctool does not detect a tty this can be overridden by setting xctool force tty in the environment the user notifications reporter will not be used if xctool detects that the build is being run by travis ci circleci teamcity or jenkins i e travis true circleci true teamcity version or jenkins url in the environment you can choose your own reporters with the reporter option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ reporter plain \ build by default reporters output to standard out but you can also direct the output to a file by adding output path after the reporter name bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ reporter plain path to plain output txt \ build you can use as many reporters as you like just use the reporter option multiple times included reporters pretty a text based reporter that uses ansi colors and unicode symbols for pretty output the default plain like pretty but with no colors or unicode phabricator outputs a json array of build test results which can be fed into the phabricator code review tool junit produces a junit xunit compatible xml file with test results json stream a stream of build test events as json dictionaries one per line example output json compilation database outputs a json compilation database of build events which can be used by clang tooling based tools e g oclint user notifications sends notification to notification center when action is completed example notifications teamcity sends service messages to teamcity continuous integration server implementing your own reporters you can also implement your own reporters using whatever language you like reporters in xctool are separate executables that read json objects from stdin and write formatted results to stdout you can invoke reporters by passing their full path via the reporter option bash path to xctool sh \ workspace yourworkspace xcworkspace \ scheme yourscheme \ reporter path to your reporter \ test for example heres a simple reporter in python that outputs a period for every passing test and an exclamation mark for every failing test python usr bin python import fileinput import json import sys for line in fileinput input obj json loads line if obj event end test if obj succeeded sys stdout write else sys stdout write sys stdout write \n if youre writing a reporter in objective c youll find the reporter class helpful see reporter h configuration xctool args if you routinely need to pass many arguments to xctool on the command line you can use an xctool args file to speed up your workflow if xctool finds an xctool args file in the current directory it will automatically pre populate its arguments from there the format is just a json array of arguments json workspace yourworkspace xcworkspace scheme yourscheme configuration debug sdk iphonesimulator arch i386 any extra arguments you pass on the command line will take precedence over those in the xctool args file contributing bug fixes improvements and especially new reporter implementations are welcome before submitting a pull request please be sure to sign the facebook contributor license agreement we cant accept pull requests unless its been signed workflow fork make a feature branch git checkout b my feature make your feature keep things tidy so you have one commit per self contained change squashing can help push your branch to your fork git push u origin my feature open github under your recently pushed branches click pull request for my feature be sure to use a separate feature branch and pull request for every self contained feature if you need to make changes from feedback make the changes in place rather than layering on commits use interactive rebase to edit your earlier commits then use git push force origin my feature to update your pull request workflow for facebook people other committers mostly the same but use branches in the main xctool repo if you prefer its a nice way to keep things together make a feature branch git checkout b myusername my feature push your branch git push u origin myusername my feature open github to facebook xctool under your recently pushed branches click pull request for myusername my feature known issues tips use shared schemes and disable the autocreate schemes feature xcode has two kinds of schemes shared and user user schemes are the default and theyre stored under a folder called username xcuserdatad which most people correctly add to their gitignore use shared schemes instead and commit them to your repo this way everyone on your team and your build server are working from the same information and are building in the same way make sure simulators run in a gui context if you are running xctool in continuous integration the user account calling xctool must have an active gui context if not the simulator will fail to start with cryptic warnings like tried to install the test host app com myapp test but failed preparing test environment failed test bundle failed to start there was a problem starting the test bundle simulator iphone 6 was not prepared failed for unknown reason test did not run simulator iphone 6 was not prepared failed for unknown reason 2015 01 21 12 02 19 296 xcodebuild 35135 875297 iphonesimulator timed out waiting 120 seconds for simulator to boot current state is 1 testing failed test target myprojecttests encountered an error timed out waiting 120 seconds for simulator to boot current state is 1 note that the same holds true with xcodebuild this is not xctool specific for more information see this post by jason jarrett license copyright 2014 present facebook licensed under the apache license version 2 0 the license you may not use this work except in compliance with the license you may obtain a copy of the license in the license file or at http www apache org licenses license 2 0 unless required by applicable law or agreed to in writing software distributed under the license is distributed on an as is basis without warranties or conditions of any kind either express or implied see the license for the specific language governing permissions and limitations under the license