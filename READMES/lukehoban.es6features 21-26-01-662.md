ecmascript 6 git io es6features introduction ecmascript 6 also known as ecmascript 2015 is the latest version of the ecmascript standard es6 is a significant update to the language and the first update to the language since es5 was standardized in 2009 implementation of these features in major javascript engines is underway now see the es6 standard for full specification of the ecmascript 6 language es6 includes the following new features arrows classes enhanced object literals template strings destructuring default rest spread let const iterators for of generators unicode modules module loaders map set weakmap weakset proxies symbols subclassable built ins promises math number string array object apis binary and octal literals reflect api tail calls ecmascript 6 features arrows arrows are a function shorthand using the syntax they are syntactically similar to the related feature in c java 8 and coffeescript they support both statement block bodies as well as expression bodies which return the value of the expression unlike functions arrows share the same lexical this as their surrounding code javascript expression bodies var odds evens map v v 1 var nums evens map v i v i var pairs evens map v even v odd v 1 statement bodies nums foreach v if v 5 0 fives push v lexical this var bob name bob friends printfriends this friends foreach f console log this name knows f more info mdn arrow functions classes es6 classes are a simple sugar over the prototype based oo pattern having a single convenient declarative form makes class patterns easier to use and encourages interoperability classes support prototype based inheritance super calls instance and static methods and constructors javascript class skinnedmesh extends three mesh constructor geometry materials super geometry materials this idmatrix skinnedmesh defaultmatrix this bones this bonematrices update camera super update get bonecount return this bones length set matrixtype matrixtype this idmatrix skinnedmeshmatrixtype static defaultmatrix return new three matrix4 more info mdn classes enhanced object literals object literals are extended to support setting the prototype at construction shorthand for foo foo assignments defining methods making super calls and computing property names with expressions together these also bring object literals and class declarations closer together and let object based design benefit from some of the same conveniences javascript var obj proto proto theprotoobj shorthand for ‘handler handler handler methods tostring super calls return d super tostring computed dynamic property names prop 42 42 more info mdn grammar and types object literals template strings template strings provide syntactic sugar for constructing strings this is similar to string interpolation features in perl python and more optionally a tag can be added to allow the string construction to be customized avoiding injection attacks or constructing higher level data structures from string contents javascript basic literal string creationin javascript \n is a line feed multiline strings in javascript this is not legal string interpolation var name bob time today hello name how are you time construct an http request prefix is used to interpret the replacements and construction posthttp foo org bar a a b b content type application json x credentials credentials foo foo bar bar myonreadystatechangehandler more info mdn template strings destructuring destructuring allows binding using pattern matching with support for matching arrays and objects destructuring is fail soft similar to standard object lookup foo bar producing undefined values when not found javascript list matching var a b 1 2 3 object matching var op a lhs op b rhs c getastnode object matching shorthand binds op lhs and rhs in scope var op lhs rhs getastnode can be used in parameter position function g name x console log x g name 5 fail soft destructuring var a a undefined fail soft destructuring with defaults var a 1 a 1 more info mdn destructuring assignment default rest spread callee evaluated default parameter values turn an array into consecutive arguments in a function call bind trailing parameters to an array rest replaces the need for arguments and addresses common cases more directly javascript function f x y 12 y is 12 if not passed or passed as undefined return x y f 3 15 javascript function f x y y is an array return x y length f 3 hello true 6 javascript function f x y z return x y z pass each elem of array as argument f 1 2 3 6 more mdn info default parameters rest parameters spread operator let const block scoped binding constructs let is the new var const is single assignment static restrictions prevent use before assignment javascript function f let x okay block scoped name const x sneaky error const x foo error already declared in block let x inner more mdn info let statement const statement iterators for of iterator objects enable custom iteration like clr ienumerable or java iterable generalize for in to custom iterator based iteration with for of dont require realizing an array enabling lazy design patterns like linq javascript let fibonacci symbol iterator let pre 0 cur 1 return next pre cur cur pre cur return done false value cur for var n of fibonacci truncate the sequence at 1000 if n 1000 break console log n iteration is based on these duck typed interfaces using typescript type syntax for exposition only typescript interface iteratorresult done boolean value any interface iterator next iteratorresult interface iterable symbol iterator iterator more info mdn for of generators generators simplify iterator authoring using function and yield a function declared as function returns a generator instance generators are subtypes of iterators which include additional next and throw these enable values to flow back into the generator so yield is an expression form which returns a value or throws note can also be used to enable ‘await like async programming see also es7 await proposal javascript var fibonacci symbol iterator function var pre 0 cur 1 for var temp pre pre cur cur temp yield cur for var n of fibonacci truncate the sequence at 1000 if n 1000 break console log n the generator interface is using typescript type syntax for exposition only typescript interface generator extends iterator next value any iteratorresult throw exception any more info mdn iteration protocols unicode non breaking additions to support full unicode including new unicode literal form in strings and new regexp u mode to handle code points as well as new apis to process strings at the 21bit code points level these additions support building global apps in javascript javascript same as es5 1 𠮷 length 2 new regexp behaviour opt in ‘u 𠮷 match u 0 length 2 new form \u 20bb7 𠮷 \ud842\udfb7 new string ops 𠮷 codepointat 0 0x20bb7 for of iterates code points for var c of 𠮷 console log c more info mdn regexp prototype unicode modules language level support for modules for component definition codifies patterns from popular javascript module loaders amd commonjs runtime behaviour defined by a host defined default loader implicitly async model – no code executes until requested modules are available and processed javascript lib math js export function sum x y return x y export var pi 3 141593 javascript app js import as math from lib math alert 2π math sum math pi math pi javascript otherapp js import sum pi from lib math alert 2π sum pi pi some additional features include export default and export javascript lib mathplusplus js export from lib math export var e 2 71828182846 export default function x return math log x javascript app js import ln pi e from lib mathplusplus alert 2π ln e pi 2 more mdn info import statement export statement module loaders module loaders support dynamic loading state isolation global namespace isolation compilation hooks nested virtualization the default module loader can be configured and new loaders can be constructed to evaluate and load code in isolated or constrained contexts javascript dynamic loading – ‘system is default loader system import lib math then function m alert 2π m sum m pi m pi create execution sandboxes – new loaders var loader new loader global fixup window replace ‘console log loader eval console log hello world directly manipulate module cache system get jquery system set jquery module warning not yet finalized map set weakmap weakset efficient data structures for common algorithms weakmaps provides leak free object keyd side tables javascript sets var s new set s add hello add goodbye add hello s size 2 s has hello true maps var m new map m set hello 42 m set s 34 m get s 34 weak maps var wm new weakmap wm set s extra 42 wm size undefined weak sets var ws new weakset ws add data 42 because the added object has no other references it will not be held in the set more mdn info map set weakmap weakset proxies proxies enable creation of objects with the full range of behaviors available to host objects can be used for interception object virtualization logging profiling etc javascript proxying a normal object var target var handler get function receiver name returnhello name var p new proxy target handler p world hello world javascript proxying a function object var target function return i am the target var handler apply function receiver args return i am the proxy var p new proxy target handler p i am the proxy there are traps available for all of the runtime level meta operations javascript var handler get set has deleteproperty apply construct getownpropertydescriptor defineproperty getprototypeof setprototypeof enumerate ownkeys preventextensions isextensible more info mdn proxy symbols symbols enable access control for object state symbols allow properties to be keyed by either string as in es5 or symbol symbols are a new primitive type optional description parameter used in debugging but is not part of identity symbols are unique like gensym but not private since they are exposed via reflection features like object getownpropertysymbols javascript var myclass function module scoped symbol var key symbol key function myclass privatedata this key privatedata myclass prototype dostuff function this key return myclass var c new myclass hello c key undefined more info mdn symbol subclassable built ins in es6 built ins like array date and dom elements can be subclassed object construction for a function named ctor now uses two phases both virtually dispatched call ctor create to allocate the object installing any special behavior invoke constructor on new instance to initialize the known create symbol is available via symbol create built ins now expose their create explicitly javascript pseudo code of array class array constructor args static symbol create install special defineownproperty to magically update length user code of array subclass class myarray extends array constructor args super args two phase new 1 call create to allocate object 2 invoke constructor on new instance var arr new myarray arr 1 12 arr length 2 math number string array object apis many new library additions including core math libraries array conversion helpers string helpers and object assign for copying javascript number epsilon number isinteger infinity false number isnan nan false math acosh 3 1 762747174039086 math hypot 3 4 5 math imul math pow 2 32 1 math pow 2 32 2 2 abcde includes cd true abc repeat 3 abcabcabc array from document queryselectorall returns a real array array of 1 2 3 similar to new array but without special one arg behavior 0 0 0 fill 7 1 0 7 7 1 2 3 find x x 3 3 1 2 3 findindex x x 2 1 1 2 3 4 5 copywithin 3 0 1 2 3 1 2 a b c entries iterator 0 a 1 b 2 c a b c keys iterator 0 1 2 a b c values iterator a b c object assign point origin new point 0 0 more mdn info number math array from array of array prototype copywithin object assign binary and octal literals two new numeric literal forms are added for binary b and octal o javascript 0b111110111 503 true 0o767 503 true promises promises are a library for asynchronous programming promises are a first class representation of a value that may be made available in the future promises are used in many existing javascript libraries javascript function timeout duration 0 return new promise resolve reject settimeout resolve duration var p timeout 1000 then return timeout 2000 then throw new error hmm catch err return promise all timeout 100 timeout 200 more info mdn promise reflect api full reflection api exposing the runtime level meta operations on objects this is effectively the inverse of the proxy api and allows making calls corresponding to the same meta operations as the proxy traps especially useful for implementing proxies javascript no sample yet more info mdn reflect tail calls calls in tail position are guaranteed to not grow the stack unboundedly makes recursive algorithms safe in the face of unbounded inputs javascript function factorial n acc 1 use strict if n 1 return acc return factorial n 1 n acc stack overflow in most implementations today but safe on arbitrary inputs in es6 factorial 100000