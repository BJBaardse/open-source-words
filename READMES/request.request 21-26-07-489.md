request simplified http client super simple to use request is designed to be the simplest way possible to make http calls it supports https and follows redirects by default js var request require request request http www google com function error response body console log error error print the error if one occurred console log statuscode response response statuscode print the response status code if a response was received console log body body print the html for the google homepage table of contents streaming promises async await forms http authentication custom http headers oauth signing proxies unix domain sockets tls ssl protocol support for har 1 2 all available options request also offers convenience methods like request defaults and request post and there are lots of usage examples and several debugging techniques streaming you can stream any response to a file stream js request http google com doodle png pipe fs createwritestream doodle png you can also stream a file to a put or post request this method will also check the file extension against a mapping of file extensions to content types in this case application json and use the proper content type in the put request if the headers dont already provide one js fs createreadstream file json pipe request put http mysite com obj json request can also pipe to itself when doing so content type and content length are preserved in the put headers js request get http google com img png pipe request put http mysite com img png request emits a response event when a response is received the response argument will be an instance of http incomingmessage js request get http google com img png on response function response console log response statuscode 200 console log response headers content type image png pipe request put http mysite com img png to easily handle errors when streaming requests listen to the error event before piping js request get http mysite com doodle png on error function err console log err pipe fs createwritestream doodle png now lets get fancy js http createserver function req resp if req url doodle png if req method put req pipe request put http mysite com doodle png else if req method get req method head request get http mysite com doodle png pipe resp you can also pipe from http serverrequest instances as well as to http serverresponse instances the http method headers and entity body data will be sent which means that if you dont really care about security you can do js http createserver function req resp if req url doodle png var x request http mysite com doodle png req pipe x x pipe resp and since pipe returns the destination stream in â‰¥ node 0 5 x you can do one line proxying js req pipe request http mysite com doodle png pipe resp also none of this new functionality conflicts with requests previous features it just expands them js var r request defaults proxy http localproxy com http createserver function req resp if req url doodle png r get http google com doodle png pipe resp you can still use intermediate proxies the requests will still follow http forwards etc back to top promises async await request supports both streaming and callback interfaces natively if youd like request to return a promise instead you can use an alternative interface wrapper for request these wrappers can be useful if you prefer to work with promises or if youd like to use async await in es2017 several alternative interfaces are provided by the request team including request promise uses bluebird promises request promise native uses native promises request promise any uses any promise promises back to top forms request supports application x www form urlencoded and multipart form data form uploads for multipart related refer to the multipart api application x www form urlencoded url encoded forms url encoded forms are simple js request post http service com upload form key value or request post http service com upload form key value or request post url http service com upload form key value function err httpresponse body multipart form data multipart form uploads for multipart form data we use the form data library by felixge for the most cases you can pass your upload form data via the formdata option js var formdata pass a simple key value pair my field my value pass data via buffers my buffer buffer from 1 2 3 pass data via streams my file fs createreadstream dirname unicycle jpg pass multiple values w an array attachments fs createreadstream dirname attachment1 jpg fs createreadstream dirname attachment2 jpg pass optional meta data with an options object with style value data options options use case for some types of streams youll need to provide file related information manually see the form data readme for more information about options https github com form data form data custom file value fs createreadstream dev urandom options filename topsecret jpg contenttype image jpeg request post url http service com upload formdata formdata function optionalcallback err httpresponse body if err return console error upload failed err console log upload successful server responded with body for advanced cases you can access the form data object itself via r form this can be modified until the request is fired on the next cycle of the event loop note that this calling form will clear the currently set form data for that request js note advanced use case for normal use see formdata usage above var r request post http service com upload function optionalcallback err httpresponse body var form r form form append my field my value form append my buffer buffer from 1 2 3 form append custom file fs createreadstream dirname unicycle jpg filename unicycle jpg see the form data readme for more information examples multipart related some variations in different http implementations require a newline crlf before after or both before and after the boundary of a multipart related request using the multipart option this has been observed in the net webapi version 4 0 you can turn on a boundary preamblecrlf or postamble by passing them as true to your request options js request method put preamblecrlf true postamblecrlf true uri http service com upload multipart content type application json body json stringify foo bar attachments message txt follows true length 18 content type text plain body i am an attachment body fs createreadstream image png alternatively pass an object containing additional options multipart chunked false data content type application json body json stringify foo bar attachments message txt follows true length 18 content type text plain body i am an attachment function error response body if error return console error upload failed error console log upload successful server responded with body back to top http authentication js request get http some server com auth username password false or request get http some server com auth user username pass password sendimmediately false or request get http some server com auth null null true bearertoken or request get http some server com auth bearer bearertoken if passed as an option auth should be a hash containing values user username pass password sendimmediately optional bearer optional the method form takes parameters auth username password sendimmediately bearer sendimmediately defaults to true which causes a basic or bearer authentication header to be sent if sendimmediately is false then request will retry with a proper authentication header after receiving a 401 response from the server which must contain a www authenticate header indicating the required authentication method note that you can also specify basic authentication using the url itself as detailed in rfc 1738 simply pass the user password before the host with an sign js var username username password password url http username password some server com request url url function error response body do more stuff with body here digest authentication is supported but it only works with sendimmediately set to false otherwise request will send basic authentication on the initial request which will probably cause the request to fail bearer authentication is supported and is activated when the bearer value is available the value may be either a string or a function returning a string using a function to supply the bearer token is particularly useful if used in conjunction with defaults to allow a single function to supply the last known token at the time of sending a request or to compute one on the fly back to top custom http headers http headers such as user agent can be set in the options object in the example below we call the github api to find out the number of stars and forks for the request repository this requires a custom user agent header as well as https js var request require request var options url https api github com repos request request headers user agent request function callback error response body if error response statuscode 200 var info json parse body console log info stargazers count stars console log info forks count forks request options callback back to top oauth signing oauth version 1 0 is supported the default signing algorithm is hmac sha1 js oauth1 0 3 legged server side flow twitter example step 1 var qs require querystring oauth callback http mysite com callback consumer key consumer key consumer secret consumer secret url https api twitter com oauth request token request post url url oauth oauth function e r body ideally you would take the body in the response and construct a url that a user clicks on like a sign in button the verifier is only available in the response after a user has verified with twitter that they are authorizing your app step 2 var req data qs parse body var uri https api twitter com oauth authenticate qs stringify oauth token req data oauth token redirect the user to the authorize uri step 3 after the user is redirected back to your server var auth data qs parse body oauth consumer key consumer key consumer secret consumer secret token auth data oauth token token secret req data oauth token secret verifier auth data oauth verifier url https api twitter com oauth access token request post url url oauth oauth function e r body ready to make signed requests on behalf of the user var perm data qs parse body oauth consumer key consumer key consumer secret consumer secret token perm data oauth token token secret perm data oauth token secret url https api twitter com 1 1 users show json qs screen name perm data screen name user id perm data user id request get url url oauth oauth qs qs json true function e r user console log user for rsa sha1 signing make the following changes to the oauth options object pass signature method rsa sha1 instead of consumer secret specify a private key string in pem format for plaintext signing make the following changes to the oauth options object pass signature method plaintext to send oauth parameters via query params or in a post body as described in the consumer request parameters section of the oauth1 spec pass transport method query or transport method body in the oauth options object transport method defaults to header to use request body hash you can either manually generate the body hash and pass it as a string body hash automatically generate the body hash by passing body hash true back to top proxies if you specify a proxy option then the request and any subsequent redirects will be sent via a connection to the proxy server if your endpoint is an https url and you are using a proxy then request will send a connect request to the proxy server first and then use the supplied connection to connect to the endpoint that is first it will make a request like http 1 1 connect endpoint server com 80 host proxy server com user agent whatever user agent you specify and then the proxy server make a tcp connection to endpoint server on port 80 and return a response that looks like http 1 1 200 ok at this point the connection is left open and the client is communicating directly with the endpoint server com machine see the wikipedia page on http tunneling for more information by default when proxying http traffic request will simply make a standard proxied http request this is done by making the url section of the initial line of the request a fully qualified url to the endpoint for example it will make a single request that looks like http 1 1 get http endpoint server com some url host proxy server com other headers all go here request body or whatever because a pure http over http tunnel offers no additional security or other features it is generally simpler to go with a straightforward http proxy in this case however if you would like to force a tunneling proxy you may set the tunnel option to true you can also make a standard proxied http request by explicitly setting tunnel false but note that this will allow the proxy to see the traffic to from the destination server if you are using a tunneling proxy you may set the proxyheaderwhitelist to share certain headers with the proxy you can also set the proxyheaderexclusivelist to share certain headers only with the proxy and not with destination host by default this set is accept accept charset accept encoding accept language accept ranges cache control content encoding content language content length content location content md5 content range content type connection date expect max forwards pragma proxy authorization referer te transfer encoding user agent via note that when using a tunneling proxy the proxy authorization header and any headers from custom proxyheaderexclusivelist are never sent to the endpoint server but only to the proxy server controlling proxy behaviour using environment variables the following environment variables are respected by request http proxy http proxy https proxy https proxy no proxy no proxy when http proxy http proxy are set they will be used to proxy non ssl requests that do not have an explicit proxy configuration option present similarly https proxy https proxy will be respected for ssl requests that do not have an explicit proxy configuration option it is valid to define a proxy in one of the environment variables but then override it for a specific request using the proxy configuration option furthermore the proxy configuration option can be explicitly set to false null to opt out of proxying altogether for that request request is also aware of the no proxy no proxy environment variables these variables provide a granular way to opt out of proxying on a per host basis it should contain a comma separated list of hosts to opt out of proxying it is also possible to opt of proxying when a particular destination port is used finally the variable may be set to to opt out of the implicit proxy configuration of the other environment variables heres some examples of valid no proxy values google com dont proxy http https requests to google google com 443 dont proxy https requests to google but do proxy http requests to google google com 443 yahoo com 80 dont proxy https requests to google and dont proxy http requests to yahoo ignore https proxy http proxy environment variables altogether back to top unix domain sockets request supports making requests to unix domain sockets to make one use the following url scheme js pattern http unix socket path example request get http unix absolute path to unix socket request path note the socket path is assumed to be absolute to the root of the host file system back to top tls ssl protocol tls ssl protocol options such as cert key and passphrase can be set directly in options object in the agentoptions property of the options object or even in https globalagent options keep in mind that although agentoptions allows for a slightly wider range of configurations the recommended way is via options object directly as using agentoptions or https globalagent options would not be applied in the same way in proxied environments as data travels through a tls connection instead of an http https agent js var fs require fs path require path certfile path resolve dirname ssl client crt keyfile path resolve dirname ssl client key cafile path resolve dirname ssl ca cert pem request require request var options url https api some server com cert fs readfilesync certfile key fs readfilesync keyfile passphrase password ca fs readfilesync cafile request get options using options agentoptions in the example below we call an api that requires client side ssl certificate in pem format with passphrase protected private key in pem format and disable the sslv3 protocol js var fs require fs path require path certfile path resolve dirname ssl client crt keyfile path resolve dirname ssl client key request require request var options url https api some server com agentoptions cert fs readfilesync certfile key fs readfilesync keyfile or use pfx property replacing cert and key when using private key certificate and ca certs in pfx or pkcs12 format pfx fs readfilesync pfxfilepath passphrase password securityoptions ssl op no sslv3 request get options it is able to force using sslv3 only by specifying secureprotocol js request get url https api some server com agentoptions secureprotocol sslv3 method it is possible to accept other certificates than those signed by generally allowed certificate authorities cas this can be useful for example when using self signed certificates to require a different root certificate you can specify the signing ca by adding the contents of the cas certificate file to the agentoptions the certificate the domain presents must be signed by the root certificate specified js request get url https api some server com agentoptions ca fs readfilesync ca cert pem back to top support for har 1 2 the options har property will override the values url method qs headers form formdata body json as well as construct multipart data and read files from disk when request postdata params filename is present without a matching value a validation step will check if the har request format matches the latest spec v1 2 and will skip parsing if not matching js var request require request request will be ignored method get uri http www google com http archive request object har url http www mockbin com har method post headers name content type value application x www form urlencoded postdata mimetype application x www form urlencoded params name foo value bar name hello value world a post request will be sent to http www mockbin com with body an application x www form urlencoded body foo bar hello world back to top request options callback the first argument can be either a url or an options object the only required option is uri all others are optional uri url fully qualified uri or a parsed url object from url parse baseurl fully qualified uri string used as the base url most useful with request defaults for example when you want to do many requests to the same domain if baseurl is https example com api then requesting end point test true will fetch https example com api end point test true when baseurl is given uri must also be a string method http method default get headers http headers default qs object containing querystring values to be appended to the uri qsparseoptions object containing options to pass to the qs parse method alternatively pass options to the querystring parse method using this format sep eq options qsstringifyoptions object containing options to pass to the qs stringify method alternatively pass options to the querystring stringify method using this format sep eq options for example to change the way arrays are converted to query strings using the qs module pass the arrayformat option with one of indices brackets repeat usequerystring if true use querystring to stringify and parse querystrings otherwise use qs default false set this option to true if you need arrays to be serialized as foo bar foo baz instead of the default foo 0 bar foo 1 baz body entity body for patch post and put requests must be a buffer string or readstream if json is true then body must be a json serializable object form when passed an object or a querystring this sets body to a querystring representation of value and adds content type application x www form urlencoded header when passed no options a formdata instance is returned and is piped to request see forms section above formdata data to pass for a multipart form data request see forms section above multipart array of objects which contain their own headers and body attributes sends a multipart related request see forms section above alternatively you can pass in an object chunked false data where chunked is used to specify whether the request is sent in chunked transfer encoding in non chunked requests data items with body streams are not allowed preamblecrlf append a newline crlf before the boundary of your multipart form data request postamblecrlf append a newline crlf at the end of the boundary of your multipart form data request json sets body to json representation of value and adds content type application json header additionally parses the response body as json jsonreviver a reviver function that will be passed to json parse when parsing a json response body jsonreplacer a replacer function that will be passed to json stringify when stringifying a json request body auth a hash containing values user username pass password and sendimmediately optional see documentation above oauth options for oauth hmac sha1 signing see documentation above hawk options for hawk signing the credentials key must contain the necessary signing info see hawk docs for details aws object containing aws signing information should have the properties key secret and optionally session note that this only works for services that require session as part of the canonical string also requires the property bucket unless youre specifying your bucket as part of the path or the request doesnt use a bucket i e get services if you want to use aws sign version 4 use the parameter sign version with value 4 otherwise the default is version 2 note you need to npm install aws4 first httpsignature options for the http signature scheme using joyents library the keyid and key properties must be specified see the docs for other options followredirect follow http 3xx responses as redirects default true this property can also be implemented as function which gets response object as a single argument and should return true if redirects should continue or false otherwise followallredirects follow non get http 3xx responses as redirects default false followoriginalhttpmethod by default we redirect to http method get you can enable this property to redirect to the original http method default false maxredirects the maximum number of redirects to follow default 10 removerefererheader removes the referer header when a redirect happens default false note if true referer header set in the initial request is preserved during redirect chain encoding encoding to be used on setencoding of response data if null the body is returned as a buffer anything else including the default value of undefined will be passed as the encoding parameter to tostring meaning this is effectively utf8 by default note if you expect binary data you should set encoding null gzip if true add an accept encoding header to request compressed content encodings from the server if not already present and decode supported content encodings in the response note automatic decoding of the response content is performed on the body data returned through request both through the request stream and passed to the callback function but is not performed on the response stream available from the response event which is the unmodified http incomingmessage object which may contain compressed data see example below jar if true remember cookies for future use or define your custom cookie jar see examples section agent http s agent instance to use agentclass alternatively specify your agents class name agentoptions and pass its options note for https see tls api doc for tls ssl options and the documentation above forever set to true to use the forever agent note defaults to http s agent keepalive true in node 0 12 pool an object describing which agents to use for the request if this option is omitted the request will use the global agent as long as your options allow for it otherwise request will search the pool for your custom agent if no custom agent is found a new agent will be created and added to the pool note pool is used only when the agent option is not specified a maxsockets property can also be provided on the pool object to set the max number of sockets for all agents created ex pool maxsockets infinity note that if you are sending multiple requests in a loop and creating multiple new pool objects maxsockets will not work as intended to work around this either use request defaults with your pool options or create the pool object with the maxsockets property outside of the loop timeout integer containing the number of milliseconds to wait for a server to send response headers and start the response body before aborting the request note that if the underlying tcp connection cannot be established the os wide tcp connection timeout will overrule the timeout option the default in linux can be anywhere from 20 120 seconds localaddress local interface to bind for network connections proxy an http proxy to be used supports proxy auth with basic auth identical to support for the url parameter by embedding the auth info in the uri strictssl if true requires ssl certificates be valid note to use your own certificate authority you need to specify an agent that was created with that ca as an option tunnel controls the behavior of http connect tunneling as follows undefined default true if the destination is https false otherwise true always tunnel to the destination by making a connect request to the proxy false request the destination as a get request proxyheaderwhitelist a whitelist of headers to send to a tunneling proxy proxyheaderexclusivelist a whitelist of headers to send exclusively to a tunneling proxy and not to destination time if true the request response cycle including all redirects is timed at millisecond resolution when set the following properties are added to the response object elapsedtime duration of the entire request response in milliseconds deprecated responsestarttime timestamp when the response began in unix epoch milliseconds deprecated timingstart timestamp of the start of the request in unix epoch milliseconds timings contains event timestamps in millisecond resolution relative to timingstart if there were redirects the properties reflect the timings of the final request in the redirect chain socket relative timestamp when the http modules socket event fires this happens when the socket is assigned to the request lookup relative timestamp when the net modules lookup event fires this happens when the dns has been resolved connect relative timestamp when the net modules connect event fires this happens when the server acknowledges the tcp connection response relative timestamp when the http modules response event fires this happens when the first bytes are received from the server end relative timestamp when the last bytes of the response are received timingphases contains the durations of each request phase if there were redirects the properties reflect the timings of the final request in the redirect chain wait duration of socket initialization timings socket dns duration of dns lookup timings lookup timings socket tcp duration of tcp connection timings connect timings socket firstbyte duration of http server response timings response timings connect download duration of http download timings end timings response total duration entire http round trip timings end har a har 1 2 request object will be processed from har format into options overwriting matching values see the har 1 2 section for details callback alternatively pass the requests callback in the options object the callback argument gets 3 arguments an error when applicable usually from http clientrequest object an http incomingmessage object response object the third is the response body string or buffer or json object if the json option is supplied back to top convenience methods there are also shorthand methods for different http methods and some other conveniences request defaults options this method returns a wrapper around the normal request api that defaults to whatever options you pass to it note request defaults does not modify the global request api instead it returns a wrapper that has your default settings applied to it note you can call defaults on the wrapper that is returned from request defaults to add override defaults that were previously defaulted for example js requests using baserequest will set the x token header var baserequest request defaults headers x token my token requests using specialrequest will include the x token header set in baserequest and will also include the special header var specialrequest baserequest defaults headers special special value request method these http method convenience functions act just like request but with a default method already set for you request get defaults to method get request post defaults to method post request put defaults to method put request patch defaults to method patch request del request delete defaults to method delete request head defaults to method head request options defaults to method options request cookie function that creates a new cookie js request cookie key1 value1 request jar function that creates a new cookie jar js request jar back to top debugging there are at least three ways to debug the operation of request launch the node process like node debug request node script js lib request otherlib works too set require request debug true at any time this does the same thing as 1 use the request debug module to view request and response headers and bodies back to top timeouts most requests to external servers should have a timeout attached in case the server is not responding in a timely manner without a timeout your code may have a socket open consume resources for minutes or more there are two main types of timeouts connection timeouts and read timeouts a connect timeout occurs if the timeout is hit while your client is attempting to establish a connection to a remote machine corresponding to the connect call on the socket a read timeout occurs any time the server is too slow to send back a part of the response these two situations have widely different implications for what went wrong with the request so its useful to be able to distinguish them you can detect timeout errors by checking err code for an etimedout value further you can detect whether the timeout was a connection timeout by checking if the err connect property is set to true js request get http 10 255 255 1 timeout 1500 function err console log err code etimedout set to true if the timeout was a connection timeout false or undefined otherwise console log err connect true process exit 0 examples js var request require request rand math floor math random 100000000 tostring request method put uri http mikeal iriscouch com testjs rand multipart content type application json body json stringify foo bar attachments message txt follows true length 18 content type text plain body i am an attachment function error response body if response statuscode 201 console log document saved as http mikeal iriscouch com testjs rand else console log error response statuscode console log body for backwards compatibility response compression is not supported by default to accept gzip compressed responses set the gzip option to true note that the body data passed through request is automatically decompressed while the response object is unmodified and will contain compressed data if the server sent a compressed response js var request require request request method get uri http www google com gzip true function error response body body is the decompressed response body console log server encoded the data as response headers content encoding identity console log the decoded data is body on data function data decompressed data as it is received console log decoded chunk data on response function response unmodified http incomingmessage object response on data function data compressed data as it is received console log received data length bytes of compressed data cookies are disabled by default else they would be used in subsequent requests to enable cookies set jar to true either in defaults or options js var request request defaults jar true request http www google com function request http images google com to use a custom cookie jar instead of requests global cookie jar set jar to an instance of request jar either in defaults or options js var j request jar var request request defaults jar j request http www google com function request http images google com or js var j request jar var cookie request cookie key1 value1 var url http www google com j setcookie cookie url request url url jar j function request http images google com to use a custom cookie store such as a filecookiestore which supports saving to and restoring from json files pass it as a parameter to request jar js var filecookiestore require tough cookie filestore note currently the cookies json file must already exist var j request jar new filecookiestore cookies json request request defaults jar j request http www google com function request http images google com the cookie store must be a tough cookie store and it must support synchronous operations see the cookiestore api docs for details to inspect your cookie jar after a request js var j request jar request url http www google com jar j function var cookie string j getcookiestring url key1 value1 key2 value2 var cookies j getcookies url key key1 value value1 domain www google com back to top