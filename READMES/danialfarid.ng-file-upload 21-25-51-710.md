ng file upload lightweight angular directive to upload files see the demo page reference docs here migration notes version 3 0 x version 3 1 x version 3 2 x version 4 x x version 5 x x version 6 x x version 6 2 x version 7 0 x version 7 2 x version 8 0 x version 9 0 x version 10 0 x version 11 0 x version 12 0 x version 12 1 x version 12 2 x ask questions on stackoverflow under the ng file upload tag for bug report or feature request please search through existing issues first then open a new one here for faster response provide steps to reproduce versions with a jsfiddle link if you need support for your company contact me if you like this plugin give it a thumbs up at ngmodules or get me a cup of tea contributions are welcomed table of content features install manual bower nuget npm usage old browsers server side samples java spring node js rails php net cors amazon s3 upload features file upload progress cancel abort file drag and drop html5 only image paste from clipboard and drag and drop from browser pages html5 only image resize and center crop native and user controlled crop through ngimgcrop see crop sample html5 only orientation fix for jpeg image files with exif orientation data resumable uploads pause resume upload html5 only native validation support for file type size image width height aspect ratio video audio duration and ng required with pluggable custom sync or async validations show thumbnail or preview of selected images audio videos supports cors and direct upload of files binary data using upload http plenty of sample server side code available on nuget on demand flash fileapi shim loading no extra load for html5 browsers html5 filereader readasdataurl shim for ie8 9 available on npm bower meteor nuget install manual download latest from here bower bower install ng file upload shim save for non html5 suppport bower install ng file upload save nuget pm install package angular file upload thanks to georgios diamantopoulos npm npm install ng file upload html script src angular min js script script src ng file upload shim min js script for no html5 browsers support script src ng file upload min js script usage samples upload with form submit and validations http jsfiddle net danialfarid maqbzv15 1118 upload multiple files one by one on file select http jsfiddle net danialfarid 2vq88rfs 136 upload multiple files in one request on file select html5 only http jsfiddle net danialfarid huhjo9jm 5 upload single file on file select http jsfiddle net danialfarid 0mz6ff9o 135 drop and upload with watch http jsfiddle net danialfarid s8kc7wg0 400 image crop and upload http jsfiddle net danialfarid xxo3sk41 590 html shim is needed to support non html5 formdata browsers ie8 9 upload on form submit or button click single image with validations select multiple files select drop files drop submit upload right away after file selection upload on file select upload on file select drop file drop images or pdfs files here file drag drop is not supported for this browser image thumbnail audio preview video preview javascript code js inject directives and services var app angular module fileupload ngfileupload app controller myctrl scope upload function scope upload upload later on form submit or something similar scope submit function if scope form file valid scope file scope upload scope file upload on file select or drop scope upload function file upload upload url upload url data file file username scope username then function resp console log success resp config data file name uploaded response resp data function resp console log error status resp status function evt var progresspercentage parseint 100 0 evt loaded evt total console log progress progresspercentage evt config data file name for multiple files scope uploadfiles function files if files files length for var i 0 i files length i upload upload data file files i or send them all together for html5 browsers upload upload data file files full reference file select and drop at least one of the ngf select or ngf drop are mandatory for the plugin to link to the element ngf select only attributes are marked with and ngf drop only attributes are marked with html ngf drop or upload files called when files being dropped you can use ng model or ngf change instead of specifying function for ngf drop and ngf select function parameters are the same as ngf change ngf change upload files file newfiles duplicatefiles invalidfiles event called when files are selected dropped or cleared ng model myfiles binds the valid selected dropped file or files to the scope model could be an array or single file depending on ngf multiple and ngf keep values ngf model options updateon change click drop dropurl paste allowinvalid false debounce 0 updateon could be used to disable resetting on click or updating on paste browser image drop etc allowinvalid default is false could allow invalid files in the model debouncing will postpone model update miliseconds see angular ng model options for more details ngf model invalid invalidfile s binds the invalid selected dropped file or files to this model ngf before model change beforechange files called after file select drop and before model change validation and resize is processed ng disabled boolean disables this element ngf select disabled boolean default false disables file select on this element ngf drop disabled boolean default false disables file drop on this element ngf multiple boolean default false allows selecting multiple files ngf keep true false distinct default false keep the previous ng model files and append the new files distinct removes duplicate files newfiles and duplicatefiles are set in ngf change select drop functions ngf fix orientation boolean default false would rotate the jpeg image files that have exif orientation data see 745 could be a boolean function like shouldfixorientation file to decide wethere to fix that file or not ngf capture camera or other allows mobile devices to capture using camera ngf accept image standard html accept attr browser specific select popup window ngf allow dir boolean default true allow dropping files only for chrome webkit browser ngf include dir boolean default false include directories in the dropped file array you can detect if they are directory or not by checking the type directory ngf drag over class pattern image accept acceptclass reject rejectclass delay 100 or mydragoverclass or calcdragoverclass event default dragover drag over css class behaviour could be a string a function returning class name or a json object accept reject class only works in chrome validating only the file mime type if pattern is not specified ngf pattern will be used see following docs for more info ngf drag drag isdragging class event function called on drag over leave events isdragging boolean true if is dragging over dragover false if drag has left dragleave class is the class that is being set for the element calculated by ngf drag over class ngf drop available dropsupported set the value of scope model to true or false based on file drag drop support for this browser ngf stop propagation boolean default false whether to propagate drag drop events ngf hide on drop not available boolean default false hides element if file drag drop is not ngf enable firefox paste boolean experimental default false enable firefox image paste by making element contenteditable ngf resize width 100 height 100 quality 8 type image jpeg ratio 1 2 centercrop true pattern jpg restoreexif false or resizeoptions a function returning a promise which resolves into the options resizes the image to the given width height or ratio quality is optional between 0 1 and 1 0 type is optional convert it to the given image type format centercrop true will center crop the image if it does not fit within the given width height or ratio centercrop false default will not crop the image and will fit it within the given width height or ratio so the resulting image width or height could be less than given width or height pattern is to resize only the files that their name or type matches the pattern similar to ngf pattern restoreexif boolean default true will restore exif info on the resized image ngf resize if width 1000 height 1000 or resizecondition file width height apply ngf resize only if this function returns true to filter specific images to be resized ngf validate after resize boolean default false if true all validation will be run after the images are being resized so any validation error before resize will be ignored validations ngf max files 10 maximum number of files allowed to be selected or dropped validate error name maxfiles ngf pattern pdf jpg video jog comma separated wildcard to filter file names and types allowed you can exclude specific files by at the beginning validate error name pattern ngf min size ngf max size ngf max total size 100 in bytes or 10kb or 10mb or 10gb validate as form file error maxsize true and file error maxsize ngf max total size is for multiple file select and validating the total size of all files ngf min height ngf max height ngf min width ngf max width 1000 in pixels only images validate error names minheight maxheight minwidth maxwidth ngf ratio 8 10 1 6 list of comma separated valid aspect ratio of images in float or 2 3 format validate error name ratio ngf min ratio ngf max ratio 8 10 min or max allowed aspect ratio for the image ngf dimensions width 1000 height 1000 or validatedimension file width height validate the image dimensions validate error name dimensions ngf min duration ngf max duration 100 5 in seconds or 10s or 10m or 10h only audio video validate error name maxduration ngf duration duration 1000 or validateduration file duration validate the media duration validate error name duration ngf validate size min 10 max 20mb width min 100 max 10000 height min 100 max 300 ratio 2x1 duration min 10s max 5m pattern jpg shorthand form for above validations in one place ngf validate fn validate file custom validation function return boolean or string containing the error validate error name validatefn ngf validate async fn validate file custom validation function return a promise that resolve to boolean or string containing the error validate error name validateasyncfn ngf validate force boolean default false if true file error will be set if the dimension or duration values for validations cannot be calculated for example image load error or unsupported video by the browser by default it would assume the file is valid if the duration or dimension cannot be calculated by the browser ngf ignore invalid pattern maxsize ignore the files that fail the specified validations they will just be ignored and will not show up in ngf model invalid or make the form invalid space separated list of validate error names ngf run all validations boolean default false runs all the specified validate directives by default once a validation fails for a file it would stop running other validations for that file upload drop file drag drop is not supported filter to convert the file to base64 data url image file preview html ngf background file sets background image style to the file data url ngf resize width 20 height 20 quality 0 9 only for image resizes the image before setting it as src or background image quality is optional ngf no object url true or false see 887 to force base64 url generation instead of object url default false ngf size width 20 height 20 quality 0 9 the image will be resized to this size if not specified will be resized to this element s client width and height ngf as background boolean if true it will set the background image style instead of src attribute upload service js var upload upload upload url server upload url upload php script node js route or servlet url specify the file and optional data to be sent to the server each field including nested objects will be sent as a form data multipart samples pic file username username files files otherinfo id id person person multiple files html5 profiles pic file1 username username1 pic file2 username username2 nested array multiple files html5 file file info upload json id id name name send fields as json string file file info upload jsonblob id id name name send fields as json blob application json content type picfile upload rename file profile jpg title title send file with picfile key and profile jpg file name data key file otherinfo uploadinfo this is to accommodate server implementations expecting nested data object keys in key or key format example data rec name n pic file sent as rec name n rec pic file data rec name n pic file objectkey k sent as rec name n rec pic file objectkey k or k default is k this is to accommodate server implementations expecting array data object keys in i or or multiple entries with same key format example data rec file 0 file 1 sent as rec 0 file 0 rec 1 file 1 data rec rec f 0 f 1 arraykey sent as rec f 0 rec f 1 arraykey i or or i or default is i method post or put html5 default post headers authorization xxx only for html5 withcredentials boolean see resumable upload guide below the code for more details html5 only resumesizeurl uploaded size url file file name uploaded file size so far on the server resumesizeresponsereader function data return data size reads the uploaded file size from resumesizeurl get response resumesize function return promise function that returns a prommise which will be resolved to the upload file size on the server resumechunksize 10000 or 10kb or 10mb upload in chunks of specified size disableprogress boolean default false experimental as hotfix for potential library conflicts with other plugins and all other angular http options could be used here returns a promise upload then function resp file is uploaded successfully console log file resp config data file name is uploaded successfully response resp data function resp handle error function evt progress notify console log progress parseint 100 0 evt loaded evt total file evt config data file name upload catch errorcallback upload finally callback notifycallback access or attach event listeners to the underlying xmlhttprequest upload xhr function xhr xhr upload addeventlistener cancel abort the upload in progress upload abort alternative way of uploading send the file binary with the files content type could be used to upload files to couchdb imgur etc html5 filereader is needed this is equivalent to angular http but allow you to listen to the progress event for html5 browsers upload http url server upload url headers content type file type data file set the default values for ngf select and ngf drop directives upload setdefaults ngfminsize 20000 ngfmaxsize 20000000 these two defaults could be decreased if you experience out of memory issues or could be increased if your app needs to show many images on the page each image in ngf src ngf background or ngf thumbnail is stored and referenced as a blob url and will only be released if the max value of the followings is reached upload defaults bloburlsmaxmemory 268435456 default max total size of files stored in blob urls upload defaults bloburlsmaxqueuesize 200 default max number of blob urls stored by this application convert a single file or array of files to a single or array of base64 data url representation of the file s could be used to send file in base64 format inside json to the databases upload base64dataurl files then function urls convert the file to blob url object or base64 data url based on boolean disallowobjecturl value upload dataurl file boolean then function url get image file dimensions upload imagedimensions file then function dimensions console log dimensions width dimensions height get audio video duration upload mediaduration file then function durationinseconds resizes an image returns a promise options width height quality type ratio centercrop resizeif restoreexif resizeif width height returns boolean see ngf resize directive for more details of options upload resize file options then function resizedfile returns boolean showing if image resize is supported by this browser upload isresizesupported returns boolean showing if resumable upload is supported by this browser upload isresumesupported returns a file which will be uploaded with the newname instead of original file name upload rename file newname converts the object to a blob object with application json content type for jsob byte streaming support 359 html5 only upload jsonblob obj converts the value to json to send data as json string same as angular tojson obj upload json obj converts a dataurl to blob object var blob upload dataurltoblob dataurl name returns true if there is an upload in progress can be used to prompt user before closing browser tab upload isuploadinprogress boolean downloads and converts a given url to blob object which could be added to files model upload urltoblob url then function blob returns boolean to check if the object is file and could be used as file in upload upload http upload isfile obj fixes the exif orientation of the jpeg image file upload applyexifrotation file then ng model the model value will be a single file instead of an array if all of the followings are true ngf multipleis not set or is resolved to false multipleattribute is not set on the element ngf keep is not set or is resolved to false validation when any of the validation directives specified the form validation will take place and you can access the value of the validation using myform myfileinputname error validate error name for example form file error pattern if multiple file selection is allowed you can specify ngf model invalid invalidfiles to assing the invalid files to a model and find the error of each individual file with file error and description of it with file errorparam you can use angular ngf model options to allow invalid files to be set to the ng model ngf model options allowinvalid true upload multiple files only for html5 formdata browsers not ie8 9 you have an array of files or more than one file in your data to send them all in one request non html5 browsers due to flash limitation will upload each file one by one in a separate request you should iterate over the files and send them one by one for a cross browser solution drag and drop styling for file drag and drop ngf drag over class could be used to style the drop zone it can be a function that returns a class name based on the event default is dragover string only in chrome it could be a json object accept a reject r pattern image delay 10 that specify the class name for the accepted or rejected drag overs the pattern specified or ngf pattern will be used to validate the files mime type since that is the only property of the file that is reported by the browser on drag so you cannot validate the file name extension size or other validations on drag there is also some limitation on some file types which are not reported by chrome delay default is 100 and is used to fix css3 transition issues from dragging over out over 277 upload setdefaults if you have many file selects or drops you can set the default values for the directives by calling upload setdefaults options options would be a json object with directive names in camelcase and their default values resumable uploads the plugin supports resumable uploads for large files on your server you need to keep track of what files are being uploaded and how much of the file is uploaded url upload endpoint need to reassemble the file chunks by appending uploading content to the end of the file or correct chunk position if it already exists resumesizeurl server endpoint to return uploaded file size so far on the server to be able to resume the upload from where it is ended it should return zero if the file has not been uploaded yet a get request will be made to that url for each upload to determine if part of the file is already uploaded or not you need a unique way of identifying the file on the server so you can pass the file name or generated id for the file as a request parameter by default it will assume that the response content is an integer or a json object with size integer property if you return other formats from the endpoint you can specify resumesizeresponsereader function to return the size value from the response alternatively instead of resumesizeurl you can use resumesize function which returns a promise that resolves to the size of the uploaded file so far make sure when the file is fully uploaded without any error abort this endpoint returns zero for the file size if you want to let the user to upload the same file again or optionally you could have a restart endpoint to set that back to zero to allow re uploading the same file resumechunksize optionally you can specify this to upload the file in chunks to the server this will allow uploading to gae or other servers that have file size limitation and trying to upload the whole request before passing it for internal processing if this option is set the requests will have the following extra fields chunksize currentchunksize chunknumber zero starting and totalsize to help the server to write the uploaded chunk to the correct position uploading in chunks could slow down the overall upload time specially if the chunk size is too small when you provide resumechunksize option one of the resumesizeurl or resumesize is mandatory to know how much of the file is uploaded so far old browsers for browsers not supporting html5 formdata ie8 ie9 fileapi module is used note you need flash installed on your browser since fileapi uses flash to upload files these two files fileapi min js fileapi flash swf will be loaded by the module on demand no need to be included in the html if the browser does not supports html5 formdata to avoid extra load for html5 browsers you can place these two files beside angular file upload shim min js on your server to be loaded automatically from the same path or you can specify the path to those files if they are in a different path using the following script html optional need to be loaded before angular file upload shim min js fileapi only one of jspath or jsurl jspath js fileapi min js folder jsurl yourcdn com js fileapi min js p pre code only one of staticpath or flashurl staticpath flash fileapi flash swf folder flashurl yourcdn com js fileapi flash swf forceload true html5 false to debug flash in html5 browsers nocontenttimeout 10000 see 528 code pre p old browsers known issues because of a flash limitation bug if the server doesnt send any response body the status code of the response will be always204 no content so if you have access to your server upload code at least return a character in the response for the status code to work properly custom headers will not work due to a flash limitation 111 https github com danialfarid ng file upload issues 111 224 https github com danialfarid ng file upload issues 224 129 https github com danialfarid ng file upload issues 129 due to flash bug 92 https github com danialfarid ng file upload issues 92 server http error code 400 will be returned as 200 to the client so avoid returning 400 on your server side for upload response otherwise it will be treated as a success response on the client side in case of an error response http code 400 the custom error message returned from the server may not be available for some error codes flash just provide a generic error message and ignores the response text 310 https github com danialfarid ng file upload issues 310 older browsers wont allowput requests 261 server side java you can find the sample server code in java gae here spring mvc wiki sample provided by zouroto node js wiki sample provided by chovy another wiki using express 4 0 and the multiparty provided by jonathan white rails wiki sample provided by guptapriyank blog post provided by coshx labs rails progress event if your server is rails and apache you may need to modify server configurations for the server to support upload progress see 207 php wiki sample and related issue only one file in files when uploading multiple files net demo showing how to use ng file upload with asp net web api sample client and server code demo c provided by atomstar cors to support cors upload your server needs to allow cross domain requests you can achieve that by having a filter or interceptor on your upload file server to add cors headers to the response similar to this sample java code java httpresp setheader access control allow methods post put options httpresp setheader access control allow origin your other server com httpresp setheader access control allow headers content type for non html5 ie8 9 browsers you would also need a crossdomain xml file at the root of your server to allow cors for flash sample xml xml cross domain policy site control permitted cross domain policies all allow access from domain angular file upload appspot com allow http request headers from domain headers secure false cross domain policy amazon aws s3 upload for amazon authentication version 4 see this comment the demo page has an option to upload to s3 here is a sample config options js upload upload url https angular file upload s3 amazonaws com s3 upload url including bucket name method post data key file name the key to store the file on s3 could be file name or customized awsaccesskeyid your aws accesskey id acl private sets the access to the uploaded file in the bucket private public read policy scope policy base64 encoded json policy see article below signature scope signature base64 encoded signature based on policy string see article below content type file type file type application octet stream content type of the file notempty filename file name this is needed for flash polyfill ie8 9 file file this article explains more about these fields and provides instructions on how to generate the policy and signature using a server side tool these two values are generated from the json policy document which looks like this js expiration 2020 01 01t00 00 00z conditions bucket angular file upload starts with key acl private starts with content type starts with filename content length range 0 524288000 the demo page provide a helper tool to generate the policy and signature from you from the json policy document note please use https protocol to access demo page if you are using this tool to generate signature and policy to protect your aws secret key which should never be shared make sure that you provide upload and cors post to your bucket at aws s3 bucket name properties edit bucket policy and edit cors configuration samples of these two files js version 2012 10 17 statement sid uploadfile effect allow principal aws arn aws iam xxxx user xxx action s3 getobject s3 putobject resource arn aws s3 angular file upload sid crossdomainaccess effect allow principal action s3 getobject resource arn aws s3 angular file upload crossdomain xml xml xml version 1 0 encoding utf 8 corsconfiguration xmlns http s3 amazonaws com doc 2006 03 01 corsrule allowedorigin http angular file upload appspot com allowedorigin allowedmethod post allowedmethod allowedmethod get allowedmethod allowedmethod head allowedmethod maxageseconds 3000 maxageseconds allowedheader allowedheader corsrule corsconfiguration for ie8 9 flash polyfill you need to have a crossdomain xml file at the root of you s3 bucket make sure the content type of crossdomain xml is text xml and you provide read access to this file in your bucket policy you can also have a look at https github com nukulb s3 angular file upload for another example with this fix