osquery osquery is an operating system instrumentation framework for os x macos windows and linux the tools make low level operating system analytics and monitoring both performant and intuitive platform build status macos 10 12 build status https jenkins osquery io job osquerymasterbuildosx10 12 badge icon https jenkins osquery io job osquerymasterbuildosx10 12 homepage https osquery io centos 6 x build status https jenkins osquery io job osquerymasterbuildcentos6 badge icon https jenkins osquery io job osquerymasterbuildcentos6 downloads https osquery io downloads centos 7 x build status https jenkins osquery io job osquerymasterbuildcentos7 badge icon https jenkins osquery io job osquerymasterbuildcentos7 tables https osquery io schema ubuntu 14 04 build status https jenkins osquery io job osquerymasterbuildubuntu14 badge icon https jenkins osquery io job osquerymasterbuildubuntu14 packs https osquery io packs https github com facebook osquery tree master packs ubuntu 16 04 build status https jenkins osquery io job osquerymasterbuildubuntu16 badge icon https jenkins osquery io job osquerymasterbuildubuntu16 guide https osquery readthedocs org windows 2016 build status https jenkins osquery io job osquerymasterbuildwindows2016 badge icon https jenkins osquery io job osquerymasterbuildwindows2016 slack status https osquery slack herokuapp com badge svg https osquery slack herokuapp com https osquery slack herokuapp com windows 10 build status https jenkins osquery io job osquerymasterbuildwindows10 badge icon https jenkins osquery io job osquerymasterbuildwindows10 freebsd 11 build status https jenkins osquery io job osquerymasterbuildfreebsd11 badge icon https jenkins osquery io job osquerymasterbuildfreebsd11 there are many additional continuous build jobs https jenkins osquery io that perform dynamic and static analysis test the package build process rebuild dependencies from source assure deterministic build on macos and linux fuzz test the virtual tables and build on several other platforms not included above code safety testing rigor data integrity and a friendly development community are our primary goals what is osquery osquery exposes an operating system as a high performance relational database this allows you to write sql based queries to explore operating system data with osquery sql tables represent abstract concepts such as running processes loaded kernel modules open network connections browser plugins hardware events or file hashes sql tables are implemented via a simple plugin and extensions api a variety of tables already exist and more are being written https osquery io schema https osquery io schema to best understand the expressiveness that is afforded to you by osquery consider the following sql queries list the users https osquery io schema current users sql select from users check the processes https osquery io schema current processes that have a deleted executable sql select from processes where on disk 0 get the process name port and pid for processes listening on all interfaces sql select distinct processes name listening ports port processes pid from listening ports join processes using pid where listening ports address 0 0 0 0 find every os x launchdaemon that launches an executable and keeps it running sql select name program program arguments as executable from launchd where run at load 1 and keep alive 1 and program or program arguments check for arp anomalies from the hosts perspective sql select address mac count mac as mac count from arp cache group by mac having count mac 1 alternatively you could also use a sql sub query to accomplish the same result sql select address mac mac count from select address mac count mac as mac count from arp cache group by mac where mac count 1 these queries can be performed on an ad hoc basis to explore operating system state using the osqueryi https osquery readthedocs org en latest introduction using osqueryi shell executed via a scheduler https osquery readthedocs org en latest introduction using osqueryd to monitor operating system state across a set of hosts launched from custom applications using osquery thrift apis downloads install for latest stable builds for os x pkg and linux deb rpm as well as yum and apt repository information visit https osquery io downloads https osquery io downloads windows 10 8 server 2012 and 2016 packages are published to chocolatey https chocolatey org packages osquery the list of supported platforms for running osquery is massive apple os x 10 10 10 11 and macos 10 12 any 64bit linux os with glibc 2 13 and zlib 1 2 windows 10 8 server 2012 and 2016 building from source building osquery from source is encouraged check out the documentation https osquery readthedocs org en latest development building to get started and join our developer community by giving us feedback in github issues or submitting pull requests we officially support a subset of os versions for building because it is rather intense ubuntu 14 04 and 16 04 centos 6 5 and 7 apple macos 10 12 windows 10 and server 2016 file integrity monitoring fim osquery provides several fim features http osquery readthedocs org en stable deployment file integrity monitoring too just as os concepts are represented in tabular form the daemon can track os events and later expose them in a table tables like file events https osquery io schema current file events or yara events https osquery io schema current yara events can be selected to retrieve buffered events the configuration allows you to organize files and directories for monitoring those sets can be paired with lists of yara signatures or configured for additional monitoring such as access events process and socket auditing there are several forms of eventing http osquery readthedocs org en stable development pubsub framework in osquery along with file modifications and accesses these range from disk mounts network reconfigurations hardware attach and detaching and process starting for a complete set review the table documentation and look for names with the events suffix license the osquery project is dual licensed under apache 2 0 and gplv2 you may select at your option one of these licenses vulnerabilities we keep track of security announcements in our tagged version release notes on github we aggregate these into security md https github com facebook osquery blob master security md too facebook has a bug bounty https www facebook com whitehat program that includes osquery if you find a security vulnerability in osquery please submit it via the process outlined on that page and do not file a public issue for more information on finding vulnerabilities in osquery see a recent blog post about bug hunting osquery https www facebook com notes facebook bug bounty bug hunting osquery 954850014529225 learn more want to be a security engineer at facebook the osquery development team is hiring our teams mission is detect external and internal threats to users data we do that by building deploying and using intrusion detection tools like osquery check out our position description https www facebook com careers jobs a0i1200000jxmwqea1 or reach out to theopolis https github com theopolis read the launch blog post https code facebook com posts 844436395567983 introducing osquery for background on the project if youre interested in learning more about osquery visit the users guide https osquery readthedocs org and browse our rfc labeled github issues development and usage discussion is happing in the osquery slack grab an invite automatically https osquery slack herokuapp com https osquery slack herokuapp com